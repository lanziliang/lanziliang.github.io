<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Lanzl">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Lanzl">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Lanzl">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Lanzl</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Lanzl</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/20/Mac%E5%8D%B8%E8%BD%BDDocker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Lanzl">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lanzl">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/09/20/Mac%E5%8D%B8%E8%BD%BDDocker/" class="post-title-link" itemprop="url">Mac卸载Docker</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-09-20 20:33:32 / 修改时间：20:40:33" itemprop="dateCreated datePublished" datetime="2023-09-20T20:33:32+08:00">2023-09-20</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li>运行下面命令卸载docker</li>
</ol>
<p><code>/Applications/Docker.app/Contents/MacOS/uninstall</code></p>
<ol start="2">
<li>删除应用程序中 docker.app</li>
<li>删除以下目录</li>
</ol>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~/Library/Containers/com.docker.docker</span><br><span class="line">rm -rf ~/Library/Group\ Containers/group.com.docker</span><br><span class="line">rm -rf ~/Library/Preferences/com.docker.docker.plist</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>如需重装docker，需要重启电脑</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/10/Docker%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Lanzl">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lanzl">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/09/10/Docker%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Docker学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-10 22:55:35" itemprop="dateCreated datePublished" datetime="2023-09-10T22:55:35+08:00">2023-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-20 17:06:29" itemprop="dateModified" datetime="2023-09-20T17:06:29+08:00">2023-09-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p><strong>架构图</strong></p>
<p><img src="/../images/docker-architecture.png" alt="Docker Architecture diagram"></p>
<p><code>docker run</code> <strong>执行流程</strong></p>
<p><img src="/../images/docker-run.png" alt="Docker Run"></p>
<p><strong>与虚拟机对比</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">Docker容器</th>
<th align="center">虚拟机（VM）</th>
</tr>
</thead>
<tbody><tr>
<td align="center">操作系统</td>
<td align="center">与宿主机共享OS</td>
<td align="center">宿主机OS上运行虚拟机OS</td>
</tr>
<tr>
<td align="center">存储大小</td>
<td align="center">镜像小，便于存储与传输</td>
<td align="center">镜像庞大</td>
</tr>
<tr>
<td align="center">运行性能</td>
<td align="center">几乎无额外性能损失</td>
<td align="center">操作系统额外的CPU、内存消耗</td>
</tr>
<tr>
<td align="center">移植性</td>
<td align="center">轻便、灵活，适应于Linux</td>
<td align="center">笨重，与虚拟化技术耦合度高</td>
</tr>
<tr>
<td align="center">软件亲和性</td>
<td align="center">面向软件开发者</td>
<td align="center">面向硬件运维者</td>
</tr>
<tr>
<td align="center">部署速度</td>
<td align="center">快速，秒级</td>
<td align="center">较慢，10s以上</td>
</tr>
</tbody></table>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><h2 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h2><ul>
<li><p>docker images</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">	-a</span><br><span class="line">	-q</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/10/Linux%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Lanzl">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lanzl">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/09/10/Linux%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Linux学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-09-10 22:02:07 / 修改时间：22:05:18" itemprop="dateCreated datePublished" datetime="2023-09-10T22:02:07+08:00">2023-09-10</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Linux系统"><a href="#Linux系统" class="headerlink" title="Linux系统"></a>Linux系统</h1><h2 id="系统分区"><a href="#系统分区" class="headerlink" title="系统分区"></a>系统分区</h2><ol>
<li><p>磁盘分区</p>
<p>分区类型：</p>
<ul>
<li>主分区：最多只能有4个。</li>
<li>扩展分区：<ul>
<li>最多只能有1个。</li>
<li>主分区加扩展分区最多有4个。</li>
<li>不能写入数据，只能包含逻辑分区</li>
</ul>
</li>
<li>逻辑分区</li>
</ul>
</li>
<li><p>格式化</p>
<p><strong>格式化</strong>（高级格式化）又称逻辑格式化，它是指根据用户选定的文件系统（如FAT16、FAT32、NTFS、EXT2、EXT3、EXT4等），在磁盘的特定区域写入特定数据，在分区中划出一片用于存放文件分配表、目录表等用于文件管理的磁盘空间。</p>
</li>
<li><p>硬件设备文件名</p>
<table>
<thead>
<tr>
<th>硬件</th>
<th>设备文件名</th>
</tr>
</thead>
<tbody><tr>
<td>IDE硬盘</td>
<td>&#x2F;dev&#x2F;hd[a-d]</td>
</tr>
<tr>
<td>SCSI&#x2F;SATA&#x2F;USB硬盘</td>
<td>&#x2F;dev&#x2F;sd[a-p]</td>
</tr>
<tr>
<td>光驱</td>
<td>&#x2F;dev&#x2F;cdrom或&#x2F;dev&#x2F;hdc</td>
</tr>
<tr>
<td>软盘</td>
<td>&#x2F;dev&#x2F;fd[0-1]</td>
</tr>
<tr>
<td>打印机（25针）</td>
<td>&#x2F;dev&#x2F;lp[0-2]</td>
</tr>
<tr>
<td>打印机（USB）</td>
<td>&#x2F;dev&#x2F;usb&#x2F;lp[0-15]</td>
</tr>
<tr>
<td>鼠标</td>
<td>&#x2F;dev&#x2F;mouse</td>
</tr>
</tbody></table>
</li>
<li><p>挂载</p>
<ul>
<li>必须分区<ul>
<li>&#x2F; （根分区）</li>
<li>swap分区（交换分区，内存2倍，不超过2GB）</li>
</ul>
</li>
<li>推荐分区<ul>
<li>&#x2F;boot （启动分区，200MB）</li>
</ul>
</li>
</ul>
</li>
<li><p>文件系统结构</p>
<p><img src="/../images/Snipaste_2023-08-19_17-36-41.png" alt="img"></p>
</li>
</ol>
<p>总结：</p>
<ul>
<li>分区：把大硬盘分为小的逻辑分区</li>
<li>格式化：写入文件系统</li>
<li>分区设备文件名：给每个分区定义设备文件名</li>
<li>挂载：给每个分区分配挂载点</li>
</ul>
<h2 id="服务器管理和维护建议"><a href="#服务器管理和维护建议" class="headerlink" title="服务器管理和维护建议"></a>服务器管理和维护建议</h2><ol>
<li><p>Linux各目录的作用</p>
<table>
<thead>
<tr>
<th>目录名</th>
<th>目录作用</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;bin&#x2F;</td>
<td>存放系统命令的目录，普通用户和超级用户都可以执行。不过放在&#x2F;bin下的命令在单用户模式下也可以执行</td>
</tr>
<tr>
<td>&#x2F;sbin&#x2F;</td>
<td>保存和系统环境设置相关的命令，只有超级用户可以使用这些命令进行系统环境设置，但是有些命令可以允许普通用户查看</td>
</tr>
<tr>
<td>&#x2F;usr&#x2F;bin&#x2F;</td>
<td>存放系统命令的目录，普通用户和超级用户都可以执行。这些命令和系统启动无关，在单用户模式下不能执行</td>
</tr>
<tr>
<td>&#x2F;usr&#x2F;sbin&#x2F;</td>
<td>存放根文件系统不必要的系统管理命令，例如多数服务程序。只有超级用户可以使用。大家其实可以注意到Linux的系统，在所有“sbin”目录中保存的命令只有超级用户可以使用，“bin”目录中保存的命令所有用户都可以使用</td>
</tr>
<tr>
<td>&#x2F;boot&#x2F;</td>
<td>系统启动目录，保存系统启动相关的文件，如内核文件和启动引导程序（grub）文件等</td>
</tr>
<tr>
<td>&#x2F;dev&#x2F;</td>
<td>设备文件保存位置。我们已经说过Linux中所有内容以文件形式保存，包括硬件。那么这个目录就是用来保存所有硬件设备文件的</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;</td>
<td>配置文件保存位置。系统内所有采用默认安装方式（rpm安装）的服务的配置文件全部都保存在这个目录当中，如用户账户和密码，服务的启动脚本，常用服务的配置文件等</td>
</tr>
<tr>
<td>&#x2F;home&#x2F;</td>
<td>普通用户的家目录。建立每个用户时，每个用户要有一个默认登录位置，这个位置就是这个用户的家目录，所有普通用户的家目录就是在&#x2F;home下建立一个和用户名相同的目录。如用户user1的家目录就是&#x2F;home&#x2F;user1</td>
</tr>
<tr>
<td>&#x2F;lib&#x2F;</td>
<td>系统调用的函数库保存位置</td>
</tr>
<tr>
<td>&#x2F;lost+found&#x2F;</td>
<td>当系统意外崩溃或机器意外关机，而产生一些文件碎片放在这里。当系统启动的过程中fsck工具会检查这里，并修复已经损坏的文件系统。这个目录只在每个分区中出现，例如&#x2F;lost+found就是根分区的备份恢复目录，&#x2F;boot&#x2F;lost+found就是&#x2F;boot分区的备份恢复目录</td>
</tr>
<tr>
<td>&#x2F;media&#x2F;</td>
<td>挂载目录。系统建议是用来挂载媒体设备的，例如软盘和光盘</td>
</tr>
<tr>
<td>&#x2F;mnt&#x2F;</td>
<td>挂载目录，早期Linux中只有这一个挂载目录，并没有细分。现在这个目录系统建议挂载额外设备，如U盘，移动硬盘和其他操作系统的分区</td>
</tr>
<tr>
<td>&#x2F;misc&#x2F;</td>
<td>挂载目录。系统建议用来挂载NFS服务的共享目录。只要是一个已经建立的空目录就可以作为挂载点，系统虽然准备了三个默认挂载目录&#x2F;media、&#x2F;mnt、&#x2F;misc，但是到底在哪个目录中挂载什么设备都可以由管理员自己决定。如&#x2F;mnt&#x2F;cdrom挂载光盘，&#x2F;mnt&#x2F;usb挂载U盘，这都是可以的</td>
</tr>
<tr>
<td>&#x2F;opt&#x2F;</td>
<td>第三方安装的软件保存位置。这个目录就是放置和安装其他软件的位置，手工安装的源码包软件都可以安装到这个目录当中。&#x2F;usr&#x2F;local&#x2F;目录也可以用来安装软件</td>
</tr>
<tr>
<td>&#x2F;proc&#x2F;</td>
<td>虚拟文件系统，该目录中的数据并不保存到硬盘当中，而是保存到内存当中。主要保存系统的内核，进程，外部设备状态和网络状态灯。如&#x2F;proc&#x2F;cpuinfo是保存CPU信息的，&#x2F;proc&#x2F;devices是保存设备驱动的列表的，&#x2F;proc&#x2F;filesystems是保存文件系统列表的，&#x2F;proc&#x2F;net&#x2F;是保存网络协议信息的</td>
</tr>
<tr>
<td>&#x2F;sys&#x2F;</td>
<td>虚拟文件系统。和&#x2F;proc目录相似，都是保存在内存当中的，主要是保存于内核相关信息的</td>
</tr>
<tr>
<td>&#x2F;root&#x2F;</td>
<td>超级用户的家目录。普通用户家目录在“&#x2F;home”下，超级用户家目录直接在“&#x2F;”下</td>
</tr>
<tr>
<td>&#x2F;srv&#x2F;</td>
<td>服务数据目录。一些系统服务启动之后，可以在这个目录中保存所需要的数据</td>
</tr>
<tr>
<td>&#x2F;tmp&#x2F;</td>
<td>临时目录。系统存放临时文件的目录，该目录下所有用户都可以访问和写入。建议此目录中不能保存重要数据，最好每次开机都把该目录清空</td>
</tr>
<tr>
<td>&#x2F;usr&#x2F;</td>
<td>系统软件资源目录。注意usr 不是user 的缩写，而是“Unix SoftwreResource”的缩写，所以不是存放用户数据，而是存放系统软件资源的目录。系统中安装的软件大多数保存在这里</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;</td>
<td>动态数据保存位置。主要保存缓存、日志以及软件运行所产生的文件</td>
</tr>
</tbody></table>
</li>
<li><p>服务器注意事项</p>
<ul>
<li>远程服务器不允许关机，只能重启</li>
<li>重启时应该关闭服务</li>
<li>不要在服务器访问高峰运行高负载命令</li>
<li>远程配置防火墙时不要把自己踢出服务器指定合理的密码规范并定期更新</li>
<li>合理分配权限</li>
<li>定期备份重要数据和日志</li>
</ul>
</li>
</ol>
<h1 id="Linux常用命令"><a href="#Linux常用命令" class="headerlink" title="Linux常用命令"></a>Linux常用命令</h1><h2 id="文件处理命令"><a href="#文件处理命令" class="headerlink" title="文件处理命令"></a>文件处理命令</h2><h3 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">命令名称：ls</span><br><span class="line">命令英文原意：list</span><br><span class="line">命令所在路径：/bin/ls</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示目录文件</span><br><span class="line">语法：ls  选项[-ald]  [文件或目录]</span><br><span class="line">    -a    显示所有文件，包括隐藏文件</span><br><span class="line">    -l    详细信息显示</span><br><span class="line">    -d    查看目录属性</span><br></pre></td></tr></table></figure>

<p>文件权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-rw-r--r--</span><br><span class="line">    - 文件类型（- 文件d 目录 l 软链接文件）</span><br><span class="line">    rw- r-- r--</span><br><span class="line">    u   g   o</span><br><span class="line">    u所有者 g所属组 o其他人</span><br><span class="line">    r读 w写 x执行</span><br></pre></td></tr></table></figure>

<h3 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">命令名称：mkdir</span><br><span class="line">命令英文原意：make directories</span><br><span class="line">命令所在路径：/bin/mkdir</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：创建新目录</span><br><span class="line">语法：mkdir -p  [目录名]</span><br><span class="line">    -p  递归创建</span><br><span class="line">范例：$ mkdir -p /tmp/test</span><br><span class="line">     $ mkdir /tmp/testa /tmp/testb</span><br></pre></td></tr></table></figure>

<h3 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：cd</span><br><span class="line">命令英文原意：change directory</span><br><span class="line">命令所在路径：shell内置命令</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：切换目录</span><br><span class="line">语法：cd [目录]</span><br><span class="line">范例：$ cd  /tmp/test     切换到指定目录</span><br><span class="line">     $ cd  ..            回到上一级目录</span><br></pre></td></tr></table></figure>

<h3 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：pwd</span><br><span class="line">命令英文原意：print working directory</span><br><span class="line">命令所在路径：/bin/pwd</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示当前目录</span><br><span class="line">语法：pwd</span><br></pre></td></tr></table></figure>

<h3 id="rmdir"><a href="#rmdir" class="headerlink" title="rmdir"></a>rmdir</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令名称：rmdir</span><br><span class="line">命令英文原意：remove empty directories</span><br><span class="line">命令所在路径：/bin/rmdir</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：删除空目录</span><br><span class="line">语法：rmdir [目录名]</span><br><span class="line">范例：$ rmdir /tmp/test</span><br></pre></td></tr></table></figure>

<h3 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">命令名称：cp</span><br><span class="line">命令英文原意：copy</span><br><span class="line">命令所在路径：/bin/cp</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：复制文件或目录</span><br><span class="line">语法：cp  -rp  [原文件或目录] [目标目录] </span><br><span class="line">    -r  复制目录</span><br><span class="line">    -p  保留文件属性</span><br><span class="line">范例：</span><br><span class="line">    $ cp  -r /tmp/test  /root</span><br><span class="line">     将目录/tmp/test复制到目录/root下</span><br><span class="line">    $ cp  -rp /tmp/testa /tmp/testb /root</span><br><span class="line">     将/tmp目录下的testa和testb目录复制到/root下，保持目录属性</span><br></pre></td></tr></table></figure>

<h3 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：mv</span><br><span class="line">命令英文原意：move</span><br><span class="line">命令所在路径：/bin/mv</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：剪切文件、改名</span><br><span class="line">语法：mv  [原文件或目录]  [目标目录]</span><br></pre></td></tr></table></figure>

<h3 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">命令名称：rm</span><br><span class="line">命令英文原意：remove</span><br><span class="line">命令所在路径：/bin/rm</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：删除文件</span><br><span class="line">语法：rm  -rf   [文件或目录]</span><br><span class="line">    -r  删除目录</span><br><span class="line">    -f  强制执行</span><br><span class="line">范例：</span><br><span class="line">    $ rm  /tmp/yum.log</span><br><span class="line">     删除文件/tmp/yum.log</span><br><span class="line">    $ rm -rf  /tmp/test</span><br><span class="line">     删除目录/tmp/test</span><br></pre></td></tr></table></figure>

<h3 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：touch</span><br><span class="line">命令所在路径：/bin/touch</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：创建空文件</span><br><span class="line">语法：touch  [文件名]                </span><br><span class="line">范例：$ touch test.txt</span><br></pre></td></tr></table></figure>

<h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：cat</span><br><span class="line">命令所在路径：/bin/cat</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示文件内容</span><br><span class="line">语法：cat [文件名]</span><br><span class="line">    -n  显示行号</span><br><span class="line">范例：$ cat  /etc/issue</span><br><span class="line">     $ cat  -n /etc/services</span><br></pre></td></tr></table></figure>

<h3 id="cat-1"><a href="#cat-1" class="headerlink" title="cat"></a>cat</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：cat</span><br><span class="line">命令所在路径：/bin/cat</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示文件内容</span><br><span class="line">语法：cat [文件名]</span><br><span class="line">    -n  显示行号</span><br><span class="line">范例：$ cat  /etc/issue</span><br><span class="line">     $ cat  -n /etc/services</span><br></pre></td></tr></table></figure>

<h3 id="tac"><a href="#tac" class="headerlink" title="tac"></a>tac</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：tac</span><br><span class="line">命令所在路径：/usr/bin/tac</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示文件内容（反向列示）</span><br><span class="line">语法：tac [文件名]</span><br><span class="line">范例：$ tac  /etc/issue</span><br></pre></td></tr></table></figure>

<h3 id="more"><a href="#more" class="headerlink" title="more"></a>more</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">命令名称：more</span><br><span class="line">命令所在路径：/bin/more</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：分页显示文件内容</span><br><span class="line">语法：more  [文件名]</span><br><span class="line">    (空格) 或f       翻页</span><br><span class="line">    (Enter)         换行</span><br><span class="line">    q或Q            退出</span><br><span class="line">范例： $ more  /etc/services</span><br></pre></td></tr></table></figure>

<h3 id="less"><a href="#less" class="headerlink" title="less"></a>less</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：less</span><br><span class="line">命令所在路径：/usr/bin/less</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：分页显示文件内容（可向上翻页）</span><br><span class="line">语法：less  [文件名]</span><br><span class="line">范例： $  less  /etc/services</span><br></pre></td></tr></table></figure>

<h3 id="head"><a href="#head" class="headerlink" title="head"></a>head</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">文件处理命令：head</span><br><span class="line">命令名称：head</span><br><span class="line">命令所在路径：/usr/bin/head</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示文件前面几行</span><br><span class="line">语法：head  [文件名]</span><br><span class="line">    -n 指定行数</span><br><span class="line">范例： $ head -n 20 /etc/services</span><br></pre></td></tr></table></figure>

<h3 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：tail</span><br><span class="line">命令所在路径：/usr/bin/tail</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示文件后面几行</span><br><span class="line">语法：tail  [文件名]</span><br><span class="line">    -n  指定行数</span><br><span class="line">    -f  动态显示文件末尾内容</span><br><span class="line">范例： $ tail -n 18 /etc/services</span><br></pre></td></tr></table></figure>

<h3 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">命令名称：ln</span><br><span class="line">命令英文原意：link</span><br><span class="line">命令所在路径：/bin/ln</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：生成链接文件</span><br><span class="line">语法：ln  -s  [原文件]  [目标文件]</span><br><span class="line">    -s  创建软链接</span><br><span class="line">范例：</span><br><span class="line">    $ ln -s  /etc/issue  /tmp/issue.soft</span><br><span class="line">     创建文件/etc/issue的软链接/tmp/issue.soft</span><br><span class="line">    $ ln  /etc/issue  /tmp/issue.hard</span><br><span class="line">     创建文件/etc/issue的硬链接/tmp/issue.hard</span><br></pre></td></tr></table></figure>

<p>软链接特征：类似Windows快捷方式</p>
<ol>
<li>lrwxrwxrwx l 软链接(软链接文件权限都为rwxrwxrwx)</li>
<li>文件大小-只是符号链接</li>
<li>&#x2F;tmp&#x2F;issue.soft -&gt; &#x2F;etc&#x2F;issue 箭头指向原文件</li>
</ol>
<p>硬链接特征：</p>
<ol>
<li>拷贝cp -p + 同步更新</li>
<li>可通过i节点识别</li>
<li>不能跨分区</li>
<li>不能针对目录使用</li>
</ol>
<h2 id="权限管理命令"><a href="#权限管理命令" class="headerlink" title="权限管理命令"></a>权限管理命令</h2><h3 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">命令名称：chmod</span><br><span class="line">命令英文原意：change the permissions mode of a file</span><br><span class="line">命令所在路径：/bin/chmod</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：改变文件或目录权限</span><br><span class="line">语法：chmod  [&#123;ugoa&#125;&#123;+-=&#125;&#123;rwx&#125;] [文件或目录] </span><br><span class="line">            [mode=421 ]  [文件或目录] </span><br><span class="line">            -R  递归修改</span><br><span class="line">    权限的数字表示</span><br><span class="line">        r ---- 4</span><br><span class="line">        w ---- 2</span><br><span class="line">        x ---- 1</span><br><span class="line">        rwxrw-r--</span><br><span class="line">        7  6  4</span><br><span class="line">范例：</span><br><span class="line">    $ chmod  g+w  testfile</span><br><span class="line">     赋予文件testfile所属组写权限</span><br><span class="line">    $ chmod  -R 777  testdir</span><br><span class="line">     修改目录testfile及其目录下文件为所有用户具有全部权限</span><br></pre></td></tr></table></figure>

<p>文件目录权限总结：</p>
<table>
<thead>
<tr>
<th>代表字符</th>
<th>权限</th>
<th>对文件的含义</th>
<th>对目录的含义</th>
</tr>
</thead>
<tbody><tr>
<td>r</td>
<td>读</td>
<td>可以查看文件内容</td>
<td>可以列出目录中的内容</td>
</tr>
<tr>
<td>w</td>
<td>写</td>
<td>可以修改文件内容</td>
<td>可以在目录中创建、删除文件</td>
</tr>
<tr>
<td>x</td>
<td>执行</td>
<td>可以执行文件</td>
<td>可以列出目录中的内容</td>
</tr>
</tbody></table>
<h3 id="chown"><a href="#chown" class="headerlink" title="chown"></a>chown</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：chown</span><br><span class="line">命令英文原意：change file ownership</span><br><span class="line">命令所在路径：/bin/chown</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：改变文件或目录的所有者</span><br><span class="line">语法：chown  [用户] [文件或目录] </span><br><span class="line">范例：$ chown  user file</span><br><span class="line">      改变文件file的所有者为user</span><br></pre></td></tr></table></figure>

<h3 id="chgrp"><a href="#chgrp" class="headerlink" title="chgrp"></a>chgrp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：chgrp</span><br><span class="line">命令英文原意：change file group ownership</span><br><span class="line">命令所在路径：/bin/chgrp</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：改变文件或目录的所属组</span><br><span class="line">语法：chgrp  [用户组]  [文件或目录] </span><br><span class="line">范例：$ chgrp group file</span><br><span class="line">      改变文件file的所属组为group</span><br></pre></td></tr></table></figure>

<h3 id="umask"><a href="#umask" class="headerlink" title="umask"></a>umask</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：umask</span><br><span class="line">命令英文原意：the user file-creation mask</span><br><span class="line">命令所在路径：Shell内置命令</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示、设置文件的缺省权限</span><br><span class="line">语法：umask [-S] [权限掩码]</span><br><span class="line">        -S   以rwx形式显示新建文件缺省权限</span><br><span class="line">范例：$ umask -S </span><br></pre></td></tr></table></figure>

<h2 id="文件搜索命令"><a href="#文件搜索命令" class="headerlink" title="文件搜索命令"></a>文件搜索命令</h2><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">命令名称：find</span><br><span class="line">命令所在路径：/bin/find</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：文件搜索</span><br><span class="line">语法：find  [搜索范围]  [匹配条件]</span><br><span class="line">        -type 根据文件类型查找</span><br><span class="line">            f 文件 d 目录 l 软链接文件</span><br><span class="line">        -inum  根据i节点查找</span><br><span class="line">范例：</span><br><span class="line">    $ find  /etc  -name  init  </span><br><span class="line">      在目录/etc中查找文件init</span><br><span class="line">      -iname 不区分大小写</span><br><span class="line">    $ find  /  -size  +204800  </span><br><span class="line">      在根目录下查找大于100MB的文件</span><br><span class="line">      +n  大于 -n 小于 n 等于</span><br><span class="line">    $ find  /home  -user  user1</span><br><span class="line">      在根目录下查找所有者为user1的文件</span><br><span class="line">      -group  根据所属组查找</span><br><span class="line">    $ find  /etc  -cmin  -5</span><br><span class="line">      在/etc下查找5分钟内被修改过属性的文件和目录</span><br><span class="line">      -amin  访问时间access</span><br><span class="line">      -cmin  文件属性change</span><br><span class="line">      -mmin  文件内容modify</span><br><span class="line">    $ find  /etc -size  +163840 -a -size  -204800 </span><br><span class="line">      在/etc下查找大于80MB小于100MB的文件</span><br><span class="line">      -a 两个条件同时满足</span><br><span class="line">      -o 两个条件满足任意一个即可</span><br><span class="line">    $ find /etc -name inittab -exec ls -l &#123;&#125; \;</span><br><span class="line">      在/etc下查找inittab文件并显示其详细信息</span><br><span class="line">      -exec/-ok 命令&#123;&#125; \;  对搜索结果执行操作</span><br></pre></td></tr></table></figure>

<h3 id="locate"><a href="#locate" class="headerlink" title="locate"></a>locate</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：locate</span><br><span class="line">命令所在路径：/usr/bin/locate</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：在文件资料库中查找文件</span><br><span class="line">语法：locate  文件名</span><br><span class="line">范例：$ locate inittab</span><br></pre></td></tr></table></figure>

<h3 id="which"><a href="#which" class="headerlink" title="which"></a>which</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：which</span><br><span class="line">命令所在路径：/usr/bin/which</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：搜索命令所在目录及别名信息</span><br><span class="line">语法：which  命令</span><br><span class="line">范例：$ which ls</span><br></pre></td></tr></table></figure>

<h3 id="whereis"><a href="#whereis" class="headerlink" title="whereis"></a>whereis</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：whereis</span><br><span class="line">命令所在路径：/usr/bin/whereis</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：搜索命令所在目录及帮助文档路径</span><br><span class="line">语法：whereis  [命令名称] </span><br><span class="line">范例：$ whereis ls</span><br></pre></td></tr></table></figure>

<h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：grep</span><br><span class="line">命令所在路径：/bin/grep</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：在文件中搜寻字串匹配的行并输出</span><br><span class="line">语法：grep  -iv [指定字串] [文件]</span><br><span class="line">        -i  不区分大小写</span><br><span class="line">        -v  排除指定字串</span><br><span class="line">范例：$ grep  mysql  /root/install.log</span><br></pre></td></tr></table></figure>

<h2 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h2><h3 id="man"><a href="#man" class="headerlink" title="man"></a>man</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">命令名称：man</span><br><span class="line">命令英文原意：manual</span><br><span class="line">命令所在路径：/usr/bin/man</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：获得帮助信息</span><br><span class="line">语法：man  [命令或配置文件]</span><br><span class="line">范例：$ man ls</span><br><span class="line">        查看ls命令的帮助信息</span><br><span class="line">    $ man services</span><br><span class="line">        查看配置文件services的帮助信息</span><br></pre></td></tr></table></figure>

<h3 id="help"><a href="#help" class="headerlink" title="help"></a>help</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令名称：help</span><br><span class="line">命令所在路径：Shell内置命令</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：获得Shell内置命令的帮助信息</span><br><span class="line">语法：help 命令</span><br><span class="line">范例：$ help umask</span><br><span class="line">        查看umask命令的帮助信息</span><br></pre></td></tr></table></figure>

<h2 id="用户管理命令"><a href="#用户管理命令" class="headerlink" title="用户管理命令"></a>用户管理命令</h2><h3 id="useradd"><a href="#useradd" class="headerlink" title="useradd"></a>useradd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：useradd</span><br><span class="line">命令所在路径：/usr/sbin/useradd</span><br><span class="line">执行权限：root</span><br><span class="line">功能描述：添加新用户</span><br><span class="line">语法：useradd 用户名</span><br><span class="line">范例：$ useradd user1</span><br></pre></td></tr></table></figure>

<h3 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：passwd</span><br><span class="line">命令所在路径：/usr/bin/passwd</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：设置用户密码</span><br><span class="line">语法：passwd 用户名</span><br><span class="line">范例：$ passwd user1</span><br></pre></td></tr></table></figure>

<h3 id="who"><a href="#who" class="headerlink" title="who"></a>who</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：who</span><br><span class="line">命令所在路径：/usr/bin/who</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：查看登录用户信息</span><br><span class="line">语法：who</span><br><span class="line">范例：$ who</span><br></pre></td></tr></table></figure>

<h3 id="w"><a href="#w" class="headerlink" title="w"></a>w</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：w</span><br><span class="line">命令所在路径：/usr/bin/w</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：查看登录用户详细信息</span><br><span class="line">语法：w</span><br><span class="line">范例：$ w</span><br></pre></td></tr></table></figure>

<h2 id="压缩解压命令"><a href="#压缩解压命令" class="headerlink" title="压缩解压命令"></a>压缩解压命令</h2><h3 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令名称：gzip</span><br><span class="line">命令英文原意：GNU zip</span><br><span class="line">命令所在路径：/bin/gzip</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：压缩文件</span><br><span class="line">压缩后文件格式：.gz</span><br><span class="line">语法：gzip [文件] </span><br></pre></td></tr></table></figure>

<h3 id="gunzip"><a href="#gunzip" class="headerlink" title="gunzip"></a>gunzip</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令名称：gunzip</span><br><span class="line">命令英文原意：GNU unzip</span><br><span class="line">命令所在路径：/bin/gunzip</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：解压缩.gz的压缩文件</span><br><span class="line">语法：gunzip [压缩文件]</span><br><span class="line">范例：$ gunzip test.gz</span><br></pre></td></tr></table></figure>

<h3 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">命令名称：tar</span><br><span class="line">命令所在路径：/bin/tar</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：打包目录</span><br><span class="line">压缩后文件格式：.tar.gz </span><br><span class="line">语法：tar  选项[-zcf] [压缩后文件名] [目录]                 </span><br><span class="line">        -c    打包</span><br><span class="line">        -v    显示详细信息</span><br><span class="line">        -f    指定文件名</span><br><span class="line">        -z    打包同时压缩</span><br><span class="line">范例：</span><br><span class="line">    $ tar  -zcf   test.tar.gz  test</span><br><span class="line">        将目录test打包并压缩为.tar.gz文件</span><br><span class="line"></span><br><span class="line">tar命令解压缩语法：</span><br><span class="line">    -x     解包</span><br><span class="line">    -v     显示详细信息</span><br><span class="line">    -f     指定解压文件</span><br><span class="line">    -z     解压缩</span><br><span class="line">范例：$ tar  -zxvf  test.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">命令名称：zip</span><br><span class="line">命令所在路径：/usr/bin/zip</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：压缩文件或目录</span><br><span class="line">压缩后文件格式：.zip </span><br><span class="line">语法：zip  选项[-r]  [压缩后文件名]  [文件或目录]</span><br><span class="line">        -r    压缩目录</span><br><span class="line">范例：</span><br><span class="line">    $ zip  test.zip  test</span><br><span class="line">        压缩文件</span><br><span class="line">    $ zip  -r  test.zip  test</span><br><span class="line">        压缩目录</span><br></pre></td></tr></table></figure>

<h3 id="unzip"><a href="#unzip" class="headerlink" title="unzip"></a>unzip</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：unzip</span><br><span class="line">命令所在路径：/usr/bin/unzip</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：解压.zip的压缩文件</span><br><span class="line">语法：unzip  [压缩文件]</span><br><span class="line">范例：$ unzip test.zip</span><br></pre></td></tr></table></figure>

<h3 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2"></a>bzip2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">命令名称：bzip2</span><br><span class="line">命令所在路径：/usr/bin/bzip2</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：压缩文件</span><br><span class="line">压缩后文件格式：.bz2</span><br><span class="line">语法：bzip2  选项[-k] [文件]</span><br><span class="line">        -k   产生压缩文件后保留原文件</span><br><span class="line">范例：$ bzip2 -k test   </span><br><span class="line">     $ tar -cjf  test.tar.bz2 test</span><br></pre></td></tr></table></figure>

<h3 id="bunzip2"><a href="#bunzip2" class="headerlink" title="bunzip2"></a>bunzip2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令名称：bunzip2</span><br><span class="line">命令所在路径：/usr/bin/bunzip2</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：解压缩</span><br><span class="line">语法：bunzip2  选项[-k] [压缩文件]</span><br><span class="line">        -k   解压缩后保留原文件</span><br><span class="line">范例：$ bunzip2  -k test.bz2 </span><br><span class="line">     $ tar -xjf  test.tar.bz2</span><br></pre></td></tr></table></figure>

<h2 id="网络命令"><a href="#网络命令" class="headerlink" title="网络命令"></a>网络命令</h2><h3 id="write"><a href="#write" class="headerlink" title="write"></a>write</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">指令名称：write</span><br><span class="line">指令所在路径：/usr/bin/write</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：给用户发信息，以Ctrl+D保存结束</span><br><span class="line">语法：write  &lt;用户名&gt;   </span><br><span class="line">范例： # write user1</span><br></pre></td></tr></table></figure>

<h3 id="wall"><a href="#wall" class="headerlink" title="wall"></a>wall</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">指令名称：wall</span><br><span class="line">命令英文原意：write all</span><br><span class="line">指令所在路径：/usr/bin/wall</span><br><span class="line">执行权限：所有用户</span><br><span class="line">语法：wall  [message]  </span><br><span class="line">功能描述：发广播信息</span><br></pre></td></tr></table></figure>

<h3 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令名称：ping</span><br><span class="line">命令所在路径：/bin/ping</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：测试网络连通性</span><br><span class="line">语法：ping  选项 IP地址</span><br><span class="line">        -c  指定发送次数</span><br><span class="line">范例： #  ping 192.168.1.156</span><br></pre></td></tr></table></figure>

<h3 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令名称：ifconfig</span><br><span class="line">命令英文原意：interface configure</span><br><span class="line">命令所在路径：/sbin/ifconfig</span><br><span class="line">执行权限：root</span><br><span class="line">功能描述：查看和设置网卡信息</span><br><span class="line">语法：ifconfig  网卡名称 IP地址</span><br><span class="line">范例：# ifconfig  eth0 192.168.8.250</span><br></pre></td></tr></table></figure>

<h3 id="mail"><a href="#mail" class="headerlink" title="mail"></a>mail</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：mail</span><br><span class="line">命令所在路径：/bin/mail</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：查看发送电子邮件</span><br><span class="line">语法：mail [用户名]</span><br><span class="line">范例：# mail root</span><br></pre></td></tr></table></figure>

<h3 id="last"><a href="#last" class="headerlink" title="last"></a>last</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：last</span><br><span class="line">命令所在路径：/usr/bin/last</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：列出目前与过去登入系统的用户信息</span><br><span class="line">语法：last</span><br><span class="line">范例：# last</span><br></pre></td></tr></table></figure>

<h3 id="lastlog"><a href="#lastlog" class="headerlink" title="lastlog"></a>lastlog</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令名称：lastlog</span><br><span class="line">命令所在路径：/usr/bin/lastlog</span><br><span class="line">执行权限：所有用户</span><br><span class="line">语法：lastlog</span><br><span class="line">功能描述：检查某特定用户上次登录的时间</span><br><span class="line">范例：# lastlog</span><br><span class="line">     # lastlog -u 502</span><br></pre></td></tr></table></figure>

<h3 id="traceroute"><a href="#traceroute" class="headerlink" title="traceroute"></a>traceroute</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：traceroute</span><br><span class="line">命令所在路径：/bin/traceroute</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示数据包到主机间的路径</span><br><span class="line">语法：traceroute</span><br><span class="line">范例：# traceroute www.lampbrother.net</span><br></pre></td></tr></table></figure>

<h3 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">命令名称：netstat</span><br><span class="line">命令所在路径：/bin/netstat</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示网络相关信息</span><br><span class="line">语法：netstat  [选项]</span><br><span class="line">        -t ： TCP协议</span><br><span class="line">        -u ： UDP协议</span><br><span class="line">        -l ： 监听</span><br><span class="line">        -r ： 路由</span><br><span class="line">        -n ： 显示IP地址和端口号</span><br><span class="line">范例：</span><br><span class="line">    #  netstat -tlun 查看本机监听的端口</span><br><span class="line">    #  netstat -an   查看本机所有的网络连接</span><br><span class="line">    #  netstat -rn   查看本机路由表</span><br></pre></td></tr></table></figure>

<h3 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令名称：setup</span><br><span class="line">命令所在路径：/usr/bin/setup</span><br><span class="line">执行权限：root</span><br><span class="line">语法：setup</span><br><span class="line">功能描述：配置网络</span><br><span class="line">范例：# setup</span><br></pre></td></tr></table></figure>

<h3 id="mount"><a href="#mount" class="headerlink" title="mount"></a>mount</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">命令名称：mount</span><br><span class="line">命令位置：/bin/mount</span><br><span class="line">执行权限：所有用户</span><br><span class="line">语法：mount [-t 文件系统] 设备文件名 挂载点</span><br><span class="line">范例：# mount -t iso9660 /dev/sr0 /mnt/cdrom</span><br></pre></td></tr></table></figure>

<h2 id="关机重启命令"><a href="#关机重启命令" class="headerlink" title="关机重启命令"></a>关机重启命令</h2><h3 id="shutdown"><a href="#shutdown" class="headerlink" title="shutdown"></a>shutdown</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# shutdown [选项] 时间</span><br><span class="line">选项：</span><br><span class="line">    -c：取消前一个关机命令</span><br><span class="line">    -h：关机</span><br><span class="line">    -r：重启</span><br></pre></td></tr></table></figure>

<h3 id="其他关机命令"><a href="#其他关机命令" class="headerlink" title="其他关机命令"></a>其他关机命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# halt</span><br><span class="line">[root@localhost ~]# poweroff</span><br><span class="line">[root@localhost ~]# init 0</span><br></pre></td></tr></table></figure>

<h3 id="其他重启命令"><a href="#其他重启命令" class="headerlink" title="其他重启命令"></a>其他重启命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# reboot</span><br><span class="line">[root@localhost ~]# init 6</span><br></pre></td></tr></table></figure>

<h3 id="系统运行级别"><a href="#系统运行级别" class="headerlink" title="系统运行级别"></a>系统运行级别</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# runlevel #查询系统运行级别</span><br><span class="line">        0 关机</span><br><span class="line">        1 单用户</span><br><span class="line">        2 不完全多用户，不含NFS服务</span><br><span class="line">        3 完全多用户</span><br><span class="line">        4 未分配</span><br><span class="line">        5 图形界面</span><br><span class="line">        6 重启</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# cat /etc/inittab #修改系统默认运行级别</span><br><span class="line">    id:3:initdefault:</span><br></pre></td></tr></table></figure>

<h3 id="退出登录命令"><a href="#退出登录命令" class="headerlink" title="退出登录命令"></a>退出登录命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# logout</span><br></pre></td></tr></table></figure>

<h1 id="文本编辑器Vim"><a href="#文本编辑器Vim" class="headerlink" title="文本编辑器Vim"></a>文本编辑器Vim</h1><p><img src="/../images/Snipaste_2023-08-20_12-50-39.png" alt="img"></p>
<h2 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h2><h3 id="插入命令"><a href="#插入命令" class="headerlink" title="插入命令"></a>插入命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>在光标所在字符后插入</td>
</tr>
<tr>
<td>A</td>
<td>在光标所在行尾插入</td>
</tr>
<tr>
<td>i</td>
<td>在光标所在字符前插入</td>
</tr>
<tr>
<td>I</td>
<td>在光标所在行行首插入</td>
</tr>
<tr>
<td>o</td>
<td>在光标下插入新行</td>
</tr>
<tr>
<td>O</td>
<td>在光标上插入新行</td>
</tr>
</tbody></table>
<h3 id="定位命令"><a href="#定位命令" class="headerlink" title="定位命令"></a>定位命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>:set nu</td>
<td>设置行号</td>
</tr>
<tr>
<td>:set nonu</td>
<td>取消行号</td>
</tr>
<tr>
<td>gg</td>
<td>到第一行</td>
</tr>
<tr>
<td>G</td>
<td>到最后一行</td>
</tr>
<tr>
<td>nG</td>
<td>到第n行</td>
</tr>
<tr>
<td>:n</td>
<td>到第n行</td>
</tr>
<tr>
<td>$</td>
<td>移至行尾</td>
</tr>
<tr>
<td>0</td>
<td>移至行首</td>
</tr>
</tbody></table>
<h3 id="删除命令"><a href="#删除命令" class="headerlink" title="删除命令"></a>删除命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>x</td>
<td>删除光标所在处字符</td>
</tr>
<tr>
<td>nx</td>
<td>删除光标所在处后n个字符</td>
</tr>
<tr>
<td>dd</td>
<td>删除光标所在行</td>
</tr>
<tr>
<td>ndd</td>
<td>从光标所在行开始删除n行</td>
</tr>
<tr>
<td>dG</td>
<td>删除光标所在行到文件末尾内容</td>
</tr>
<tr>
<td>D</td>
<td>删除光标所在处到行尾内容</td>
</tr>
<tr>
<td>:n1,n2d</td>
<td>删除指定范围的行</td>
</tr>
</tbody></table>
<h3 id="复制和剪切命令"><a href="#复制和剪切命令" class="headerlink" title="复制和剪切命令"></a>复制和剪切命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>yy</td>
<td>复制当前行</td>
</tr>
<tr>
<td>nyy</td>
<td>复制当前行以下n行</td>
</tr>
<tr>
<td>dd</td>
<td>剪切当前行</td>
</tr>
<tr>
<td>ndd</td>
<td>剪切当前行以下n行</td>
</tr>
<tr>
<td>dw</td>
<td>剪切单词</td>
</tr>
<tr>
<td>p</td>
<td>粘贴在当前光标所在行下</td>
</tr>
<tr>
<td>P</td>
<td>粘贴在当前光标所在行上</td>
</tr>
</tbody></table>
<h3 id="替换和取消命令"><a href="#替换和取消命令" class="headerlink" title="替换和取消命令"></a>替换和取消命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>r</td>
<td>取代光标所在处字符</td>
</tr>
<tr>
<td>R</td>
<td>从光标所在处开始替换字符，按Esc结束</td>
</tr>
<tr>
<td>u</td>
<td>取消上一步操作</td>
</tr>
</tbody></table>
<h3 id="搜索和搜索替换命令"><a href="#搜索和搜索替换命令" class="headerlink" title="搜索和搜索替换命令"></a>搜索和搜索替换命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;string</td>
<td>搜索指定字符串 搜索时忽略大小写:set ic</td>
</tr>
<tr>
<td>n</td>
<td>搜索指定字符串的下一个出现位置</td>
</tr>
<tr>
<td>N</td>
<td>搜索指定字符串的上一个出现位置</td>
</tr>
<tr>
<td>:%s&#x2F;old&#x2F;new&#x2F;g</td>
<td>全文替换指定字符串</td>
</tr>
<tr>
<td>:n1,n2s&#x2F;old&#x2F;new&#x2F;g</td>
<td>在一定范围内替换指定字符串</td>
</tr>
</tbody></table>
<h3 id="保存和退出命令"><a href="#保存和退出命令" class="headerlink" title="保存和退出命令"></a>保存和退出命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>:w</td>
<td>保存修改</td>
</tr>
<tr>
<td>:w new_filename</td>
<td>另存为指定文件</td>
</tr>
<tr>
<td>:wq</td>
<td>保存修改并退出</td>
</tr>
<tr>
<td>ZZ</td>
<td>快捷键，保存修改并退出</td>
</tr>
<tr>
<td>:q!</td>
<td>不保存修改退出</td>
</tr>
<tr>
<td>:wq!</td>
<td>保存修改并退出（文件所有者及root可使用）</td>
</tr>
</tbody></table>
<h2 id="使用技巧"><a href="#使用技巧" class="headerlink" title="使用技巧"></a>使用技巧</h2><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>:r !命令</td>
<td>导入命令执行结果</td>
</tr>
<tr>
<td>:map 快捷键 触发命令</td>
<td>定义快捷键 :map ^P I#<ESC> :map ^B 0x</td>
</tr>
<tr>
<td>:n1,n2s&#x2F;^&#x2F;#&#x2F;g</td>
<td>连续行#号注释</td>
</tr>
<tr>
<td>:n1,n2s&#x2F;^#&#x2F;&#x2F;g</td>
<td>连续行取消#号注释</td>
</tr>
<tr>
<td>:n1,n2s&#x2F;^&#x2F;&#x2F;&#x2F;&#x2F;g</td>
<td></td>
</tr>
<tr>
<td>:ab mymail <a href="mailto:123@qq.net">123@qq.net</a></td>
<td>设置简写</td>
</tr>
<tr>
<td>:ab mymail <a href="mailto:123@qq.net">123@qq.net</a></td>
<td>设置简写</td>
</tr>
<tr>
<td>:unab mymail</td>
<td>取消设置简写</td>
</tr>
</tbody></table>
<h1 id="Linux软件安装"><a href="#Linux软件安装" class="headerlink" title="Linux软件安装"></a>Linux软件安装</h1><p>软件包分类</p>
<ul>
<li>源码包</li>
<li>二进制包（RPM包、系统默认包）</li>
</ul>
<h2 id="RPM包管理"><a href="#RPM包管理" class="headerlink" title="RPM包管理"></a>RPM包管理</h2><blockquote>
<p>模块依赖查询网站：<a target="_blank" rel="noopener" href="http://www.rpmfind.net/">www.rpmfind.net</a></p>
</blockquote>
<p>默认安装位置：</p>
<table>
<thead>
<tr>
<th>目录</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;etc&#x2F;</td>
<td>配置文件安装目录</td>
</tr>
<tr>
<td>&#x2F;usr&#x2F;bin&#x2F;</td>
<td>可执行的命令安装目录</td>
</tr>
<tr>
<td>&#x2F;usr&#x2F;lib&#x2F;</td>
<td>程序所使用的函数库保存位置</td>
</tr>
<tr>
<td>&#x2F;usr&#x2F;share&#x2F;doc&#x2F;</td>
<td>基本的软件使用手册保存位置</td>
</tr>
<tr>
<td>&#x2F;usr&#x2F;share&#x2F;man&#x2F;</td>
<td>帮助文件保存位置</td>
</tr>
</tbody></table>
<h3 id="RPM-包安装"><a href="#RPM-包安装" class="headerlink" title="RPM 包安装"></a>RPM 包安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rpm –ivh 包全名</span><br><span class="line">选项：</span><br><span class="line">    -i（install） 安装</span><br><span class="line">    -v（verbose） 显示详细信息</span><br><span class="line">    -h（hash） 显示进度</span><br><span class="line">    --nodeps 不检测依赖性</span><br></pre></td></tr></table></figure>

<h3 id="RPM-包升级"><a href="#RPM-包升级" class="headerlink" title="RPM 包升级"></a>RPM 包升级</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm  -Uvh  包全名</span><br><span class="line">选项：</span><br><span class="line">    -U（upgrade） 升级</span><br></pre></td></tr></table></figure>

<h3 id="RPM-包卸载"><a href="#RPM-包卸载" class="headerlink" title="RPM 包卸载"></a>RPM 包卸载</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm  -e  包名</span><br><span class="line">选项：</span><br><span class="line">    -e（erase） 卸载</span><br><span class="line">    --nodeps 不检查依赖性</span><br></pre></td></tr></table></figure>

<h3 id="RPM-包查询"><a href="#RPM-包查询" class="headerlink" title="RPM 包查询"></a>RPM 包查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rpm  -q  包名</span><br><span class="line">选项：</span><br><span class="line">    -q 查询（query）</span><br><span class="line">    -a 所有（all）</span><br><span class="line">    -i 查询软件信息（information）</span><br><span class="line">    -l 列表（list）</span><br><span class="line">    -f 查询系统文件属于哪个软件包（file）</span><br><span class="line">    -R 查询软件包的依赖性（requires）</span><br><span class="line">    -p 查询未安装包信息（package）</span><br></pre></td></tr></table></figure>

<h3 id="RPM-包校验"><a href="#RPM-包校验" class="headerlink" title="RPM 包校验"></a>RPM 包校验</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pm –V 已安装的包名</span><br><span class="line">选项：</span><br><span class="line">    -V 校验指定RPM包中的文件（verify）</span><br></pre></td></tr></table></figure>

<p>验证内容中的8个信息的具体内容如下：</p>
<table>
<thead>
<tr>
<th>标志</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>S</td>
<td>文件大小是否改变</td>
</tr>
<tr>
<td>M</td>
<td>文件的类型或文件的权限（rwx）是否被改变</td>
</tr>
<tr>
<td>5</td>
<td>文件MD5校验和是否改变（可以看成文件内容是否改变）</td>
</tr>
<tr>
<td>D</td>
<td>设备的中，从代码是否改变</td>
</tr>
<tr>
<td>L</td>
<td>文件路径是否改变</td>
</tr>
<tr>
<td>U</td>
<td>文件的属主（所有者）是否改变</td>
</tr>
<tr>
<td>G</td>
<td>文件的属组是否改变</td>
</tr>
<tr>
<td>T</td>
<td>文件的修改时间是否改变</td>
</tr>
</tbody></table>
<p>文件类型</p>
<table>
<thead>
<tr>
<th>标志</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>c</td>
<td>配置文件（config file）</td>
</tr>
<tr>
<td>d</td>
<td>普通文档（documentation）</td>
</tr>
<tr>
<td>g</td>
<td>“鬼”文件（ghost file），很少见，就是该文件不应该被这个RPM包包含</td>
</tr>
<tr>
<td>l</td>
<td>授权文件（license file）</td>
</tr>
<tr>
<td>r</td>
<td>描述文件（read me）</td>
</tr>
</tbody></table>
<h3 id="RPM包中提取文件"><a href="#RPM包中提取文件" class="headerlink" title="RPM包中提取文件"></a>RPM包中提取文件</h3><ul>
<li><p>rpm2cpio 将rpm包转换为cpio格式的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm2cpio 包全名 |  \cpio -idv .文件绝对路径</span><br></pre></td></tr></table></figure>
</li>
<li><p>cpio 是一个标准工具，它用于创建软件档案文件和从档案文件中提取文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cpio 选项&lt; [文件|设备]</span><br><span class="line">选项：</span><br><span class="line">    -i：copy-in模式，还原</span><br><span class="line">    -d：还原时自动新建目录</span><br><span class="line">    -v：显示还原过程</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# rpm -qf /bin/ls</span><br><span class="line">#查询ls命令属于哪个软件包</span><br><span class="line">[root@localhost ~]# mv /bin/ls /tmp/</span><br><span class="line">#造成ls命令误删除假象</span><br><span class="line">[root@localhost ~]# rpm2cpio /mnt/cdrom/Packages/coreutils-</span><br><span class="line">8.4-19.el6.i686.rpm | cpio -idv  ./bin/ls</span><br><span class="line">#提取RPM包中ls命令到当前目录的/bin/ls下</span><br><span class="line">[root@localhost ~]# cp /root/bin/ls  /bin/</span><br><span class="line">#把ls命令复制会/bin/目录，修复文件丢失</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="yum在线管理"><a href="#yum在线管理" class="headerlink" title="yum在线管理"></a>yum在线管理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost]# vi /etc/yum.repos.d/CentOS-Base.repo</span><br><span class="line"></span><br><span class="line">[base]          容器名称，一定要放在[]中</span><br><span class="line">name            容器说明，可以自己随便写</span><br><span class="line">mirrorlist      镜像站点，这个可以注释掉</span><br><span class="line">baseurl         我们的yum源服务器的地址。默认是CentOS官方的yum源服务器，是可以使用的，如果你觉得慢可以改成你喜欢的yum源地址</span><br><span class="line">enabled         此容器是否生效，如果不写或写成enable=1都是生效，写成enable=0就是不生效</span><br><span class="line">gpgcheck        如果是1是指RPM的数字证书生效，如果是0则不生效</span><br><span class="line">gpgkey          数字证书的公钥文件保存位置。不用修改</span><br></pre></td></tr></table></figure>

<h3 id="常用yum命令"><a href="#常用yum命令" class="headerlink" title="常用yum命令"></a>常用yum命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">yum list</span><br><span class="line">#查询所有可用软件包列表</span><br><span class="line"></span><br><span class="line">yum search 关键字</span><br><span class="line">#搜索服务器上所有和关键字相关的包</span><br><span class="line"></span><br><span class="line">yum –y install 包名</span><br><span class="line"></span><br><span class="line">yum -y update 包名</span><br><span class="line"></span><br><span class="line">yum -y remove</span><br><span class="line"></span><br><span class="line">yum grouplist</span><br><span class="line">#列出所有可用的软件组列表</span><br><span class="line"></span><br><span class="line">yum groupinstall 软件组名</span><br><span class="line">#安装指定软件组，组名可以由grouplist查询出来</span><br><span class="line"></span><br><span class="line">yum groupremove 软件组名</span><br><span class="line">#卸载指定软件组</span><br></pre></td></tr></table></figure>

<h3 id="光盘yum源搭建"><a href="#光盘yum源搭建" class="headerlink" title="光盘yum源搭建"></a>光盘yum源搭建</h3><ol>
<li><p>挂载光盘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount /dev/cdrom  /mnt/cdrom/</span><br></pre></td></tr></table></figure>
</li>
<li><p>让网络yum源文件失效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cd /etc/yum.repos.d/</span><br><span class="line">[root@localhost yum.repos.d]# mv CentOS-Base.repo CentOS-Base.repo.bak[root@localhost yum.repos.d]# mv CentOS-Debuginfo.repo CentOS-Debuginfo.repo.bak</span><br><span class="line">[root@localhost yum.repos.d]# mv CentOS-Vault.repo CentOS-Vault.repo.bak</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改光盘yum源文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# vim CentOS-Media.repo</span><br><span class="line"></span><br><span class="line">[c6-media]</span><br><span class="line">name=CentOS-$releasever - Media</span><br><span class="line">baseurl=file:///mnt/cdrom</span><br><span class="line">#地址为你自己的光盘挂载地址</span><br><span class="line">#        file:///media/cdrom/</span><br><span class="line">#        file:///media/cdrecorder/</span><br><span class="line">#注释这两个不存在的地址</span><br><span class="line">gpgcheck=1enabled=1</span><br><span class="line">#把enabled=0改为enabled=1，让这个yum源配置文件生效</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="源码包管理"><a href="#源码包管理" class="headerlink" title="源码包管理"></a>源码包管理</h2><p>源码包安装在指定位置当中，一般是 <code>/usr/local/软件名/</code></p>
<p>启动方法和RPM包的区别：</p>
<ul>
<li><p>RPM包安装的服务可以使用系统服务管理命令（service）来管理，例如RPM包安装的apache的启动方法是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.d/init.d/httpd start</span><br><span class="line">service httpd start</span><br></pre></td></tr></table></figure>
</li>
<li><p>源码包安装的服务则不能被服务管理命<br>令管理，因为没有安装到默认路径中。所<br>以只能用绝对路径进行服务的管理，如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/apache2/bin/apachectl start</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="源码包安装"><a href="#源码包安装" class="headerlink" title="源码包安装"></a>源码包安装</h3><p>1、安装准备</p>
<ul>
<li>安装C语言编译器</li>
<li>下载源码包 <a target="_blank" rel="noopener" href="http://mirror.bit.edu.cn/apache/httpd/">http://mirror.bit.edu.cn/apache/httpd/</a></li>
</ul>
<p>2、安装注意事项</p>
<ul>
<li>源代码保存位置：&#x2F;usr&#x2F;local&#x2F;src&#x2F;</li>
<li>软件安装位置：&#x2F;usr&#x2F;local&#x2F;</li>
<li>如何确定安装过程报错：<ul>
<li>安装过程停止</li>
<li>并出现error、warning或no的提示</li>
</ul>
</li>
</ul>
<p>3、源码包安装过程</p>
<ul>
<li>下载源码包</li>
<li>解压缩下载的源码包</li>
<li>进入解压缩目录</li>
<li>.&#x2F;configure 软件配置与检查<ul>
<li>定义需要的功能选项。</li>
<li>检测系统环境是否符合安装要求。</li>
<li>把定义好的功能选项和检测系统环境的信息都写入Makefile文件，用于后续的编辑。</li>
</ul>
</li>
<li>make 编译</li>
<li>make clean</li>
<li>make install 编译安装</li>
</ul>
<p>4、源码包的卸载</p>
<ul>
<li>不需要卸载命令，直接删除安装目录即可。不会遗留任何垃圾文件。</li>
</ul>
<h1 id="用户和用户组管理"><a href="#用户和用户组管理" class="headerlink" title="用户和用户组管理"></a>用户和用户组管理</h1><h2 id="用户配置文件"><a href="#用户配置文件" class="headerlink" title="用户配置文件"></a>用户配置文件</h2><h3 id="用户信息文件-etc-passwd"><a href="#用户信息文件-etc-passwd" class="headerlink" title="用户信息文件&#x2F;etc&#x2F;passwd"></a>用户信息文件&#x2F;etc&#x2F;passwd</h3><p>1、&#x2F;etc&#x2F;passwd</p>
<p><img src="/../images/Snipaste_2023-08-27_11-59-10.png" alt="img"></p>
<ul>
<li>第1字段：用户名称</li>
<li>第2字段：密码标志</li>
<li>第3字段：UID（用户ID）<ul>
<li>0： 超级用户</li>
<li>1-499： 系统用户（伪用户）</li>
<li>500-65535： 普通用户</li>
</ul>
</li>
<li>第4字段：GID（用户初始组ID）</li>
<li>第5字段：用户说明</li>
<li>第6字段：家目录<ul>
<li>普通用户：&#x2F;home&#x2F;用户名&#x2F;</li>
<li>超级用户：&#x2F;root&#x2F;</li>
</ul>
</li>
<li>第7字段：登录之后的Shell</li>
</ul>
<p>2、初始组和附加组</p>
<ul>
<li>初始组：就是指用户一登录就立刻拥有这个用户组的相关权限，每个用户的初始组只能有一个，一般就是和这个用户的用户名相同的组名作为这个用户的初始组。</li>
<li>附加组：指用户可以加入多个其他的用户组，并拥有这些组的权限，附加组可以有多个。</li>
</ul>
<h3 id="影子文件-etc-shadow"><a href="#影子文件-etc-shadow" class="headerlink" title="影子文件&#x2F;etc&#x2F;shadow"></a>影子文件&#x2F;etc&#x2F;shadow</h3><p>1、影子文件&#x2F;etc&#x2F;shadow</p>
<p><img src="/../images/Snipaste_2023-08-27_12-03-29.png" alt="img"></p>
<ul>
<li>第1字段：用户名</li>
<li>第2字段：加密密码<ul>
<li>加密算法升级为SHA512散列加密算法</li>
<li>如果密码位是“!!”或“*”代表没有密码，不能登录</li>
</ul>
</li>
<li>第3字段：密码最后一次修改日期<ul>
<li>使用1970年1月1日作为标准时间，每过一天时间戳加1</li>
</ul>
</li>
<li>第4字段：两次密码的修改间隔时间（和第3字段相比）</li>
<li>第5字段：密码有效期（和第3字段相比）</li>
<li>第6字段：密码修改到期前的警告天数（和第5字段相比）</li>
<li>第7字段：密码过期后的宽限天数（和第5字段相比）<ul>
<li>0：代表密码过期后立即失效</li>
<li>-1：则代表密码永远不会失效。</li>
</ul>
</li>
<li>第8字段：账号失效时间<ul>
<li>要用时间戳表示</li>
</ul>
</li>
<li>第9字段：保留</li>
</ul>
<h3 id="组信息文件-etc-group和组密码文件-etc-gshadow"><a href="#组信息文件-etc-group和组密码文件-etc-gshadow" class="headerlink" title="组信息文件&#x2F;etc&#x2F;group和组密码文件&#x2F;etc&#x2F;gshadow"></a>组信息文件&#x2F;etc&#x2F;group和组密码文件&#x2F;etc&#x2F;gshadow</h3><p>1、组信息文件&#x2F;etc&#x2F;group</p>
<p><img src="/../images/Snipaste_2023-08-27_12-05-36.png" alt="img"></p>
<ul>
<li>第一字段：组名</li>
<li>第二字段：组密码标志</li>
<li>第三字段：GID</li>
<li>第四字段：组中附加用户</li>
</ul>
<p>2、组密码文件&#x2F;etc&#x2F;gshadow</p>
<p><img src="/../images/Snipaste_2023-08-27_12-06-10.png" alt="img"></p>
<ul>
<li>第一字段：组名</li>
<li>第二字段：组密码</li>
<li>第三字段：组管理员用户名</li>
<li>第四字段：组中附加用户</li>
</ul>
<h2 id="用户管理相关文件"><a href="#用户管理相关文件" class="headerlink" title="用户管理相关文件"></a>用户管理相关文件</h2><p>1、用户的家目录</p>
<ul>
<li>普通用户：&#x2F;home&#x2F;用户名&#x2F;，所有者和所属组都是此用户，权限是700</li>
<li>超级用户：&#x2F;root&#x2F;，所有者和所属组都是root用户，权限是550</li>
</ul>
<p>2、用户的邮箱 &#x2F;var&#x2F;spool&#x2F;mail&#x2F;用户名&#x2F;</p>
<p>3、用户模板目录 &#x2F;etc&#x2F;skel&#x2F;</p>
<h2 id="用户管理命令-1"><a href="#用户管理命令-1" class="headerlink" title="用户管理命令"></a>用户管理命令</h2><h3 id="用户添加命令useradd"><a href="#用户添加命令useradd" class="headerlink" title="用户添加命令useradd"></a>用户添加命令useradd</h3><p>1、useradd命令格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#useradd [选项] 用户名 </span><br><span class="line">    选项： </span><br><span class="line">        -u UID： 手工指定用户的UID号  -d 家目录： 手工指定用户的家目录 </span><br><span class="line">        -c 用户说明： 手工指定用户的说明 </span><br><span class="line">        -g 组名： 手工指定用户的初始组  -G 组名：  指定用户的附加组 </span><br><span class="line">        -s shell： 手工指定用户的登录shell。默认是/bin/bash </span><br></pre></td></tr></table></figure>

<p>2、添加默认用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# useradd lamp </span><br><span class="line">[root@localhost ~]# grep &quot;lamp&quot; /etc/passwd </span><br><span class="line">[root@localhost ~]# grep &quot;lamp&quot; /etc/shadow </span><br><span class="line">[root@localhost ~]# grep &quot;lamp&quot; /etc/group </span><br><span class="line">[root@localhost ~]# grep &quot;lamp&quot; /etc/gshadow </span><br><span class="line">[root@localhost ~]# ll -d /home/lamp/ </span><br><span class="line">[root@localhost ~]# ll /var/spool/mail/lamp  </span><br></pre></td></tr></table></figure>

<p>3、指定选项添加用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groupadd lamp1 </span><br><span class="line">useradd -u 550 -g lamp1 -G root -d /home/lamp1  \ </span><br><span class="line">    -c &quot;test user&quot; -s /bin/bash lamp1 </span><br></pre></td></tr></table></figure>

<p>4、用户默认值文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/default/useradd </span><br><span class="line"></span><br><span class="line">GROUP=100  #用户默认组 </span><br><span class="line">HOME=/home #用户家目录 </span><br><span class="line">INACTIVE=-1 #密码过期宽限天数（7） </span><br><span class="line">EXPIRE=  #密码失效时间（8） </span><br><span class="line">SHELL=/bin/bash #默认shell </span><br><span class="line">SKEL=/etc/skel #模板目录 </span><br><span class="line">CREATE_MAIL_SPOOL=yes #是否建立邮箱 </span><br><span class="line"></span><br><span class="line">cat /etc/login.defs  </span><br><span class="line"></span><br><span class="line">PASS_MAX_DAYS 99999  #密码有效期（5） </span><br><span class="line">PASS_MIN_DAYS 0 #密码修改间隔（4） </span><br><span class="line">PASS_MIN_LEN 5 #密码最小5位（PAM） </span><br><span class="line">PASS_WARN_AGE 7 #密码到期警告（6） </span><br><span class="line">UID_MIN  500 #最小和最大UID范围 </span><br><span class="line">GID_MAX  60000 </span><br><span class="line">ENCRYPT_METHOD SHA512 #加密模式</span><br></pre></td></tr></table></figure>

<h3 id="修改用户密码passwd"><a href="#修改用户密码passwd" class="headerlink" title="修改用户密码passwd"></a>修改用户密码passwd</h3><p>1、passwd命令格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#passwd [选项] 用户名 </span><br><span class="line">    选项： </span><br><span class="line">        -S  查询用户密码的密码状态。仅root用户可用。 </span><br><span class="line">        -l  暂时锁定用户。仅root用户可用 </span><br><span class="line">        -u  解锁用户。仅root用户可用  --stdin 可以通过管道符输出的数据作为用户的密码。</span><br></pre></td></tr></table></figure>

<p>2、查看密码状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# passwd -S lamp </span><br><span class="line">    lamp PS 2013-01-06 0 99999 7 -1  </span><br><span class="line">    #用户名 密码设定时间（2013-01-06） 密码修改间隔时间（0） </span><br><span class="line">    #密码有效期（99999 ）  警告时间（7） 密码不失效（-1） </span><br></pre></td></tr></table></figure>

<p>3、锁定用户和解锁用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# passwd -l lamp </span><br><span class="line">[root@localhost ~]# passwd -u lamp </span><br></pre></td></tr></table></figure>

<p>4、使用字符串作为用户的密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# echo &quot;123&quot; | passwd --stdin lamp</span><br></pre></td></tr></table></figure>

<h3 id="修改用户信息usermod和修改用户密码状态chage"><a href="#修改用户信息usermod和修改用户密码状态chage" class="headerlink" title="修改用户信息usermod和修改用户密码状态chage"></a>修改用户信息usermod和修改用户密码状态chage</h3><p>1、修改用户信息usermod</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#usermod [选项] 用户名 </span><br><span class="line">    选项： </span><br><span class="line">        -u UID：     修改用户的UID号  </span><br><span class="line">        -c 用户说明： 修改用户的说明信息 </span><br><span class="line">        -G 组名：     修改用户的附加组 </span><br><span class="line">        -L：         临时锁定用户（Lock）  </span><br><span class="line">        -U：         解锁用户锁定（Unlock） </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# usermod -c &quot;test user&quot; lamp </span><br><span class="line">#修改用户的说明 </span><br><span class="line">[root@localhost ~]# usermod -G root lamp </span><br><span class="line">#把lamp用户加入root组 </span><br><span class="line">[root@localhost ~]# usermod -L lamp </span><br><span class="line">#锁定用户 </span><br><span class="line">[root@localhost ~]# usermod -U lamp </span><br><span class="line">#解锁用户 </span><br></pre></td></tr></table></figure>

<p>2、修改用户密码状态chage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#chage [选项] 用户名 </span><br><span class="line">    选项：  </span><br><span class="line">        -l：      列出用户的详细密码状态 </span><br><span class="line">        -d 日期：  修改密码最后一次更改日期（shadow3字段）</span><br><span class="line">        -m 天数：  两次密码修改间隔（4字段）  </span><br><span class="line">        -M 天数：  密码有效期（5字段） </span><br><span class="line">        -W 天数：  密码过期前警告天数（6字段） </span><br><span class="line">        -I 天数：  密码过后宽限天数（7字段）  </span><br><span class="line">        -E 日期：  账号失效时间（8字段） </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# chage -d 0 lamp   </span><br><span class="line">#这个命令其实是把密码修改日期归0了（shadow第3字段）</span><br><span class="line">#这样用户一登陆就要修改密码</span><br></pre></td></tr></table></figure>

<h3 id="删除用户userdel和用户切换命令su"><a href="#删除用户userdel和用户切换命令su" class="headerlink" title="删除用户userdel和用户切换命令su"></a>删除用户userdel和用户切换命令su</h3><p>1、删除用户userdel</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# userdel [-r] 用户名 </span><br><span class="line">    选项： </span><br><span class="line">        -r 删除用户的同时删除用户家目录  </span><br><span class="line"></span><br><span class="line"># 手工删除用户 </span><br><span class="line">[root@localhost ~]# vi /etc/passwd </span><br><span class="line">[root@localhost ~]# vi /etc/shadow </span><br><span class="line">[root@localhost ~]# vi /etc/group </span><br><span class="line">[root@localhost ~]# vi /etc/gshadow </span><br><span class="line">[root@localhost ~]# rm -rf /var/spool/mail/lamp </span><br><span class="line">[root@localhost ~]# rm -rf /home/lamp/ </span><br></pre></td></tr></table></figure>

<p>2、查看用户ID</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# id 用户名 </span><br></pre></td></tr></table></figure>

<p>3、切换用户身份su</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# su [选项] 用户名 </span><br><span class="line">    选项： </span><br><span class="line">        -  ： 选项只使用“-”代表连带用户的环境变量一起切换 </span><br><span class="line">        -c 命令： 仅执行一次命令，而不切换用户身份 </span><br><span class="line"> </span><br><span class="line">[lamp@localhost ~]$ su – root </span><br><span class="line">#切换成root </span><br><span class="line"> </span><br><span class="line">[lamp@localhost ~]$ su - root -c &quot;useradd user3&quot; </span><br><span class="line">#不切换成root，但是执行useradd命令添加user1用户</span><br></pre></td></tr></table></figure>

<h2 id="用户组管理命令"><a href="#用户组管理命令" class="headerlink" title="用户组管理命令"></a>用户组管理命令</h2><p>1、添加用户组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groupadd [选项] 组名</span><br><span class="line">选项：</span><br><span class="line">    -g GID:     指定组ID</span><br></pre></td></tr></table></figure>

<p>2、修改用户组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">groupmod [选项] 组名</span><br><span class="line">选项：</span><br><span class="line">    -g GID:       修改组ID</span><br><span class="line">    -n 新组名:     修改组名</span><br><span class="line"></span><br><span class="line">groupmod -n newgroup group1</span><br><span class="line"># 把组名group1修改为newgroup</span><br></pre></td></tr></table></figure>

<p>3、删除用户组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupdel 组名</span><br></pre></td></tr></table></figure>

<p>4、把用户加入组或从组中删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gpasswd [选项] 组名</span><br><span class="line">选项：</span><br><span class="line">    -a 用户名:     把用户加入组</span><br><span class="line">    -d 用户名:     把用户从组中删除</span><br></pre></td></tr></table></figure>

<h1 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h1><h2 id="ACL权限"><a href="#ACL权限" class="headerlink" title="ACL权限"></a>ACL权限</h2><h3 id="ACL权限简介与开启"><a href="#ACL权限简介与开启" class="headerlink" title="ACL权限简介与开启"></a>ACL权限简介与开启</h3><p>1、ACL权限简介</p>
<p><img src="/../images/Snipaste_2023-08-27_15-39-42.png" alt="img"></p>
<p>2、查看分区ACL权限是否开启</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# dumpe2fs -h /dev/sda3 </span><br><span class="line">#dumpe2fs命令是查询指定分区详细文件系统信息的命令 </span><br><span class="line">    选项：  </span><br><span class="line">        -h 仅显示超级块中信息，而不显示磁盘块组的详细信息 </span><br></pre></td></tr></table></figure>

<p>3、临时开启分区ACL权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount -o remount,acl / </span><br><span class="line">#重新挂载根分区，并挂载加入acl权限 </span><br></pre></td></tr></table></figure>

<p>4、永久开启分区ACL权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi /etc/fstab </span><br><span class="line">UUID=c2ca6f57-b15c-43ea-bca0-f239083d8bd2  /   ext4    defaults,acl        1  1 </span><br><span class="line">#加入acl </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# mount -o remount / </span><br><span class="line">#重新挂载文件系统或重启动系统，使修改生效</span><br></pre></td></tr></table></figure>

<h3 id="查看与设定ACL权限"><a href="#查看与设定ACL权限" class="headerlink" title="查看与设定ACL权限"></a>查看与设定ACL权限</h3><p>1、查看ACL命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# getfacle 文件名 </span><br><span class="line">#查看acl权限 </span><br></pre></td></tr></table></figure>

<p>2、设定ACL权限的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# setfacl 选项 文件名 </span><br><span class="line">    选项： </span><br><span class="line">        -m  设定ACL权限  </span><br><span class="line">        -x  删除指定的ACL权限  </span><br><span class="line">        -b  删除所有的ACL权限  </span><br><span class="line">        -d  设定默认ACL权限。  </span><br><span class="line">        -k  删除默认ACL权限  </span><br><span class="line">        -R  递归设定ACL权限。 </span><br></pre></td></tr></table></figure>

<p>3、给用户设定ACL权限</p>
<p><img src="/../images/Snipaste_2023-08-27_15-46-12.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# useradd zhangsan </span><br><span class="line">[root@localhost ~]# useradd lisi </span><br><span class="line">[root@localhost ~]# useradd st </span><br><span class="line">[root@localhost ~]# groupadd tgroup </span><br><span class="line">[root@localhost ~]# mkdir /project </span><br><span class="line">[root@localhost ~]# chown root:tgroup /project/ </span><br><span class="line">[root@localhost ~]# chmod 770 /project/ </span><br><span class="line">[root@localhost ~]# setfacl -m u:st:rx /project/ </span><br><span class="line">#给用户st赋予r-x权限，使用“u:用户名:权限”格式 </span><br></pre></td></tr></table></figure>

<p>4、给用户组设定ACL权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# groupadd tgroup2 </span><br><span class="line">[root@localhost /]# setfacl -m g:tgroup2:rwx project/ </span><br><span class="line">#为组tgroup2分配ACl权限。使用“g:组名:权限”格式</span><br></pre></td></tr></table></figure>

<h3 id="最大有效权限与删除ACL权限"><a href="#最大有效权限与删除ACL权限" class="headerlink" title="最大有效权限与删除ACL权限"></a>最大有效权限与删除ACL权限</h3><p>1、最大有效权限mask</p>
<ul>
<li><p>mask是用来指定最大有效权限的。如果我给用户赋予了ACL权限，是需要和mask的权限“相与”才能得到用户的真正权限</p>
</li>
<li><p>修改最大有效权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# setfacl -m m:rx 文件名 </span><br><span class="line">#设定mask权限为r-x。使用“m:权限”格式 </span><br></pre></td></tr></table></figure></li>
</ul>
<p>2、删除ACL权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# setfacl -x u:用户名 文件名 </span><br><span class="line">#删除指定用户的ACL权限 </span><br><span class="line"> </span><br><span class="line">[root@localhost /]# setfacl -x g:组名 文件名 </span><br><span class="line">#删除指定用户组的ACL权限 </span><br><span class="line"> </span><br><span class="line">[root@localhost /]# setfacl -b 文件名 </span><br><span class="line">#会删除文件的所有的ACL权限</span><br></pre></td></tr></table></figure>

<h3 id="默认ACL权限和递归ACL权限"><a href="#默认ACL权限和递归ACL权限" class="headerlink" title="默认ACL权限和递归ACL权限"></a>默认ACL权限和递归ACL权限</h3><p>1、递归ACL权限</p>
<ul>
<li>递归是父目录在设定ACL权限时，所有的子文件和子目录也会拥有相同的ACL权限。</li>
<li>setfacl -m u:用户名:权限 -R 文件名</li>
</ul>
<p>2、默认ACL权限</p>
<ul>
<li>默认ACL权限的作用是如果给父目录设定了默认ACL权限，那么父目录中所有新建的子文件都会继承父目录的ACL权限。</li>
<li>setfacl -m d:u:用户名:权限 文件名</li>
</ul>
<h2 id="文件特殊权限"><a href="#文件特殊权限" class="headerlink" title="文件特殊权限"></a>文件特殊权限</h2><h3 id="SetUID"><a href="#SetUID" class="headerlink" title="SetUID"></a>SetUID</h3><p>1、SetUID的功能</p>
<ul>
<li><p>只有可以执行的二进制程序才能设定SUID权限</p>
</li>
<li><p>命令执行者要对该程序拥有x（执行）权限</p>
</li>
<li><p>命令执行者在执行该程序时获得该程序文件属主的身份（在执行程序的过程中灵魂附体为文件的属主）</p>
</li>
<li><p>SetUID权限只在该程序执行过程中有效，也就是说身份改变只在程序执行过程中有效</p>
</li>
<li><p>passwd命令拥有SetUID权限，所以普通可以修改自己的密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ll /usr/bin/passwd  </span><br><span class="line">-rwsr-xr-x. 1 root root 25980 2月  22 2012 /usr/bin/passwd </span><br></pre></td></tr></table></figure>
</li>
<li><p>cat命令没有SetUID权限，所以普通用户不能查看&#x2F;etc&#x2F;shadow文件内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ll /bin/cat  </span><br><span class="line">-rwxr-xr-x 1 root root 47976 6月  22 2012 /bin/cat</span><br></pre></td></tr></table></figure>

<p><img src="/../images/Snipaste_2023-08-27_15-52-31.png" alt="img"></p>
</li>
</ul>
<p>2、设定SetUID的方法</p>
<ul>
<li>4代表SUID<ul>
<li>chmod 4755 文件名</li>
<li>chmod u+s 文件名</li>
</ul>
</li>
</ul>
<p>3、取消SetUID的方法</p>
<ul>
<li>chmod 755 文件名</li>
<li>chmod u-s 文件名</li>
</ul>
<p>4、危险的SetUID</p>
<ul>
<li>关键目录应严格控制写权限。比如“&#x2F;”、“&#x2F;usr”等</li>
<li>用户的密码设置要严格遵守密码三原则</li>
<li>对系统中默认应该具有SetUID权限的文件作一列表，定时检查有没有这之外的文件被设置了SetUID权限</li>
</ul>
<h3 id="SetGID"><a href="#SetGID" class="headerlink" title="SetGID"></a>SetGID</h3><p>1、SetGID针对文件的作用</p>
<ul>
<li><p>只有可执行的二进制程序才能设置SGID权限</p>
</li>
<li><p>命令执行者要对该程序拥有x（执行）权限</p>
</li>
<li><p>命令执行在执行程序的时候，组身份升级为该程序文件的属组</p>
</li>
<li><p>SetGID权限同样只在该程序执行过程中有效，也就是说组身份改变只在程序执行过程中有效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ll /usr/bin/locate  </span><br><span class="line">-rwx--s--x 1 root slocate 35612 8月  24 2010 /usr/bin/locate  </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# ll /var/lib/mlocate/mlocate.db  </span><br><span class="line">-rw-r----- 1 root slocate 1838850 1月  20 04:29 /var/lib/mlocate/mlocate.db </span><br></pre></td></tr></table></figure>
</li>
<li><p>&#x2F;usr&#x2F;bin&#x2F;locate是可执行二进制程序，可以赋予SGID</p>
</li>
<li><p>执行用户lamp对&#x2F;usr&#x2F;bin&#x2F;locate命令拥有执行权限</p>
</li>
<li><p>执行&#x2F;usr&#x2F;bin&#x2F;locate命令时，组身份会升级为slocate组，而slocate组对&#x2F;var&#x2F;lib&#x2F;mlocate&#x2F;mlocate.db数据库拥有r权限，所以普通用户可以使用locate命令查询mlocate.db数据库</p>
</li>
<li><p>命令结束，lamp用户的组身份返回为lamp组</p>
</li>
</ul>
<p>2、SetGID针对目录的作用</p>
<ul>
<li><p>普通用户必须对此目录拥有r和x权限，才能进入此目录</p>
</li>
<li><p>普通用户在此目录中的有效组会变成此目录的属组</p>
</li>
<li><p>若普通用户对此目录拥有w权限时，新建的文件的默认属组是这个目录的属组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cd /tmp/ </span><br><span class="line">[root@localhost tmp]# mkdir dtest </span><br><span class="line">[root@localhost tmp]# chmod g+s dtest </span><br><span class="line">[root@localhost tmp]# ll -d dtest/ </span><br><span class="line">[root@localhost tmp]# chmod 777 dtest/ </span><br><span class="line">[root@localhost tmp]# su – lamp </span><br><span class="line">[lamp@localhost ~]$ cd /tmp/dtest/ </span><br><span class="line">[lamp@localhost dtest]$ touch abc </span><br><span class="line">[lamp@localhost dtest]$ ll </span><br></pre></td></tr></table></figure></li>
</ul>
<p>3、设定SetGID</p>
<ul>
<li>2代表SGID<ul>
<li>chmod 2755 文件名</li>
<li>chmod g+s 文件名</li>
</ul>
</li>
</ul>
<p>4、取消SetGID</p>
<ul>
<li>chmod 755 文件名</li>
<li>chmod g-s 文件名</li>
</ul>
<h3 id="Sticky-BIT"><a href="#Sticky-BIT" class="headerlink" title="Sticky BIT"></a>Sticky BIT</h3><p>1、SBIT粘着位作用</p>
<ul>
<li><p>粘着位目前只对目录有效</p>
</li>
<li><p>普通用户对该目录拥有w和x权限，即普通用户可以在此目录拥有写入权限</p>
</li>
<li><p>如果没有粘着位，因为普通用户拥有w权限，所以可以删除此目录下所有文件，包括其他用户建立的文件。一但赋予了粘着位，除了root可以删除所有文件，普通用户就算拥有w权限，也只能删除自己建立的文件，但是不能删除其他用户建立的文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ll -d /tmp/ </span><br><span class="line">drwxrwxrwt. 3 root root 4096 12月 13 11:22 /tmp/ </span><br></pre></td></tr></table></figure></li>
</ul>
<p>2、设置与取消粘着位</p>
<ul>
<li>设置粘着位<ul>
<li>chmod 1755 目录名</li>
<li>chmod o+t 目录名</li>
</ul>
</li>
<li>取消粘着位<ul>
<li>chmod 777 目录名</li>
<li>chmod o-t 目录名</li>
</ul>
</li>
</ul>
<h2 id="文件系统属性chattr权限"><a href="#文件系统属性chattr权限" class="headerlink" title="文件系统属性chattr权限"></a>文件系统属性chattr权限</h2><p>1、chattr命令格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# chattr [+-=] [选项] 文件或目录名 </span><br><span class="line">    +: 增加权限 </span><br><span class="line">    -: 删除权限  </span><br><span class="line">    =: 等于某权限</span><br><span class="line"></span><br><span class="line">    选项 </span><br><span class="line">        i：如果对文件设置i属性，那么不允许对文件进行删除、改名，也不能添加和修改数据；如果对目录设置i属性，那么只能修改目录下文件的数据，但不允许建立和删除文件。 </span><br><span class="line">        a：如果对文件设置a属性，那么只能在文件中增加数据，但是不能删除也不能修改数据；如果对目录设置a属性，那么只允许在目录中建立和修改文件，但是不允许删除  </span><br></pre></td></tr></table></figure>

<p>2、查看文件系统属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lsattr 选项 文件名 </span><br><span class="line">    选项： </span><br><span class="line">        -a   显示所有文件和目录 </span><br><span class="line">        -d  若目标是目录，仅列出目录本身的属性，而不是子文件的</span><br></pre></td></tr></table></figure>

<h2 id="系统命令sudo权限"><a href="#系统命令sudo权限" class="headerlink" title="系统命令sudo权限"></a>系统命令sudo权限</h2><p>1、sudo权限</p>
<ul>
<li>root把本来只能超级用户执行的命令赋予普通用户执行。</li>
<li>sudo的操作对象是系统命令</li>
</ul>
<p>2、sudo使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# visudo </span><br><span class="line">#实际修改的是/etc/sudoers文件 </span><br><span class="line"> </span><br><span class="line">root    ALL=(ALL)       ALL </span><br><span class="line">#用户名  被管理主机的地址=（可使用的身份） 授权命令（绝对路径） </span><br><span class="line"># %wheel        ALL=(ALL)       ALL </span><br><span class="line">#%组名  被管理主机的地址=（可使用的身份） 授权命令（绝对路径） </span><br></pre></td></tr></table></figure>

<p>3、授权sc用户可以重启服务器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# visudo </span><br><span class="line">sc  ALL= /sbin/shutdown –r now </span><br></pre></td></tr></table></figure>

<p>4、普通用户执行sudo赋予的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# su – sc </span><br><span class="line">[sc@localhost ~]$ sudo -l </span><br><span class="line">#查看可用的sudo命令 </span><br><span class="line">[lamp@localhost ~]$ sudo /sbin/shutdown -r now </span><br><span class="line">#普通用户执行sudo赋予的命令</span><br></pre></td></tr></table></figure>

<h1 id="文件系统管理"><a href="#文件系统管理" class="headerlink" title="文件系统管理"></a>文件系统管理</h1><h2 id="回顾分区和文件系统"><a href="#回顾分区和文件系统" class="headerlink" title="回顾分区和文件系统"></a>回顾分区和文件系统</h2><p>1、分区类型</p>
<ul>
<li>主分区：总共最多只能分四个</li>
<li>扩展分区：只能有一个，也算作主分区的一种，也就是说主分区加扩展分区最多有四个。但是扩展分区不能存储数据和格式化，必须再划分成逻辑分区才能使用。</li>
<li>逻辑分区：逻辑分区是在扩展分区中划分的，如果是IDE硬盘，Linux最多支持59个逻辑分区，如果是SCSI硬盘Linux最多支持11个逻辑分区</li>
</ul>
<p>2、分区表示方法</p>
<p><img src="/../images/Snipaste_2023-08-27_16-06-45.png" alt="img"><br><img src="/../images/Snipaste_2023-08-27_16-07-23.png" alt="img"></p>
<p><img src="/../images/Snipaste_2023-08-27_16-08-27.png" alt="img"><br><img src="/../images/Snipaste_2023-08-27_16-09-13.png" alt="img"></p>
<p>3、文件系统</p>
<ul>
<li>ext2：是ext文件系统的升级版本，Red Hat Linux7.2版本以前的系统默认都是ext2文件系统。1993年发布，最大支持16TB的分区和最大2TB的文件（1TB&#x3D;1024GB&#x3D;1024*1024KB）</li>
<li>ext3： ext3文件系统是ext2文件系统的升级版本，最大的区别就是带日志功能，以在系统突然停止时提高文件系统的可靠性。支持最大16TB的分区和最大2TB的文件</li>
<li>ext4：它是ext3文件系统的升级版。ext4 在性能、伸缩性和可靠性方面进行了大量改进。EXT4的变化可以说是翻天覆地的，比如向下兼容EXT3、最大1EB文件系统和16TB文件、无限数量子目录、Extents连续数据块概念、多块分配、延迟分配、持久预分配、快速FSCK、日志校验、无日志模式、在线碎片整理、inode增强、默认启用barrier等。是CentOS 6.3的默认文件系统 （1EB&#x3D;1024PB&#x3D;1024*1024TB）</li>
</ul>
<h2 id="文件系统常用命令"><a href="#文件系统常用命令" class="headerlink" title="文件系统常用命令"></a>文件系统常用命令</h2><h3 id="df命令、du命令、fsck命令和dump2fs命令"><a href="#df命令、du命令、fsck命令和dump2fs命令" class="headerlink" title="df命令、du命令、fsck命令和dump2fs命令"></a>df命令、du命令、fsck命令和dump2fs命令</h3><p>1、文件系统查看命令df</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# df  [选项] [挂载点] </span><br><span class="line">    选项： </span><br><span class="line">        -a 显示所有的文件系统信息，包括特殊文件系统，如/proc、/sysfs  </span><br><span class="line">        -h 使用习惯单位显示容量，如KB，MB或GB等  </span><br><span class="line">        -T 显示文件系统类型  </span><br><span class="line">        -m 以MB为单位显示容量  </span><br><span class="line">        -k 以KB为单位显示容量。默认就是以KB为单位 </span><br></pre></td></tr></table></figure>

<p>2、统计目录或文件大小</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# du [选项] [目录或文件名] </span><br><span class="line">    选项： </span><br><span class="line">        -a 显示每个子文件的磁盘占用量。默认只统计子目录的磁盘占用量 </span><br><span class="line">        -h 使用习惯单位显示磁盘占用量，如KB，MB或GB等  </span><br><span class="line">        -s 统计总占用量，而不列出子目录和子文件的占用量 </span><br></pre></td></tr></table></figure>

<p>du命令和df命令的区别</p>
<ul>
<li>df命令是从文件系统考虑的，不光要考虑文件占用的空间，还要统计被命令或程序占用的空间（最常见的就是文件已经删除，但是程序并没有释放空间）</li>
<li>du命令是面向文件的，只会计算文件或目录占用的空间</li>
</ul>
<p>3、文件系统修复命令fsck</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fsck [选项] 分区设备文件名 </span><br><span class="line">    选项：  </span><br><span class="line">        -a： 不用显示用户提示，自动修复文件系统  </span><br><span class="line">        -y： 自动修复。和-a作用一致，不过有些文件系统只支持-y </span><br></pre></td></tr></table></figure>

<p>4、显示磁盘状态命令dumpe2fs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# dumpe2fs 分区设备文件名</span><br></pre></td></tr></table></figure>

<h3 id="挂载命令"><a href="#挂载命令" class="headerlink" title="挂载命令"></a>挂载命令</h3><p>1、查询与自动挂载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount [-l] </span><br><span class="line">#查询系统中已经挂载的设备，-l会显示卷标名称 </span><br><span class="line">[root@localhost ~]# mount –a </span><br><span class="line">#依据配置文件/etc/fstab的内容，自动挂载 </span><br></pre></td></tr></table></figure>

<p>2、挂载命令格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount [-t 文件系统] [-L 卷标名]  \ </span><br><span class="line">    [-o 特殊选项]   设备文件名 挂载点 </span><br><span class="line">选项：  </span><br><span class="line">    -t 文件系统：加入文件系统类型来指定挂载的类型，可以ext3、ext4、iso9660等文件系统   </span><br><span class="line">    -L 卷标名： 挂载指定卷标的分区，而不是安装设备文件名挂载  </span><br><span class="line">    -o 特殊选项：可以指定挂载的额外选项</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>atime&#x2F;noatime</td>
<td>更新访问时间&#x2F;不更新访问时间。访问分区文件时，是否更新文件的访问时间，默认为更新</td>
</tr>
<tr>
<td>async&#x2F;sync</td>
<td>异步&#x2F;同步，默认为异步</td>
</tr>
<tr>
<td>auto&#x2F;noauto</td>
<td>自动&#x2F;手动，mount –a命令执行时，是否会自动安装&#x2F;etc&#x2F;fstab文件内容挂载，默认为自动</td>
</tr>
<tr>
<td>defaults</td>
<td>定义默认值，相当于rw,suid,dev,exec,auto,nouser,async这七个选项</td>
</tr>
<tr>
<td>exec&#x2F;noexec</td>
<td>执行&#x2F;不执行，设定是否允许在文件系统中执行可执行文件，默认是exec允许</td>
</tr>
<tr>
<td>remount</td>
<td>重新挂载已经挂载的文件系统，一般用于指定修改特殊权限</td>
</tr>
<tr>
<td>rw&#x2F;ro</td>
<td>读写&#x2F;只读，文件系统挂载时，是否具有读写权限，默认是rw</td>
</tr>
<tr>
<td>suid&#x2F;nosuid</td>
<td>具有&#x2F;不具有SUID权限，设定文件系统是否具有SUID和SGID的权限，默认是具有</td>
</tr>
<tr>
<td>user&#x2F;nouser</td>
<td>允许&#x2F;不允许普通用户挂载，设定文件系统是否允许普通用户挂载，默认是不允许，只有root可以挂载分区</td>
</tr>
<tr>
<td>usrquota</td>
<td>写入代表文件系统支持用户磁盘配额，默认不支持</td>
</tr>
<tr>
<td>grpquota</td>
<td>写入代表文件系统支持组磁盘配额，默认不支持</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount -o remount,noexec /home </span><br><span class="line">#重新挂载/boot分区，并使用noexec权限 </span><br><span class="line">[root@localhost sh]# cd /home </span><br><span class="line">[root@localhost boot]# vi hello.sh </span><br><span class="line">[root@localhost boot]# chmod 755 hello.sh  </span><br><span class="line">[root@localhost boot]# ./hello.sh </span><br><span class="line">[root@localhost boot]# mount -o remount,exec /home </span><br><span class="line">#记得改回来啊，要不会影响系统启动的 </span><br></pre></td></tr></table></figure>

<h3 id="挂载光盘与U盘"><a href="#挂载光盘与U盘" class="headerlink" title="挂载光盘与U盘"></a>挂载光盘与U盘</h3><p>1、挂载光盘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mkdir /mnt/cdrom/ </span><br><span class="line">#建立挂载点 </span><br><span class="line">[root@localhost ~]# mount -t iso9660 /dev/cdrom /mnt/cdrom/ </span><br><span class="line">#挂载光盘  </span><br><span class="line">[root@localhost ~]# mount /dev/sr0 /mnt/cdrom/  </span><br></pre></td></tr></table></figure>

<p>2、卸载命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# umount 设备文件名或挂载点 </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# umount /mnt/cdrom  </span><br></pre></td></tr></table></figure>

<p>3、挂载U盘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fdisk –l </span><br><span class="line">#查看U盘设备文件名 </span><br><span class="line">[root@localhost ~]# mount -t vfat /dev/sdb1 /mnt/usb/  </span><br></pre></td></tr></table></figure>

<p>注意：Linux默认是不支持NTFS文件系统的</p>
<h3 id="支持NTFS文件系统"><a href="#支持NTFS文件系统" class="headerlink" title="支持NTFS文件系统"></a>支持NTFS文件系统</h3><p>1、下载NTFS-3G插件</p>
<p><a target="_blank" rel="noopener" href="http://www.tuxera.com/community/ntfs-3g-">http://www.tuxera.com/community/ntfs-3g-</a><br>download&#x2F;</p>
<p>2、安装NTFS-3G</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# tar -zxvf ntfs-3g_ntfsprogs-2013.1.13.tgz </span><br><span class="line">#解压 </span><br><span class="line">[root@localhost ~]# cd ntfs-3g_ntfsprogs-2013.1.13 </span><br><span class="line">#进入解压目录 </span><br><span class="line">[root@localhost ntfs-3g_ntfsprogs-2013.1.13]# ./configure </span><br><span class="line">#编译器准备。没有指定安装目录，安装到默认位置中 </span><br><span class="line">[root@localhost ntfs-3g_ntfsprogs-2013.1.13]# make </span><br><span class="line">#编译 </span><br><span class="line">[root@localhost ntfs-3g_ntfsprogs-2013.1.13]# make install </span><br><span class="line">#编译安装 </span><br></pre></td></tr></table></figure>

<p>3、使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount -t ntfs-3g 分区设备文件名  挂载点</span><br></pre></td></tr></table></figure>

<h2 id="fdisk分区"><a href="#fdisk分区" class="headerlink" title="fdisk分区"></a>fdisk分区</h2><h3 id="fdisk命令分区过程"><a href="#fdisk命令分区过程" class="headerlink" title="fdisk命令分区过程"></a>fdisk命令分区过程</h3><p>1、查看硬盘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fdisk -l </span><br></pre></td></tr></table></figure>

<p>2、使用fdisk命令分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fdisk /dev/sdb</span><br></pre></td></tr></table></figure>

<p><img src="/../images/Snipaste_2023-08-27_16-41-18.png" alt="img"></p>
<p>3、重新读取分区表信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# partprobe </span><br></pre></td></tr></table></figure>

<p>4、格式化分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mkfs -t ext4 /dev/sdb1 </span><br></pre></td></tr></table></figure>

<p>5、建立挂载点并挂载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mkdir /disk1 </span><br><span class="line">[root@localhost ~]# mount /dev/sdb1 /disk1/</span><br></pre></td></tr></table></figure>

<h3 id="分区自动挂载与fstab文件修复"><a href="#分区自动挂载与fstab文件修复" class="headerlink" title="分区自动挂载与fstab文件修复"></a>分区自动挂载与fstab文件修复</h3><p>1、&#x2F;etc&#x2F;fstab文件</p>
<ul>
<li>第一字段：分区设备文件名或UUID（硬盘通用唯一识别码）</li>
<li>第二字段：挂载点</li>
<li>第三字段：文件系统名称</li>
<li>第四字段：挂载参数</li>
<li>第五字段：指定分区是否被dump备份，0代表不备份，1代表每天备份，2代表不定期备份</li>
<li>第六字段：指定分区是否被fsck检测，0代表不检测，其他数字代表检测的优先级，那么当然1的优先级比2高</li>
</ul>
<p>2、分区自动挂载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi /etc/fstab </span><br><span class="line">...省略部分输出... </span><br><span class="line">/dev/sdb5               /disk5                  ext4    defaults        1 2 </span><br></pre></td></tr></table></figure>

<p>3、&#x2F;etc&#x2F;fstab文件修复</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount -o remount,rw /</span><br></pre></td></tr></table></figure>

<h2 id="分配swap分区"><a href="#分配swap分区" class="headerlink" title="分配swap分区"></a>分配swap分区</h2><p>1、新建swap分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fdisk /dev/sdb </span><br></pre></td></tr></table></figure>

<p>别忘记把分区ID改为82</p>
<p>2、格式化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mkswap /dev/sdb1  </span><br></pre></td></tr></table></figure>

<p>3、加入swap分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# swapon /dev/sdb1 </span><br><span class="line">#加入swap分区 </span><br><span class="line">[root@localhost ~]# swapoff /dev/sdb1 </span><br><span class="line">#取消swap分区 </span><br></pre></td></tr></table></figure>

<p>4、swap分区开机自动挂载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi /etc/fstab </span><br><span class="line">/dev/sdb1        swap                    swap    defaults        0 0 </span><br></pre></td></tr></table></figure>

<p>5、free命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# free  </span><br><span class="line">#查看内存与swap分区使用状况 </span><br></pre></td></tr></table></figure>

<ul>
<li>cached（缓存）：是指把读取出来的数据保存在内存当中，当再次读取时，不用读取硬盘而直接从内存当中读取，加速了数据的读取过程</li>
<li>buffer（缓冲）：是指在写入数据时，先把分散的写入操作保存到内存当中，当达到一定程度再集中写入硬盘，减少了磁盘碎片和硬盘的反复寻道，加速了数据的写入过程</li>
</ul>
<h1 id="Shell基础"><a href="#Shell基础" class="headerlink" title="Shell基础"></a>Shell基础</h1><h2 id="Shell概述"><a href="#Shell概述" class="headerlink" title="Shell概述"></a>Shell概述</h2><p>1、Shell是什么</p>
<ul>
<li><p>Shell是一个命令行解释器，它为用户提供了一个向Linux内核发送请求以便运行程序的界面系统级程序，用户可以用Shell来启动、挂起、停止甚至是编写一些程序。</p>
<p><img src="/../images/Snipaste_2023-08-27_18-27-19.png" alt="img"></p>
</li>
<li><p>Shell还是一个功能相当强大的编程语言，易编写，易调试，灵活性较强。Shell是解释执行的脚本语言，在Shell中可以直接调用Linux系统命令。</p>
</li>
</ul>
<p>2、Shell的分类</p>
<ul>
<li>Bourne Shell：从1979起Unix就开始使用Bourne Shell，Bourne Shell的主文件名为sh。</li>
<li>C Shell： C Shell主要在BSD版的Unix系统中使用，其语法和C语言相类似而得名</li>
<li>Shell的两种主要语法类型有Bourne和C，这两种语法彼此不兼容。Bourne家族主要包括sh、ksh、Bash、psh、zsh；C家族主要包括：csh、tcsh</li>
<li>Bash： Bash与sh兼容，现在使用的Linux就是使用Bash作为用户的基本Shell。</li>
</ul>
<p>3、Linux支持的Shell</p>
<ul>
<li>&#x2F;etc&#x2F;shells</li>
</ul>
<h2 id="Shell脚本的执行方式"><a href="#Shell脚本的执行方式" class="headerlink" title="Shell脚本的执行方式"></a>Shell脚本的执行方式</h2><p>1、echo输出命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# echo [选项] [输出内容] </span><br><span class="line">    选项： </span><br><span class="line">        -e： 支持反斜线控制的字符转换</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>控制字符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>\</td>
<td>输出\本身</td>
</tr>
<tr>
<td>\a</td>
<td>输出警告音</td>
</tr>
<tr>
<td>\b</td>
<td>退格键，也就是向左删除键</td>
</tr>
<tr>
<td>\c</td>
<td>取消输出行末的换行符。和“-n”选项一致</td>
</tr>
<tr>
<td>\e</td>
<td>ESCAPE键</td>
</tr>
<tr>
<td>\f</td>
<td>换页符</td>
</tr>
<tr>
<td>\n</td>
<td>换行符</td>
</tr>
<tr>
<td>\r</td>
<td>回车键</td>
</tr>
<tr>
<td>\t</td>
<td>制表符，也就是Tab键</td>
</tr>
<tr>
<td>\v</td>
<td>垂直制表符</td>
</tr>
<tr>
<td>\0nnn</td>
<td>按照八进制ASCII码表输出字符。其中0为数字零，nnn是三位八进制数</td>
</tr>
<tr>
<td>\xhh</td>
<td>按照十六进制ASCII码表输出字符。其中hh是两位十六进制数</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# echo -e &quot;ab\bc&quot; </span><br><span class="line">#删除左侧字符 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# echo -e &quot;a\tb\tc\nd\te\tf&quot; </span><br><span class="line">#制表符与换行符 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# echo -e   \ </span><br><span class="line">&quot;\x61\t\x62\t\x63\n\x64\t\x65\t\x66&quot; </span><br><span class="line">#按照十六进制ASCII码也同样可以输出 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# echo -e &quot;\e[1;31m  abcd \e[0m&quot; </span><br><span class="line">#输出颜色 #30m=黑色，31m=红色，32m=绿色，33m=黄色 </span><br><span class="line">#34m=蓝色，35m=洋红，36m=青色，37m=白色</span><br></pre></td></tr></table></figure>

<p>2、第一个脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sh]# vi hello.sh </span><br><span class="line"></span><br><span class="line">#!/bin/Bash </span><br><span class="line">#The first program </span><br><span class="line"># Author: shenchao （E-mail: ）   </span><br><span class="line">echo -e &quot;hello world&quot; </span><br></pre></td></tr></table></figure>

<p>3、脚本执行</p>
<ul>
<li>赋予执行权限，直接运行<ul>
<li>chmod 755 hello.sh</li>
<li>.&#x2F;hello.sh</li>
</ul>
</li>
<li>通过Bash调用执行脚本<ul>
<li>bash hello.sh</li>
</ul>
</li>
</ul>
<h2 id="Bash的基本功能"><a href="#Bash的基本功能" class="headerlink" title="Bash的基本功能"></a>Bash的基本功能</h2><h3 id="历史命令与命令补全"><a href="#历史命令与命令补全" class="headerlink" title="历史命令与命令补全"></a>历史命令与命令补全</h3><p>1、历史命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# history [选项] [历史命令保存文件] </span><br><span class="line">    选项： </span><br><span class="line">        -c：  清空历史命令  -w： 把缓存中的历史命令写入历史命令保存文件 ~/.bash_history</span><br></pre></td></tr></table></figure>

<ul>
<li>历史命令默认会保存1000条,可以在环境变量配置文件&#x2F;etc&#x2F;profile中进行修改</li>
</ul>
<p><strong>历史命令的调用</strong></p>
<ul>
<li>使用上、下箭头调用以前的历史命令</li>
<li>使用“!n”重复执行第n条历史命令</li>
<li>使用“!!”重复执行上一条命令</li>
<li>使用“!字串”重复执行最后一条以该字串开头的命令</li>
</ul>
<p>2、命令与文件补全</p>
<ul>
<li>在Bash中，命令与文件补全是非常方便与常用的功能，我们只要在输入命令或文件时，按“Tab”键就会自动进行补全</li>
</ul>
<h3 id="命令别名与常用快捷键"><a href="#命令别名与常用快捷键" class="headerlink" title="命令别名与常用快捷键"></a>命令别名与常用快捷键</h3><p>1、命令别名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# alias 别名=&#x27;原命令&#x27; </span><br><span class="line">#设定命令别名 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# alias </span><br><span class="line">#查询命令别名</span><br></pre></td></tr></table></figure>

<p><strong>命令执行时顺序</strong></p>
<ol>
<li>第一顺位执行用绝对路径或相对路径执行的命令。</li>
<li>第二顺位执行别名。</li>
<li>第三顺位执行Bash的内部命令。</li>
<li>第四顺位执行按照$PATH环境变量定义的目录查找顺序找到的第一个命令。</li>
</ol>
<p><strong>让别名永久生效</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi /root/.bashrc </span><br></pre></td></tr></table></figure>

<p><strong>删除别名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# unalias 别名</span><br></pre></td></tr></table></figure>

<p>2、Bash常用快捷键</p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>ctrl+A</td>
<td>把光标移动到命令行开头。如果我们输入的命令过长，想要把光标移动到命令行开头时使用。</td>
</tr>
<tr>
<td>ctrl+E</td>
<td>把光标移动到命令行结尾。</td>
</tr>
<tr>
<td>ctrl+C</td>
<td>强制终止当前的命令。</td>
</tr>
<tr>
<td>ctrl+L</td>
<td>清屏，相当于clear命令。</td>
</tr>
<tr>
<td>ctrl+U</td>
<td>删除或剪切光标之前的命令。我输入了一行很长的命令，不用使用退格键一个一个字符的删除，使用这个快捷键会更加方便</td>
</tr>
<tr>
<td>ctrl+K</td>
<td>删除或剪切光标之后的内容。</td>
</tr>
<tr>
<td>ctrl+Y</td>
<td>粘贴ctrl+U或ctrl+K剪切的内容。</td>
</tr>
<tr>
<td>ctrl+R</td>
<td>在历史命令中搜索，按下ctrl+R之后，就会出现搜索界面，只要输入搜索内容，就会从历史命令中搜索。</td>
</tr>
<tr>
<td>ctrl+D</td>
<td>退出当前终端。</td>
</tr>
<tr>
<td>ctrl+Z</td>
<td>暂停，并放入后台。这个快捷键牵扯工作管理的内容，我们在系统管理章节详细介绍。</td>
</tr>
<tr>
<td>ctrl+S</td>
<td>暂停屏幕输出。</td>
</tr>
<tr>
<td>ctrl+Q</td>
<td>恢复屏幕输出。</td>
</tr>
</tbody></table>
<h3 id="输入输出重定向"><a href="#输入输出重定向" class="headerlink" title="输入输出重定向"></a>输入输出重定向</h3><p>1、标准输入输出</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>设备文件名</th>
<th>文件描述符</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td>键盘</td>
<td>&#x2F;dev&#x2F;stdin</td>
<td>0</td>
<td>标准输入</td>
</tr>
<tr>
<td>显示器</td>
<td>&#x2F;dev&#x2F;sdtout</td>
<td>1</td>
<td>标准输出</td>
</tr>
<tr>
<td>显示器</td>
<td>&#x2F;dev&#x2F;sdterr</td>
<td>2</td>
<td>标准错误输出</td>
</tr>
</tbody></table>
<p>2、输出重定向</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>符号</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>标准输出重定向</td>
<td>命令 &gt; 文件</td>
<td>以覆盖的方式，把命令的正确输出输出到指定的文件或设备当中。</td>
</tr>
<tr>
<td>命令 &gt;&gt; 文件</td>
<td>以追加的方式，把命令的正确输出输出到指定的文件或设备当中。</td>
<td></td>
</tr>
<tr>
<td>标准错误输出重定向</td>
<td>错误命令 2&gt; 文件</td>
<td>以覆盖的方式，把命令的错误输出输出到指定的文件或设备当中。</td>
</tr>
<tr>
<td>错误命令 2&gt;&gt; 文件</td>
<td>以追加的方式，把命令的错误输出输出到指定的文件或设备当中。</td>
<td></td>
</tr>
<tr>
<td>正确输出和错误输出同时保存</td>
<td>命令 &gt; 文件 2&gt;&amp;1</td>
<td>以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中。</td>
</tr>
<tr>
<td>命令 &gt;&gt; 文件 2&gt;&amp;1</td>
<td>以追加的方式，把正确输出和错误输出都保存到同一个文件当中。</td>
<td></td>
</tr>
<tr>
<td>命令 &amp;&gt; 文件</td>
<td>以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中。</td>
<td></td>
</tr>
<tr>
<td>命令 &amp;&gt;&gt; 文件</td>
<td>以追加的方式，把正确输出和错误输出都保存到同一个文件当中。</td>
<td></td>
</tr>
<tr>
<td>命令 &gt;&gt; 文件1 2&gt;&gt; 文件2</td>
<td>把正确的输出追加到文件1 中，把错误的输出追加到文件2中。</td>
<td></td>
</tr>
</tbody></table>
<p>3、输入重定向</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# wc [选项] [文件名] </span><br><span class="line">选项： </span><br><span class="line">  -c  统计字节数 </span><br><span class="line">  -w  统计单词数 </span><br><span class="line">  -l  统计行数 </span><br></pre></td></tr></table></figure>

<ul>
<li>命令 &lt; 文件 把文件作为命令的输入</li>
<li>命令 &lt;&lt; 标识符<br>…<br>标识符 把标识符之间内容作为命令的输入</li>
</ul>
<h3 id="多命令顺序执行与管道符"><a href="#多命令顺序执行与管道符" class="headerlink" title="多命令顺序执行与管道符"></a>多命令顺序执行与管道符</h3><p>1、多命令顺序执行</p>
<table>
<thead>
<tr>
<th>多命令执行符</th>
<th>格式</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>;</td>
<td>命令1 ; 命令2</td>
<td>多个命令顺序执行，命令之间没有任何逻辑联系</td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td>命令1 &amp;&amp; 命令2</td>
<td>逻辑与 当命令1正确执行，则命令2才会执行 当命令1执行不正确，则命令2不会执行</td>
</tr>
<tr>
<td>&#124;&#124;</td>
<td>命令1 &#124;&#124; 命令2</td>
<td>逻辑或 当命令1 执行不正确，则命令2才会执行 当命令1正确执行，则命令2不会执行</td>
</tr>
</tbody></table>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ls ; date ; cd /user ; pwd </span><br><span class="line">   </span><br><span class="line">[root@localhost ~]# dd if=输入文件 of=输出文件 bs=字节数 count=个数  </span><br><span class="line">选项： </span><br><span class="line">    if=输入文件  指定源文件或源设备  </span><br><span class="line">    of=输出文件   指定目标文件或目标设备 </span><br><span class="line">    bs=字节数  指定一次输入/输出多少字节，即把这些字节看做一个数据块  </span><br><span class="line">    count=个数  指定输入/输出多少个数据块</span><br></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# date ; dd if=/dev/zero of=/root/testfile bs=1k count=100000 ; date </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# ls anaconda-ks.cfg &amp;&amp; echo yes </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# ls /root/test || echo &quot;no   </span><br><span class="line">[root@localhost ~]# 命令 &amp;&amp; echo yes || echo no  </span><br></pre></td></tr></table></figure>

<p>2、管道符</p>
<p>命令格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# 命令1  |  命令2 </span><br><span class="line">#命令1的正确输出作为命令2的操作对象</span><br></pre></td></tr></table></figure>

<p>颜色显示</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ll -a /etc/  | more  </span><br><span class="line">[root@localhost ~]# netstat -an | grep &quot;ESTABLISHED&quot; </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# grep [选项] &quot;搜索内容&quot; 文件名 </span><br><span class="line">    选项：  </span><br><span class="line">        -i：  忽略大小写  </span><br><span class="line">        -n：  输出行号  </span><br><span class="line">        -v：  反向查找  </span><br><span class="line">        --color=auto 搜索出的关键字用颜色显示</span><br></pre></td></tr></table></figure>

<h3 id="通配符与其他特殊符号"><a href="#通配符与其他特殊符号" class="headerlink" title="通配符与其他特殊符号"></a>通配符与其他特殊符号</h3><p>1、通配符</p>
<table>
<thead>
<tr>
<th>通配符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>?</td>
<td>匹配一个任意字符</td>
</tr>
<tr>
<td>*</td>
<td>匹配0个或任意多个任意字符，也就是可以匹配任何内容</td>
</tr>
<tr>
<td>[]</td>
<td>匹配中括号中任意一个字符。例如：[abc]代表一定匹配一个字符，或者是a，或者是b，或者是c。</td>
</tr>
<tr>
<td>[-]</td>
<td>匹配中括号中任意一个字符，-代表一个范围。例如：[a-z]代表匹配一个小写字母。</td>
</tr>
<tr>
<td>[^]</td>
<td>逻辑非，表示匹配不是中括号内的一个字符。例如：[^0-9]代表匹配一个不是数字的字符。</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cd /tmp/ </span><br><span class="line">[root@localhost tmp]# rm -rf * </span><br><span class="line">[root@localhost tmp]# touch abc </span><br><span class="line">[root@localhost tmp]# touch abcd </span><br><span class="line">[root@localhost tmp]# touch 012 </span><br><span class="line">[root@localhost tmp]# touch 0abc </span><br><span class="line">[root@localhost tmp]# ls ?abc </span><br><span class="line">[root@localhost tmp]# ls [0-9]* </span><br><span class="line">[root@localhost tmp]# ls [^0-9]*</span><br></pre></td></tr></table></figure>

<p>2、Bash中其他特殊符号</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>‘’</td>
<td>单引号。在单引号中所有的特殊符号，如“$”和“&#96;”(反引号)都没有特殊含义。</td>
</tr>
<tr>
<td>“”</td>
<td>双引号。在双引号中特殊符号都没有特殊含义，但是“$”、“&#96;”和“\”是例外，拥有“调用变量的值”、“引用命令”和“转义符”的特殊含义。</td>
</tr>
<tr>
<td>&#96;&#96;</td>
<td>反引号。反引号括起来的内容是系统命令，在Bash中会先执行它。和$()作用一样，不过推荐使用$()，因为反引号非常容易看错。</td>
</tr>
<tr>
<td>$()</td>
<td>和反引号作用一样，用来引用系统命令。</td>
</tr>
<tr>
<td>#</td>
<td>在Shell脚本中，#开头的行代表注释。</td>
</tr>
<tr>
<td>$</td>
<td>用于调用变量的值，如需要调用变量name的值时，需要用$name的方式得到变量的值。</td>
</tr>
<tr>
<td>\</td>
<td>转义符，跟在\之后的特殊符号将失去特殊含义，变为普通字符。如$将输出“$”符号，而不当做是变量引用。</td>
</tr>
</tbody></table>
<p>反引号与$()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# echo `ls` </span><br><span class="line">[root@localhost ~]# echo $(date)</span><br></pre></td></tr></table></figure>

<p>单引号与双引号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# name=sc </span><br><span class="line">[root@localhost ~]# echo &#x27;$name&#x27; </span><br><span class="line">[root@localhost ~]# echo &quot;$name&quot; </span><br><span class="line">[root@localhost ~]# echo ‘$(date)&#x27; </span><br><span class="line">[root@localhost ~]# echo “$(date)&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Bash的变量"><a href="#Bash的变量" class="headerlink" title="Bash的变量"></a>Bash的变量</h2><h3 id="用户自定义变量"><a href="#用户自定义变量" class="headerlink" title="用户自定义变量"></a>用户自定义变量</h3><p>1、什么是变量</p>
<ul>
<li>变量是计算机内存的单元，其中存放的值可以改变。当Shell脚本需要保存一些信息时，如一个文件名或是一个数字，就把它存放在一个变量中。每个变量有一个名字，所以很容易引用它。使用变量可以保存有用信息，使系统获知用户相关设置，变量也可以用于保存暂时信息。</li>
</ul>
<p>2、变量设置规则</p>
<ul>
<li>变量名称可以由字母、数字和下划线组成，但是不能以数字开头。如果变量名是“2name”则是错误的。</li>
<li>在Bash中，变量的默认类型都是字符串型，如果要进行数值运算，则必修指定变量类型为数值型。</li>
<li>变量用等号连接值，等号左右两侧不能有空格。</li>
<li>变量的值如果有空格，需要使用单引号或双引号包括。</li>
<li>在变量的值中，可以使用“\”转义符。</li>
<li>如果需要增加变量的值，那么可以进行变量值的叠加。不过变量需要用双引号包含“$变量名”或用${变量名}包含。</li>
<li>如果是把命令的结果作为变量值赋予变量，则需要使用反引号或$()包含命令。</li>
<li>环境变量名建议大写，便于区分。</li>
</ul>
<p>3、变量分类</p>
<ul>
<li>用户自定义变量</li>
<li>环境变量：这种变量中主要保存的是和系统操作环境相关的数据。</li>
<li>位置参数变量：这种变量主要是用来向脚本当中传递参数或数据的，变量名不能自定义，变量作用是固定的。</li>
<li>预定义变量：是Bash中已经定义好的变量，变量名不能自定义，变量作用也是固定的。</li>
</ul>
<p>4、本地变量</p>
<ul>
<li><p>变量定义</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# name=&quot;shen chao&quot; </span><br></pre></td></tr></table></figure>
</li>
<li><p>变量叠加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# aa=123 </span><br><span class="line">[root@localhost ~]# aa=&quot;$aa&quot;456 [root@localhost ~]# aa=$&#123;aa&#125;789</span><br></pre></td></tr></table></figure>
</li>
<li><p>变量调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# echo $name </span><br></pre></td></tr></table></figure>
</li>
<li><p>变量查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# set  </span><br></pre></td></tr></table></figure>
</li>
<li><p>变量删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# unset name</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p>1、环境变量是什么</p>
<ul>
<li>用户自定义变量只在当前的Shell中生效，而环境变量会在当前Shell和这个Shell的所有子Shell当中生效。如果把环境变量写入相应的配置文件，那么这个环境变量就会在所有的Shell中生效</li>
</ul>
<p>2、设置环境变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export 变量名=变量值 </span><br><span class="line">#申明变量 </span><br><span class="line"></span><br><span class="line">env </span><br><span class="line">#查询变量 </span><br><span class="line"> </span><br><span class="line">unset 变量名 </span><br><span class="line">#删除变量 </span><br></pre></td></tr></table></figure>

<p>3、系统常见环境变量</p>
<ul>
<li><p>PATH：系统查找命令的路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# echo $PATH </span><br><span class="line">/usr/lib/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>PATH&#x3D;”$PATH”:&#x2F;root&#x2F;sh</p>
<p>#PATH变量叠加</p>
</li>
<li><p>PS1：定义系统提示符的变量</p>
<p>\d：显示日期，格式为“星期 月 日”</p>
<p>\h：显示简写主机名。如默认主机名“localhost”</p>
<p>\t：显示24小时制时间，格式为“HH:MM:SS”</p>
<p>\T：显示12小时制时间，格式为“HH:MM:SS”</p>
<p>\A：显示24小时制时间，格式为“HH:MM”</p>
<p>\u：显示当前用户名</p>
<p>\w：显示当前所在目录的完整名称</p>
<p>\W：显示当前所在目录的最后一个目录</p>
<p>#：执行的第几个命令</p>
<p>$：提示符。如果是root用户会显示提示符为“#”，如果是普通用户会显示提示符为“$”</p>
</li>
</ul>
<p>举例：</p>
<ul>
<li>[root@localhost ~]# PS1&#x3D;’[\u@\t \w]$ ‘</li>
<li>[root@04:50:08 &#x2F;usr&#x2F;local&#x2F;src]#PS1&#x3D;’[\u@@ \h # \W]$‘</li>
<li>[root@04:53 上午 localhost 31 src]#PS1&#x3D;’[\u@\h \W]$ ‘</li>
</ul>
<h3 id="位置参数变量"><a href="#位置参数变量" class="headerlink" title="位置参数变量"></a>位置参数变量</h3><p>1、位置参数变量</p>
<table>
<thead>
<tr>
<th>位置参数变量</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>$n</td>
<td>n为数字，$0代表命令本身，$1-$9代表第一到第九个参数，十以上的参数需要用大括号包含，如${10}.</td>
</tr>
<tr>
<td>$*</td>
<td>这个变量代表命令行中所有的参数，$*把所有的参数看成一个整体</td>
</tr>
<tr>
<td>$@</td>
<td>这个变量也代表命令行中所有的参数，不过$@把每个参数区分对待</td>
</tr>
<tr>
<td>$#</td>
<td>这个变量代表命令行中所有参数的个数</td>
</tr>
</tbody></table>
<p>例子1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash </span><br><span class="line">num1=$1 num2=$2 </span><br><span class="line">sum=$(( $num1 + $num2)) </span><br><span class="line">#变量sum的和是num1加num2 echo $sum </span><br><span class="line">#打印变量sum的值 </span><br></pre></td></tr></table></figure>

<p>例子2：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash </span><br><span class="line">echo &quot;A total of $# parameters&quot; </span><br><span class="line">#使用$#代表所有参数的个数 </span><br><span class="line">echo &quot;The parameters is: $*&quot; </span><br><span class="line">#使用$*代表所有的参数 echo &quot;The parameters is: $@&quot; </span><br><span class="line">#使用$@也代表所有参数 </span><br></pre></td></tr></table></figure>

<p>例子3：$*与$@的区别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash </span><br><span class="line">for i in &quot;$*&quot; </span><br><span class="line">#$*中的所有参数看成是一个整体，所以这个for循环只会循环一次 </span><br><span class="line">    do                 </span><br><span class="line">        echo &quot;The parameters is: $i&quot;</span><br><span class="line">    done </span><br><span class="line">x=1 </span><br><span class="line">for y in &quot;$@&quot; </span><br><span class="line">#$@中的每个参数都看成是独立的，所以“$@”中有几个参数，就会循环几次 </span><br><span class="line">    do             </span><br><span class="line">        echo &quot;The parameter$x is: $y&quot;                 </span><br><span class="line">        x=$(( $x +1 ))     </span><br><span class="line">    done</span><br></pre></td></tr></table></figure>

<h3 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a>预定义变量</h3><p>1、预定义变量</p>
<table>
<thead>
<tr>
<th>预定义变量</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>$？</td>
<td>最后一次执行的命令的返回状态。如果这个变量的值为0，证明上一个命令正确执行；如果这个变量的值为非0（具体是哪个数，由命令自己来决定），则证明上一个命令执行不正确了。</td>
</tr>
<tr>
<td>$$</td>
<td>当前进程的进程号（PID）</td>
</tr>
<tr>
<td>$!</td>
<td>后台运行的最后一个进程的进程号（PID）</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash </span><br><span class="line"># Author: user （E-mail: user@qq.net）   </span><br><span class="line"></span><br><span class="line">echo &quot;The current process is $$&quot; </span><br><span class="line">#输出当前进程的PID。 </span><br><span class="line">#这个PID就是variable.sh这个脚本执行时，生成的进程的PID   </span><br><span class="line"></span><br><span class="line">find /root -name hello.sh &amp; </span><br><span class="line">#使用find命令在root目录下查找hello.sh文件 </span><br><span class="line">#符号&amp;的意思是把命令放入后台执行，工作管理我们在系统管理章节会详细介绍 </span><br><span class="line">echo &quot;The last one Daemon process is $!&quot;</span><br></pre></td></tr></table></figure>

<p>2、接收键盘输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# read [选项] [变量名] </span><br><span class="line">    选项：  </span><br><span class="line">        -p “提示信息”：在等待read输入时，输出提示信息  </span><br><span class="line">        -t 秒数：  read命令会一直等待用户输入，使用此选项可以指定等待时间  </span><br><span class="line">        -n 字符数： read命令只接受指定的字符数，就会执行  </span><br><span class="line">        -s：   隐藏输入的数据，适用于机密信息的输入 </span><br><span class="line">#!/bin/bash </span><br><span class="line"># Author: user （E-mail: user@qq.net）    </span><br><span class="line">read -t 30 -p &quot;Please input your name: &quot; name </span><br><span class="line">#提示“请输入姓名”并等待30秒，把用户的输入保存入变量name中 </span><br><span class="line">echo &quot;Name is $name &quot; </span><br><span class="line"> </span><br><span class="line">read -s -t 30 -p &quot;Please enter your age: &quot; age </span><br><span class="line">#年龄是隐私，所以我们用“-s”选项隐藏输入 </span><br><span class="line">echo -e &quot;\n&quot; </span><br><span class="line">echo &quot;Age is $age &quot; </span><br><span class="line"></span><br><span class="line">read -n 1 -t 30 -p &quot;Please select your gender[M/F]: &quot; gender </span><br><span class="line">#使用“-n 1”选项只接收一个输入字符就会执行（都不用输入回车） </span><br><span class="line">echo -e &quot;\n&quot; </span><br><span class="line">echo &quot;Sex is $gender&quot; </span><br></pre></td></tr></table></figure>

<h2 id="Bash的运算符"><a href="#Bash的运算符" class="headerlink" title="Bash的运算符"></a>Bash的运算符</h2><h3 id="数值运算与运算符"><a href="#数值运算与运算符" class="headerlink" title="数值运算与运算符"></a>数值运算与运算符</h3><p>1、declare声明变量类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# declare [+/-][选项] 变量名 </span><br><span class="line">选项：  </span><br><span class="line">    -：   给变量设定类型属性  </span><br><span class="line">    +：  取消变量的类型属性  </span><br><span class="line">    -i：  将变量声明为整数型（integer）  </span><br><span class="line">    -x：  将变量声明为环境变量  </span><br><span class="line">    -p：  显示指定变量的被声明的类型</span><br></pre></td></tr></table></figure>

<p>2、数值运算</p>
<p>方法1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# aa=11 </span><br><span class="line">[root@localhost ~]# bb=22 </span><br><span class="line">#给变量aa和bb赋值 </span><br><span class="line">[root@localhost ~]# declare -i cc=$aa+$bb </span><br></pre></td></tr></table></figure>

<p>方法2：expr或let数值运算工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# aa=11 </span><br><span class="line">[root@localhost ~]# bb=22 </span><br><span class="line">#给变量aa和变量bb赋值 </span><br><span class="line">[root@localhost ~]# dd=$(expr $aa + $bb) </span><br><span class="line">#dd的值是aa和bb的和。注意“+”号左右两侧必须有空格 </span><br></pre></td></tr></table></figure>

<p>方法3：“$((运算式))”或“$[运算式]”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# aa=11 </span><br><span class="line">[root@localhost ~]# bb=22 </span><br><span class="line">[root@localhost ~]# ff=$(( $aa+$bb )) </span><br><span class="line">[root@localhost ~]# gg=$[ $aa+$bb ]</span><br></pre></td></tr></table></figure>

<p>3、运算符</p>
<p><img src="/../images/Snipaste_2023-08-27_20-01-44.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# aa=$(( (11+3)*3/2 ))  </span><br><span class="line">#虽然乘和除的优先级高于加，但是通过小括号可以调整运算优先级  </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# bb=$(( 14%3 ))  </span><br><span class="line">#14不能被3整除，余数是2  </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# cc=$(( 1 &amp;&amp; 0 )) </span><br><span class="line">#逻辑与运算只有想与的两边都是1，与的结果才是1，否则与的结果是0 </span><br></pre></td></tr></table></figure>

<h3 id="变量测试与内容替换"><a href="#变量测试与内容替换" class="headerlink" title="变量测试与内容替换"></a>变量测试与内容替换</h3><p><img src="/../images/Snipaste_2023-08-27_20-03-34.png" alt="img">\</p>
<p>例子1：测试x&#x3D;${y-新值}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# unset y </span><br><span class="line">#删除变量y </span><br><span class="line">[root@localhost ~]# x=$&#123;y-new&#125; </span><br><span class="line">#进行测试 </span><br><span class="line">[root@localhost ~]# echo $x new </span><br><span class="line">#因为变量y不存在，所以x=new </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# y=&quot;&quot; </span><br><span class="line">#给变量y赋值为空 </span><br><span class="line">[root@localhost ~]# x=$&#123;y-new&#125; </span><br><span class="line">#进行测试 </span><br><span class="line">[root@localhost ~]# echo $x </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# y=old </span><br><span class="line">#给变量y赋值 </span><br><span class="line">[root@localhost ~]# x=$&#123;y-new&#125; </span><br><span class="line">#进行测试 </span><br><span class="line">[root@localhost ~]# echo $x    old</span><br></pre></td></tr></table></figure>

<h2 id="环境变量配置文件"><a href="#环境变量配置文件" class="headerlink" title="环境变量配置文件"></a>环境变量配置文件</h2><h3 id="环境变量配置文件简介"><a href="#环境变量配置文件简介" class="headerlink" title="环境变量配置文件简介"></a>环境变量配置文件简介</h3><p>1、source命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# source 配置文件 </span><br><span class="line">或 </span><br><span class="line">[root@localhost ~]# . 配置文件 </span><br></pre></td></tr></table></figure>

<p>2、环境变量配置文件简介</p>
<ul>
<li>环境变量配置文件中主要是定义对系统的操作环境生效的系统默认环境变量，比如PATH、HISTSIZE、PS1、HOSTNAME等默认环境变量。</li>
<li>&#x2F;etc&#x2F;profile</li>
<li>&#x2F;etc&#x2F;profile.d&#x2F;*.sh</li>
<li>~&#x2F;.bash_profile</li>
<li>~&#x2F;.bashrc</li>
<li>&#x2F;etc&#x2F;bashrc</li>
</ul>
<h3 id="环境变量配置文件作用"><a href="#环境变量配置文件作用" class="headerlink" title="环境变量配置文件作用"></a>环境变量配置文件作用</h3><p><img src="/../images/Snipaste_2023-08-27_20-08-55.png" alt="img"></p>
<p>&#x2F;etc&#x2F;profile的作用：</p>
<ul>
<li>USER变量：</li>
<li>LOGNAME变量：</li>
<li>MAIL变量：</li>
<li>PATH变量：</li>
<li>HOSTNAME变量：</li>
<li>HISTSIZE变量：</li>
<li>umask：</li>
<li>调用&#x2F;etc&#x2F;profile.d&#x2F;*.sh文件</li>
</ul>
<p>~&#x2F;.bash_profile的作用</p>
<ul>
<li>调用了~&#x2F;.bashrc文件。</li>
<li>在PATH变量后面加入了“:$HOME&#x2F;bin”这个目录</li>
</ul>
<p>~&#x2F;.bashrc的作用</p>
<ul>
<li>定义默认别名</li>
<li>调用&#x2F;etc&#x2F;bashrc</li>
</ul>
<p>&#x2F;etc&#x2F;bashrc的作用</p>
<ul>
<li>PS1变量</li>
<li>umask</li>
<li>PATH变量</li>
<li>调用&#x2F;etc&#x2F;profile.d&#x2F;*.sh文件</li>
</ul>
<h3 id="其他配置文件和登录信息"><a href="#其他配置文件和登录信息" class="headerlink" title="其他配置文件和登录信息"></a>其他配置文件和登录信息</h3><p>1、注销时生效的环境变量配置文件</p>
<ul>
<li>~&#x2F;.bash_logout</li>
</ul>
<p>2、其他配置文件</p>
<ul>
<li>~&#x2F;bash_history</li>
</ul>
<p>3、Shell登录信息</p>
<ul>
<li><p>本地终端欢迎信息： &#x2F;etc&#x2F;issue</p>
<table>
<thead>
<tr>
<th>转义符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>\d</td>
<td>显示当前系统日期</td>
</tr>
<tr>
<td>\s</td>
<td>显示操作系统名称</td>
</tr>
<tr>
<td>\l</td>
<td>显示登录的终端号，这个比较常用。</td>
</tr>
<tr>
<td>\m</td>
<td>显示硬件体系结构，如i386、i686等</td>
</tr>
<tr>
<td>\n</td>
<td>显示主机名</td>
</tr>
<tr>
<td>\o</td>
<td>显示域名</td>
</tr>
<tr>
<td>\r</td>
<td>显示内核版本</td>
</tr>
<tr>
<td>\t</td>
<td>显示当前系统时间</td>
</tr>
<tr>
<td>\u</td>
<td>显示当前登录用户的序列号</td>
</tr>
</tbody></table>
</li>
<li><p>远程终端欢迎信息： &#x2F;etc&#x2F;issue.net</p>
<ul>
<li>转义符在&#x2F;etc&#x2F;issue.net文件中不能使用</li>
<li>是否显示此欢迎信息，由ssh的配置文件&#x2F;etc&#x2F;ssh&#x2F;sshd_config决定，加入“Banner &#x2F;etc&#x2F;issue.net”行才能显示（记得重启SSH服务）</li>
</ul>
</li>
<li><p>登陆后欢迎信息：&#x2F;etc&#x2F;motd</p>
<p>不管是本地登录，还是远程登录，都可以显示此欢迎信息</p>
</li>
</ul>
<h1 id="Shell编程"><a href="#Shell编程" class="headerlink" title="Shell编程"></a>Shell编程</h1><h2 id="基础正则表达式"><a href="#基础正则表达式" class="headerlink" title="基础正则表达式"></a>基础正则表达式</h2><p>1、正则表达式与通配符</p>
<ul>
<li>正则表达式用来在文件中匹配符合条件的字符串，正则是包含匹配。grep、awk、sed等命令可以支持正则表达式。</li>
<li>通配符用来匹配符合条件的文件名，通配符是完全匹配。ls、find、cp这些命令不支持正则表达式，所以只能使用shell自己的通配符来进行匹配了。</li>
</ul>
<p>2、基础正则表达式</p>
<table>
<thead>
<tr>
<th>元字符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>前一个字符匹配0次或任意多次。</td>
</tr>
<tr>
<td>.</td>
<td>匹配除了换行符外任意一个字符。</td>
</tr>
<tr>
<td>^</td>
<td>匹配行首。例如：^hello会匹配以hello开头的行。</td>
</tr>
<tr>
<td>$</td>
<td>匹配行尾。例如：hello&amp;会匹配以hello结尾的行。</td>
</tr>
<tr>
<td>[]</td>
<td>匹配中括号中指定的任意一个字符，只匹配一个字符。 例如：[aoeiu] 匹配任意一个元音字母，[0-9] 匹配任意一位数字， [a-z][0-9]匹配小写字和一位数字构成的两位字符。</td>
</tr>
<tr>
<td>[^]</td>
<td>匹配除中括号的字符以外的任意一个字符。例如：[^0-9] 匹配任意一位非数字字符，[^a-z] 表示任意一位非小写字母。</td>
</tr>
<tr>
<td>\</td>
<td>转义符。用于取消讲特殊符号的含义取消。</td>
</tr>
<tr>
<td>{n}</td>
<td>表示其前面的字符恰好出现n次。例如：[0-9]{4} 匹配4位数字，[1][3-8][0-9]{9} 匹配手机号码。</td>
</tr>
<tr>
<td>{n,}</td>
<td>表示其前面的字符出现不小于n次。例如： [0-9]{2,} 表示两位及以上的数字。</td>
</tr>
<tr>
<td>{n,m}</td>
<td>表示其前面的字符至少出现n次，最多出现m次。例如： [a-z]{6,8}</td>
</tr>
</tbody></table>
<p>“*”前一个字符匹配0次，或任意多次</p>
<ul>
<li><p>grep “a*” test_rule.txt</p>
<p>#匹配所有内容，包括空白行</p>
</li>
<li><p>grep “aa*” test_rule.txt</p>
<p>#匹配至少包含有一个a的行</p>
</li>
<li><p>grep “aaa*” test_rule.txt<br>#匹配最少包含两个连续a的字符串</p>
</li>
<li><p>grep “aaaaa*” test_rule.txt</p>
<p>#则会匹配最少包含四个个连续a的字符串</p>
</li>
</ul>
<p>“.” 匹配除了换行符外任意一个字符</p>
<ul>
<li><p>grep “s..d” test_rule.txt</p>
<p>#“s..d”会匹配在s和d这两个字母之间一定有两个字符的单词</p>
</li>
<li><p>grep “s.*d” test_rule.txt</p>
<p>#匹配在s和d字母之间有任意字符</p>
</li>
<li><p>grep “.*” test_rule.txt</p>
<p>#匹配所有内容</p>
</li>
</ul>
<p>“^”匹配行首，“$”匹配行尾</p>
<ul>
<li><p>grep “^M” test_rule.txt</p>
<p>#匹配以大写“M”开头的行</p>
</li>
<li><p>grep “n$” test_rule.txt</p>
<p>#匹配以小写“n”结尾的行</p>
</li>
<li><p>grep -n “^$” test_rule.txt</p>
<p>#会匹配空白行</p>
</li>
</ul>
<p>“[]” 匹配中括号中指定的任意一个字符，只匹配一个字符</p>
<ul>
<li><p>grep “s[ao]id” test_rule.txt</p>
<p>#匹配s和i字母中，要不是a、要不是o</p>
</li>
<li><p>grep “[0-9]” test_rule.txt</p>
<p>#匹配任意一个数字</p>
</li>
<li><p>grep “^[a-z]” test_rule.txt</p>
<p>#匹配用小写字母开头的行</p>
</li>
</ul>
<p>“[^]” 匹配除中括号的字符以外的任意一个字符</p>
<ul>
<li><p>grep “^[^a-z]” test_rule.txt</p>
<p>#匹配不用小写字母开头的行</p>
</li>
<li><p>grep “^[^a-zA-Z]” test_rule.txt</p>
<p>#匹配不用字母开头的行</p>
</li>
</ul>
<p>“\” 转义符</p>
<ul>
<li><p>grep “.$” test_rule.txt</p>
<p>#匹配使用“.”结尾的行</p>
</li>
</ul>
<p>“{n}”表示其前面的字符恰好出现n次</p>
<ul>
<li><p>grep “a{3}“ test_rule.txt</p>
<p>#匹配a字母连续出现三次的字符串</p>
</li>
<li><p>grep “[0-9]{3}“ test_rule.txt</p>
<p>#匹配包含连续的三个数字的字符串</p>
</li>
</ul>
<p>“{n,}”表示其前面的字符出现不小于n次</p>
<ul>
<li><p>grep “^[0-9]{3,}[a-z]” test_rule.txt</p>
<p>#匹配最少用连续三个数字开头的行</p>
</li>
</ul>
<p>“{n,m}”匹配其前面的字符至少出现n次，最多出现m次</p>
<ul>
<li><p>grep “sa{1,3}i” test_rule.txt</p>
<p>#匹配在字母s和字母i之间有最少一个a，最多三个a</p>
</li>
</ul>
<h2 id="字符截取命令"><a href="#字符截取命令" class="headerlink" title="字符截取命令"></a>字符截取命令</h2><h3 id="cut字段提取命令"><a href="#cut字段提取命令" class="headerlink" title="cut字段提取命令"></a>cut字段提取命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cut [选项] 文件名 </span><br><span class="line">选项： </span><br><span class="line">    -f 列号：  提取第几列  </span><br><span class="line">    -d 分隔符：  按照指定分隔符分割列  </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# vi student.txt</span><br><span class="line">ID      Name    gender      Mark </span><br><span class="line">1       L           M         86 </span><br><span class="line">2       Sc          M         90 </span><br><span class="line">3       Gao         M         83</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# cut -f 2 student.txt </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# cut -f 2,3 student.txt </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# cut -d &quot;:&quot; -f 1,3 /etc/passwd  </span><br></pre></td></tr></table></figure>

<p>cut命令的局限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# df -h | cut -d &quot; &quot; -f 1,3</span><br></pre></td></tr></table></figure>

<h3 id="printf命令"><a href="#printf命令" class="headerlink" title="printf命令"></a>printf命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">printf  ’输出类型输出格式’    输出内容 </span><br><span class="line">输出类型： </span><br><span class="line"> %ns：  输出字符串。n是数字指代输出几个字符 </span><br><span class="line"> %ni：  输出整数。n是数字指代输出几个数字 </span><br><span class="line"> %m.nf：   输出浮点数。m和n是数字，指代输出的整数位数和小数位数。如%8.2f代表共输出8位数，其中2位是小数，6位是整数。 </span><br><span class="line"> </span><br><span class="line">输出格式： </span><br><span class="line">  \a:   输出警告声音 </span><br><span class="line">  \b:   输出退格键，也就是Backspace键 </span><br><span class="line">  \f:   清除屏幕 </span><br><span class="line">  \n:   换行 </span><br><span class="line">  \r:   回车，也就是Enter键 </span><br><span class="line">  \t:   水平输出退格键，也就是Tab键 </span><br><span class="line">  \v:   垂直输出退格键，也就是Tab键 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# printf %s 1 2 3 4 5 6 </span><br><span class="line">[root@localhost ~]# printf %s %s %s 1 2 3 4 5 6  </span><br><span class="line">[root@localhost ~]# printf  &#x27;%s %s %s&#x27; 1 2 3 4 5 6 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# printf &#x27;%s %s %s\n&#x27; 1 2 3 4 5 6 </span><br><span class="line">[root@localhost ~]# vi student.txt  </span><br><span class="line">ID      Name      PHP       Linux       MySQL         Average </span><br><span class="line">1       Liming     82         95         86            87.66 </span><br><span class="line">2       Sc         74         96         87            85.66 </span><br><span class="line">3       Gao        99         83         93            91.66 </span><br><span class="line"> </span><br><span class="line">printf  &#x27;%s&#x27; $(cat student.txt) </span><br><span class="line">#不调整输出格式  </span><br><span class="line"></span><br><span class="line">printf &#x27;%s\t %s\t %s\t %s\t %s\t %s\t \n&#x27; $(cat student.txt) </span><br><span class="line">#调整格式输出</span><br></pre></td></tr></table></figure>

<p>在awk命令的输出中支持print和printf命令</p>
<ul>
<li>print：print会在每个输出之后自动加入一个换行符（Linux默认没有print命令）</li>
<li>printf：printf是标准格式输出命令，并不会自动加入换行符，如果需要换行，需要手工加入换行符</li>
</ul>
<h3 id="awk命令"><a href="#awk命令" class="headerlink" title="awk命令"></a>awk命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">awk ‘条件1&#123;动作1&#125; 条件2&#123;动作2&#125;...’ 文件名 </span><br><span class="line">条件（Pattern）：  </span><br><span class="line">    一般使用关系表达式作为条件 </span><br><span class="line">    x &gt; 10  判断变量 x是否大于10 </span><br><span class="line">    x&gt;=10   大于等于  </span><br><span class="line">    x&lt;=10   小于等于 </span><br><span class="line">动作（Action）：  </span><br><span class="line">    格式化输出  </span><br><span class="line">    流程控制语句 </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# vi student.txt  </span><br><span class="line">ID       Name      PHP     Linux       MySQL          Average </span><br><span class="line">1        Liming    82        95         86             87.66 </span><br><span class="line">2        Sc        74        96         87             85.66 </span><br><span class="line">3        Gao       99        83         93             91.66 </span><br><span class="line"> </span><br><span class="line">awk &#x27;&#123;printf $2 &quot;\t&quot; $6 &quot;\n&quot;&#125;&#x27; student.txt  </span><br><span class="line"> </span><br><span class="line">df -h | awk &#x27;&#123;print $1 &quot;\t&quot; $3&#125;&#x27; </span><br></pre></td></tr></table></figure>

<p><strong>BEGIN</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;BEGIN&#123;printf &quot;This is a transcript \n&quot; &#125; &#123;printf $2 &quot;\t&quot; $6 &quot;\n&quot;&#125;&#x27; student.txt  </span><br></pre></td></tr></table></figure>

<p><strong>END</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;END&#123;printf &quot;The End \n&quot; &#125; &#123;printf $2 &quot;\t&quot; $6 &quot;\n&quot;&#125;&#x27; student.txt </span><br></pre></td></tr></table></figure>

<p><strong>FS内置变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd | grep &quot;/bin/bash&quot; | \ </span><br><span class="line">awk &#x27;BEGIN &#123;FS=&quot;:&quot;&#125; &#123;printf $1 &quot;\t&quot; $3 &quot;\n&quot;&#125;&#x27;  </span><br></pre></td></tr></table></figure>

<p><strong>关系运算符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat student.txt | grep -v Name |  \ </span><br><span class="line">awk &#x27;$6 &gt;= 87 &#123;printf $2 &quot;\n&quot; &#125;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="sed命令"><a href="#sed命令" class="headerlink" title="sed命令"></a>sed命令</h3><p>sed命令</p>
<ul>
<li>sed 是一种几乎包括在所有 UNIX 平台（包括 Linux）的轻量级流编辑器。sed主要是用来将数据进行选取、替换、删除、新增的命令。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# sed [选项] ‘[动作]’ 文件名 </span><br><span class="line">选项：  </span><br><span class="line">    -n：  一般sed命令会把所有数据都输出到屏幕，如果加入此选择，则只会把经过sed命令处理的行输出到屏幕。  </span><br><span class="line">    -e：  允许对输入数据应用多条sed命令编辑 </span><br><span class="line">    -i：  用sed的修改结果直接修改读取数据的文件，而不是由屏幕输出 </span><br><span class="line"> </span><br><span class="line">动作：  </span><br><span class="line">    a \：  追加，在当前行后添加一行或多行。添加多行时，除最后 一行外，每行末尾需要用“\”代表数据未完结。 </span><br><span class="line">    c \：  行替换，用c后面的字符串替换原数据行，替换多行时，除最后一行外，每行末尾需用“\”代表数据未完结。  </span><br><span class="line">    i \：   插入，在当期行前插入一行或多行。插入多行时，除最后 一行外，每行末尾需要用“\”代表数据未完结。 </span><br><span class="line">    d：  删除，删除指定的行。 </span><br><span class="line">    p：  打印，输出指定的行。  </span><br><span class="line">    s：  字串替换，用一个字符串替换另外一个字符串。格式为“行范围s/旧字串/新字串/g”（和vim中的替换格式类似）。 </span><br></pre></td></tr></table></figure>

<p>学生成绩表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi student.txt  </span><br><span class="line">ID      Name      PHP       Linux      MySQL          Average </span><br><span class="line">1        Liming    82        95         86             87.66 </span><br><span class="line">2        Sc        74        96         87             85.66 </span><br><span class="line">3        Gao       99        83         93             91.66 </span><br></pre></td></tr></table></figure>

<p>行数据操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# sed &#x27;2p&#x27; student.txt  </span><br><span class="line">#查看文件的第二行 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# sed -n &#x27;2p&#x27; student.txt  </span><br><span class="line">  </span><br><span class="line">[root@localhost ~]# sed &#x27;2,4d&#x27; student.txt  </span><br><span class="line">#删除第二行到第四行的数据，但不修改文件本身 </span><br><span class="line">  </span><br><span class="line">[root@localhost ~]# sed &#x27;2a hello&#x27; student.txt   </span><br><span class="line">#在第二行后追加hello </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# sed &#x27;2i hello \ world&#x27; student.txt </span><br><span class="line">#在第二行前插入两行数据  </span><br><span class="line"> </span><br><span class="line">sed &#x27;2c No such person‘ student.txt </span><br><span class="line">#数据替换 </span><br></pre></td></tr></table></figure>

<p>字符串替换</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sed ‘s/旧字串/新字串/g’ 文件名 </span><br><span class="line"> </span><br><span class="line">sed &#x27;3s/74/99/g&#x27; student.txt  </span><br><span class="line">#在第三行中，把74换成99 </span><br><span class="line"></span><br><span class="line">sed -i &#x27;3s/74/99/g&#x27; student.txt  </span><br><span class="line">#sed操作的数据直接写入文件 </span><br><span class="line"> </span><br><span class="line">sed -e &#x27;s/Liming//g ; s/Gao//g&#x27; student.txt  </span><br><span class="line">#同时把“Liming”和“Gao”替换为空</span><br></pre></td></tr></table></figure>

<h2 id="字符处理命令"><a href="#字符处理命令" class="headerlink" title="字符处理命令"></a>字符处理命令</h2><p>1、排序命令sort</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# sort [选项] 文件名 </span><br><span class="line">选项： </span><br><span class="line"> -f：  忽略大小写  </span><br><span class="line"> -n：  以数值型进行排序，默认使用字符串型排序 </span><br><span class="line"> -r：  反向排序 </span><br><span class="line"> -t：  指定分隔符，默认是分隔符是制表符  </span><br><span class="line"> -k n[,m]： 按照指定的字段范围排序。从第n字段开始，m字段结束（默认到行尾） </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# sort /etc/passwd </span><br><span class="line">#排序用户信息文件 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# sort -r /etc/passwd </span><br><span class="line">#反向排序  </span><br><span class="line">[root@localhost ~]# sort -t &quot;:&quot; -k 3,3 /etc/passwd </span><br><span class="line">#指定分隔符是“：”，用第三字段开头，第三字段结尾排序，就是只用第三字段排序 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# sort -n -t &quot;:&quot; -k 3,3 /etc/passwd </span><br></pre></td></tr></table></figure>

<p>2、统计命令wc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# wc [选项] 文件名 </span><br><span class="line">选项： </span><br><span class="line"> -l： 只统计行数 </span><br><span class="line"> -w： 只统计单词数 </span><br><span class="line"> -m： 只统计字符数</span><br></pre></td></tr></table></figure>

<h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><p>1、按照文件类型进行判断</p>
<table>
<thead>
<tr>
<th>测试选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-b 文件</td>
<td>判断该文件是否存在，并且是否为块设备文件（是块设备文件为真）</td>
</tr>
<tr>
<td>-c 文件</td>
<td>判断该文件是否存在，并且是否为字符设备文件（是字符设备文件为真）</td>
</tr>
<tr>
<td>-d 文件</td>
<td>判断该文件是否存在，并且是否为目录文件（是目录为真）</td>
</tr>
<tr>
<td>-e 文件</td>
<td>判断该文件是否存在（存在为真）</td>
</tr>
<tr>
<td>-f 文件</td>
<td>判断该文件是否存在，并且是否为普通文件（是普通文件为真）</td>
</tr>
<tr>
<td>-L 文件</td>
<td>判断该文件是否存在，并且是否为符号链接文件（是符号链接文件为真）</td>
</tr>
<tr>
<td>-p 文件</td>
<td>判断该文件是否存在，并且是否为管道文件（是管道文件为真）</td>
</tr>
<tr>
<td>-s 文件</td>
<td>判断该文件是否存在，并且是否为非空（非空为真）</td>
</tr>
<tr>
<td>-S 文件</td>
<td>判断该文件是否存在，并且是否为套接字文件（是套接字文件为真）</td>
</tr>
</tbody></table>
<p>两种判断格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# test -e /root/install.log </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# [ -e /root/install.log ] </span><br><span class="line"> </span><br><span class="line">[ -d /root ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot;  </span><br><span class="line">#第一个判断命令如果正确执行，则打印“yes”，否则打印“no”</span><br></pre></td></tr></table></figure>

<p>2、按照文件权限进行判断</p>
<table>
<thead>
<tr>
<th>测试选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-r 文件</td>
<td>判断该文件是否存在，并且是否该文件拥有读权限（有读权限为真）</td>
</tr>
<tr>
<td>-w 文件</td>
<td>判断该文件是否存在，并且是否该文件拥有写权限（有写权限为真）</td>
</tr>
<tr>
<td>-x 文件</td>
<td>判断该文件是否存在，并且是否该文件拥有执行权限（有执行权限为真）</td>
</tr>
<tr>
<td>-u 文件</td>
<td>判断该文件是否存在，并且是否该文件拥有SUID权限（有SUID权限为真）</td>
</tr>
<tr>
<td>-g 文件</td>
<td>判断该文件是否存在，并且是否该文件拥有SGID权限（有SGID权限为真）</td>
</tr>
<tr>
<td>-k 文件</td>
<td>判断该文件是否存在，并且是否该文件拥有SBit权限（有SBit权限为真）</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ -w student.txt ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot;                   </span><br><span class="line">#判断文件是拥有写权限的</span><br></pre></td></tr></table></figure>

<p>3、两个文件之间进行比较</p>
<table>
<thead>
<tr>
<th>测试选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>文件1 -nt 文件2</td>
<td>判断文件1的修改时间是否比文件2的新（如果新则为真）</td>
</tr>
<tr>
<td>文件1 -ot 文件2</td>
<td>判断文件1的修改时间是否比文件2的旧（如果旧则为真）</td>
</tr>
<tr>
<td>文件1 -ef 文件2</td>
<td>判断文件1是否和文件2的Inode号一致，可以理解为两个文件是否为同一个文件。这个判断用于判断硬链接是很好的方法</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ln /root/student.txt /tmp/stu.txt </span><br><span class="line">#创建个硬链接吧 </span><br><span class="line"></span><br><span class="line">[ /root/student.txt -ef /tmp/stu.txt ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot;                  </span><br><span class="line">yes </span><br><span class="line">#用test测试下，果然很有用</span><br></pre></td></tr></table></figure>

<p>4、两个整数之间比较</p>
<table>
<thead>
<tr>
<th>测试选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>整数1 -eq 整数2</td>
<td>判断整数1是否和整数2相等（相等为真）</td>
</tr>
<tr>
<td>整数1 -ne 整数2</td>
<td>判断整数1是否和整数2不相等（不相等位置）</td>
</tr>
<tr>
<td>整数1 -gt 整数2</td>
<td>判断整数1是否大于整数2（大于为真）</td>
</tr>
<tr>
<td>整数1 -lt 整数2</td>
<td>判断整数1是否小于整数2（小于位置）</td>
</tr>
<tr>
<td>整数1 -ge 整数2</td>
<td>判断整数1是否大于等于整数2（大于等于为真）</td>
</tr>
<tr>
<td>整数1 -le 整数2</td>
<td>判断整数1是否小于等于整数2（小于等于为真）</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ 23 -ge 22 ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot;                                   </span><br><span class="line">yes </span><br><span class="line">#判断23是否大于等于22，当然是了 </span><br><span class="line"></span><br><span class="line">[ 23 -le 22 ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot;  no </span><br><span class="line">#判断23是否小于等于22，当然不是了 </span><br></pre></td></tr></table></figure>

<p>5、字符串的判断</p>
<table>
<thead>
<tr>
<th>测试选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-z 字符串</td>
<td>判断字符串是否为空（为空返回真）</td>
</tr>
<tr>
<td>-n 字符串</td>
<td>判断字符串是否为非空（非空返回真）</td>
</tr>
<tr>
<td>字串1 &#x3D;&#x3D; 字串2</td>
<td>判断字符串1是否和字符串2相等（相等返回真）</td>
</tr>
<tr>
<td>字串1 !&#x3D; 字串2</td>
<td>判断字符串1是否和字符串2不相等（不相等返回真）</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">name=sc </span><br><span class="line">#给name变量赋值</span><br><span class="line"></span><br><span class="line">[ -z &quot;$name&quot; ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot;  </span><br><span class="line">no </span><br><span class="line">#判断name变量是否为空，因为不为空，所以返回no  </span><br><span class="line"></span><br><span class="line">aa=11</span><br><span class="line">bb=22 </span><br><span class="line">#给变量aa和变量bb赋值 </span><br><span class="line">[ &quot;$aa&quot; == &quot;bb&quot; ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot;            </span><br><span class="line">no </span><br><span class="line">#判断两个变量的值是否相等，明显不相等，所以返回no </span><br></pre></td></tr></table></figure>

<p>6、多重条件判断</p>
<table>
<thead>
<tr>
<th>测试选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>判断1 -a 判断2</td>
<td>逻辑与，判断1和判断2都成立，最终的结果才为真</td>
</tr>
<tr>
<td>判断1 -o 判断2</td>
<td>逻辑或，判断1和判断2有一个成立，最终的结果就为真</td>
</tr>
<tr>
<td>！判断</td>
<td>逻辑非，使原始的判断式取反</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">aa=11 </span><br><span class="line">[ -n &quot;$aa&quot;  -a &quot;$aa&quot; -gt 23 ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot; </span><br><span class="line">no </span><br><span class="line">#判断变量aa是否有值，同时判断变量aa的是否大于23 </span><br><span class="line">#因为变量aa的值不大于23，所以虽然第一个判断值为真，返回的结果也是假 </span><br><span class="line"> </span><br><span class="line">aa=24 </span><br><span class="line">[ -n &quot;$aa&quot;  -a &quot;$aa&quot; -gt 23 ] &amp;&amp; echo &quot;yes&quot; || echo &quot;no&quot; </span><br><span class="line">yes</span><br></pre></td></tr></table></figure>

<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><p>1、 单分支if条件语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if [ 条件判断式 ];then </span><br><span class="line">  程序 </span><br><span class="line">fi </span><br><span class="line"></span><br><span class="line">或者 </span><br><span class="line"></span><br><span class="line">if [ 条件判断式 ] then </span><br><span class="line">   程序 </span><br><span class="line">fi </span><br></pre></td></tr></table></figure>

<p>单分支条件语句需要注意几个点</p>
<ul>
<li>if语句使用fi结尾，和一般语言使用大括号结尾不同</li>
<li>[ 条件判断式 ]就是使用test命令判断，所以中括号和条件判断式之间必须有空格</li>
<li>then后面跟符合条件之后执行的程序，可以放在[]之后，用“；”分割。也可以换行写入，就不需要“；”了</li>
</ul>
<p>例子：判断分区使用率</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash </span><br><span class="line">#统计根分区使用率 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">  </span><br><span class="line">rate=$(df -h | grep &quot;/dev/sda3&quot; | awk &#x27;&#123;print $5&#125;&#x27; | cut -d &quot;%&quot; -f1) </span><br><span class="line">#把根分区使用率作为变量值赋予变量rate </span><br><span class="line"></span><br><span class="line">if [ $rate -ge 80 ] </span><br><span class="line"> then </span><br><span class="line">    echo &quot;Warning! /dev/sda3 is full!!&quot; </span><br><span class="line"> fi </span><br></pre></td></tr></table></figure>

<p>2、双分支if条件语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if [ 条件判断式 ] </span><br><span class="line">  then </span><br><span class="line">   条件成立时，执行的程序 </span><br><span class="line">  else </span><br><span class="line">   条件不成立时，执行的另一个程序 </span><br><span class="line">fi </span><br></pre></td></tr></table></figure>

<p>例子1：备份mysql数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash </span><br><span class="line">#备份mysql数据库。 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">  </span><br><span class="line">ntpdate asia.pool.ntp.org &amp;&gt;/dev/null </span><br><span class="line">#同步系统时间 </span><br><span class="line">date=$(date +%y%m%d) </span><br><span class="line">#把当前系统时间按照“年月日”格式赋予变量date </span><br><span class="line">size=$(du -sh /var/lib/mysql) </span><br><span class="line">#统计mysql数据库的大小，并把大小赋予size变量 </span><br><span class="line"> </span><br><span class="line">if [ -d /tmp/dbbak ] </span><br><span class="line">    then </span><br><span class="line">        echo &quot;Date : $date!&quot; &gt; /tmp/dbbak/dbinfo.txt </span><br><span class="line">        echo &quot;Data size : $size&quot; &gt;&gt; /tmp/dbbak/dbinfo.txt </span><br><span class="line">        cd /tmp/dbbak </span><br><span class="line">        tar -zcf mysql-lib-$date.tar.gz /var/lib/mysql dbinfo.txt  &amp;&gt;/dev/null </span><br><span class="line">        rm -rf /tmp/dbbak/dbinfo.txt </span><br><span class="line">    else </span><br><span class="line">        mkdir /tmp/dbbak </span><br><span class="line">        echo &quot;Date : $date!&quot; &gt; /tmp/dbbak/dbinfo.txt </span><br><span class="line">        echo &quot;Data size : $size&quot; &gt;&gt; /tmp/dbbak/dbinfo.txt </span><br><span class="line">        cd /tmp/dbbak </span><br><span class="line">        tar -zcf mysql-lib-$date.tar.gz /var/lib/mysql dbinfo.txt  </span><br><span class="line">&amp;&gt;/dev/null </span><br><span class="line">        rm -rf /tmp/dbbak/dbinfo.txt </span><br><span class="line">fi </span><br></pre></td></tr></table></figure>

<p>例子2：判断apache是否启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">  </span><br><span class="line">port=$(nmap -sT 192.168.1.156 | grep tcp | grep http | awk &#x27;&#123;print $2&#125;&#x27;) </span><br><span class="line">#使用nmap命令扫描服务器，并截取apache服务的状态，赋予变量port </span><br><span class="line">if [ &quot;$port&quot; == &quot;open&quot; ]  </span><br><span class="line">    then   </span><br><span class="line">        echo “$(date) httpd is ok!” &gt;&gt; /tmp/autostart-acc.log  </span><br><span class="line">    else         </span><br><span class="line">        /etc/rc.d/init.d/httpd start &amp;&gt;/dev/null </span><br><span class="line">        echo &quot;$(date) restart httpd !!&quot; &gt;&gt; /tmp/autostart-err.log </span><br><span class="line">    fi </span><br></pre></td></tr></table></figure>

<p>3、 多分支if条件语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">if [ 条件判断式1 ] </span><br><span class="line">  then </span><br><span class="line">   当条件判断式1成立时，执行程序1 </span><br><span class="line">elif [ 条件判断式2 ] </span><br><span class="line">  then </span><br><span class="line">   当条件判断式2成立时，执行程序2 </span><br><span class="line">...省略更多条件... </span><br><span class="line">else </span><br><span class="line">  当所有条件都不成立时，最后执行此程序 </span><br><span class="line">fi </span><br><span class="line">#!/bin/bash </span><br><span class="line">#判断用户输入的是什么文件 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">  </span><br><span class="line">read -p &quot;Please input a filename: &quot; file </span><br><span class="line">#接收键盘的输入，并赋予变量file </span><br><span class="line">  </span><br><span class="line">if [ -z &quot;$file&quot; ] </span><br><span class="line">#判断file变量是否为空 </span><br><span class="line">    then </span><br><span class="line">        echo &quot;Error,please input a filename&quot; </span><br><span class="line">        exit 1 </span><br><span class="line">    elif [ ! -e &quot;$file&quot; ] </span><br><span class="line">    #判断file的值是否存在 </span><br><span class="line">    then </span><br><span class="line">        echo &quot;Your input is not a file!&quot; </span><br><span class="line">        exit 2 </span><br><span class="line">    elif [ -f &quot;$file&quot; ] </span><br><span class="line">    #判断file的值是否为普通文件 </span><br><span class="line">    then </span><br><span class="line">        echo &quot;$file is a regulare file!&quot; </span><br><span class="line">    elif [ -d &quot;$file&quot; ] </span><br><span class="line">    #判断file的值是否为目录文件 </span><br><span class="line">    then </span><br><span class="line">        echo &quot;$file is a directory!&quot; </span><br><span class="line">    else </span><br><span class="line">        echo &quot;$file is an other file!&quot; </span><br><span class="line">    fi</span><br></pre></td></tr></table></figure>

<h3 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a>case语句</h3><p>多分支case条件语句</p>
<ul>
<li>case语句和if…elif…else语句一样都是多分支条件语句，不过和if多分支条件语句不同的是，case语句只能判断一种条件关系，而if语句可以判断多种条件关系。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">case $变量名 in </span><br><span class="line">  &quot;值1&quot;） </span><br><span class="line">   如果变量的值等于值1，则执行程序1 </span><br><span class="line">   ;; </span><br><span class="line">  &quot;值2&quot;） </span><br><span class="line">   如果变量的值等于值2，则执行程序2 </span><br><span class="line">   ;; </span><br><span class="line">  ...省略其他分支... </span><br><span class="line">  *） </span><br><span class="line">   如果变量的值都不是以上的值，则执行此程序 </span><br><span class="line">   ;; </span><br><span class="line">esac </span><br><span class="line">#!/bin/bash </span><br><span class="line">#判断用户输入 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">read -p &quot;Please choose yes/no: &quot; -t 30 cho </span><br><span class="line">case $cho in </span><br><span class="line">        &quot;yes&quot;) </span><br><span class="line">                echo &quot;Your choose is yes!&quot; </span><br><span class="line">                ;; </span><br><span class="line">        &quot;no&quot;) </span><br><span class="line">                echo &quot;Your choose is no!&quot; </span><br><span class="line">                ;; </span><br><span class="line">        *) </span><br><span class="line">                echo &quot;Your choose is error!&quot; </span><br><span class="line">                ;; </span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><p>语法一</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">for 变量 in 值1 值2 值3... </span><br><span class="line">  do </span><br><span class="line">   程序 </span><br><span class="line">  done</span><br><span class="line">#!/bin/bash </span><br><span class="line">#打印时间 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">  </span><br><span class="line">for time in morning noon afternoon evening </span><br><span class="line">        do </span><br><span class="line">                echo &quot;This time is $time!&quot; </span><br><span class="line">        done </span><br><span class="line">#!/bin/bash </span><br><span class="line">#批量解压缩脚本 </span><br><span class="line"># Author: shenchao （E-mail: ）   </span><br><span class="line"></span><br><span class="line">cd /lamp ls *.tar.gz &gt; ls.log </span><br><span class="line">for i in $(cat ls.log)         </span><br><span class="line">    do </span><br><span class="line">            tar -zxf $i &amp;&gt;/dev/null </span><br><span class="line">    done </span><br><span class="line">rm -rf /lamp/ls.log </span><br></pre></td></tr></table></figure>

<p>语法二</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">for (( 初始值;循环控制条件;变量变化 )) </span><br><span class="line"> do </span><br><span class="line">  程序 </span><br><span class="line"> done </span><br><span class="line">#!/bin/bash </span><br><span class="line">#从1加到100 </span><br><span class="line"># Author: shenchao （E-mail: ）  </span><br><span class="line">s=0 </span><br><span class="line">for (( i=1;i&lt;=100;i=i+1 ))         </span><br><span class="line">    do                 </span><br><span class="line">        s=$(( $s+$i ))         </span><br><span class="line">    done </span><br><span class="line">echo &quot;The sum of 1+2+...+100 is : $s&quot; </span><br><span class="line">#!/bin/bash </span><br><span class="line">#批量添加指定数量的用户 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line"></span><br><span class="line">read -p &quot;Please input user name: &quot; -t 30 name </span><br><span class="line">read -p &quot;Please input the number of users: &quot; -t 30 num  </span><br><span class="line">read -p &quot;Please input the password of users: &quot; -t 30 pass </span><br><span class="line">if [ ! -z &quot;$name&quot; -a ! -z &quot;$num&quot; -a ! -z &quot;$pass&quot; ] </span><br><span class="line">    then </span><br><span class="line">        y=$(echo $num | sed &#x27;s/[0-9]//g&#x27;)          </span><br><span class="line">        if [ -z &quot;$y&quot; ]                 </span><br><span class="line">            then                 </span><br><span class="line">                for (( i=1;i&lt;=$num;i=i+1 ))                             </span><br><span class="line">                    do                           </span><br><span class="line">                        /usr/sbin/useradd $name$i &amp;&gt;/dev/null           </span><br><span class="line">                        echo $pass | /usr/bin/passwd --stdin $name$i &amp;&gt;/dev/null       </span><br><span class="line">                    done </span><br><span class="line">        fi   </span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h3 id="while循环与until循环"><a href="#while循环与until循环" class="headerlink" title="while循环与until循环"></a>while循环与until循环</h3><p>1、while循环</p>
<ul>
<li>while循环是不定循环，也称作条件循环。只要条件判断式成立，循环就会一直继续，直到条件判断式不成立，循环才会停止。这就和for的固定循环不太一样了。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">while [ 条件判断式 ]   do </span><br><span class="line">   程序 </span><br><span class="line">  done </span><br><span class="line">#!/bin/bash </span><br><span class="line">#从1加到100 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">  </span><br><span class="line">i=1 </span><br><span class="line">s=0 </span><br><span class="line">while [ $i -le 100 ] </span><br><span class="line">#如果变量i的值小于等于100，则执行循环 </span><br><span class="line">    do </span><br><span class="line">        s=$(( $s+$i )) </span><br><span class="line">        i=$(( $i+1 )) </span><br><span class="line">    done </span><br><span class="line">echo &quot;The sum is: $s&quot;</span><br></pre></td></tr></table></figure>

<p>2、until循环</p>
<ul>
<li>until循环，和while循环相反，until循环时只要条件判断式不成立则进行循环，并执行循环程序。一旦循环条件成立，则终止循环。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">until [ 条件判断式 ]   do </span><br><span class="line">   程序 </span><br><span class="line">  done </span><br><span class="line">#!/bin/bash </span><br><span class="line">#从1加到100 </span><br><span class="line"># Author: shenchao （E-mail: ） </span><br><span class="line">  </span><br><span class="line">i=1 </span><br><span class="line">s=0 </span><br><span class="line">until [ $i -gt 100 ] </span><br><span class="line">#循环直到变量i的值大于100，就停止循环 </span><br><span class="line">        do </span><br><span class="line">                s=$(( $s+$i )) </span><br><span class="line">                i=$(( $i+1 )) </span><br><span class="line">        done </span><br><span class="line">echo &quot;The sum is: $s&quot;</span><br></pre></td></tr></table></figure>

<h1 id="Linux服务管理"><a href="#Linux服务管理" class="headerlink" title="Linux服务管理"></a>Linux服务管理</h1><h2 id="服务简介与分类"><a href="#服务简介与分类" class="headerlink" title="服务简介与分类"></a>服务简介与分类</h2><p>1、服务的分类</p>
<p><img src="/../images/Snipaste_2023-08-27_21-19-48.png" alt="img"></p>
<p>启动与自启动</p>
<ul>
<li>服务启动：就是在当前系统中让服务运行，并提供功能。</li>
<li>服务自启动：自启动是指让服务在系统开机或重启动之后，随着系统的启动而自动启动服务。</li>
</ul>
<p>查询已安装的服务</p>
<ul>
<li>RPM包安装的服务<ul>
<li>chkconfig –list #查看服务自启动状态，可以看到所有RPM包安装的服务</li>
</ul>
</li>
<li>源码包安装的服务<ul>
<li>查看服务安装位置，一般是&#x2F;usr&#x2F;local&#x2F;下</li>
</ul>
</li>
</ul>
<p>RPM安装服务和源码包安装服务的区别</p>
<ul>
<li>RPM安装服务和源码包安装服务的区别就是安装位置的不同<ul>
<li>源码包安装在指定位置，一般是&#x2F;usr&#x2F;local&#x2F;</li>
<li>RPM包安装在默认位置中</li>
</ul>
</li>
</ul>
<h2 id="RPM包安装服务的管理"><a href="#RPM包安装服务的管理" class="headerlink" title="RPM包安装服务的管理"></a>RPM包安装服务的管理</h2><h3 id="独立服务的管理"><a href="#独立服务的管理" class="headerlink" title="独立服务的管理"></a>独立服务的管理</h3><p>1、RPM包安装服务的位置</p>
<ul>
<li>RPM安装服务和源码包安装服务的区别就是安装位置的不同<ul>
<li>源码包安装在指定位置，一般是&#x2F;usr&#x2F;local&#x2F;</li>
<li>RPM包安装在默认位置中</li>
</ul>
</li>
<li>&#x2F;etc&#x2F;init.d&#x2F;：启动脚本位置</li>
<li>&#x2F;etc&#x2F;sysconfig&#x2F;：初始化环境配置文件位置</li>
<li>&#x2F;etc&#x2F;：配置文件位置</li>
<li>&#x2F;etc&#x2F;xinetd.conf：xinetd配置文件</li>
<li>&#x2F;etc&#x2F;xinetd.d&#x2F;：基于xinetd服务的启动脚本</li>
<li>&#x2F;var&#x2F;lib&#x2F;：服务产生的数据放在这里</li>
<li>&#x2F;var&#x2F;log&#x2F;：日志</li>
</ul>
<p>2、独立服务的启动</p>
<ul>
<li>&#x2F;etc&#x2F;init.d&#x2F;独立服务名 start|stop|status|restart|</li>
<li>service 独立服务名 start|stop|restart|status|</li>
</ul>
<p>3、独立服务的自启动</p>
<ul>
<li>chkconfig [–level 运行级别] [独立服务名] [on|off]</li>
<li>修改&#x2F;etc&#x2F;rc.d&#x2F;rc.local文件</li>
<li>使用ntsysv命令管理自启动</li>
</ul>
<h3 id="基于xinetd服务的管理"><a href="#基于xinetd服务的管理" class="headerlink" title="基于xinetd服务的管理"></a>基于xinetd服务的管理</h3><p>1、安装xinetd与telnet</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum -y install xinetd </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# yum -y install telnet-server</span><br></pre></td></tr></table></figure>

<p>2、xinetd服务的启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi /etc/xinetd.d/telnet </span><br><span class="line"></span><br><span class="line">service telnet                                  服务的名称为telnet </span><br><span class="line">&#123;         </span><br><span class="line">    flags           = REUSE                     标志为REUSE，设定TCP/IP socket可重用         </span><br><span class="line">    socket_type     = stream                    使用TCP协议数据包 </span><br><span class="line">    wait            = no                        允许多个连接同时连接 </span><br><span class="line">    user            = root                      启动服务的用户为root         </span><br><span class="line">    server          = /usr/sbin/in.telnetd      服务的启动程序         </span><br><span class="line">    log_on_failure  += USERID                   登陆失败后，记录用户的ID </span><br><span class="line">    disable         = no                        服务不启动 </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>重启xinetd服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# service xinetd restart </span><br></pre></td></tr></table></figure>

<p>3、xinetd服务的自启动</p>
<ul>
<li>[root@localhost ~]# chkconfig telnet on</li>
<li>ntsysv</li>
</ul>
<h2 id="源码包安装服务的管理"><a href="#源码包安装服务的管理" class="headerlink" title="源码包安装服务的管理"></a>源码包安装服务的管理</h2><p>1、源码包安装服务的启动</p>
<ul>
<li><p>使用绝对路径，调用启动脚本来启动。不同的源码包的启动脚本不同。可以查看源码包的安装说明，查看启动脚本的方法。</p>
<p>&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;bin&#x2F;apachectl start|stop</p>
</li>
</ul>
<p>2、源码包服务的自启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi /etc/rc.d/rc.local </span><br><span class="line">加入 </span><br><span class="line">/usr/local/apache2/bin/apachectl  start </span><br></pre></td></tr></table></figure>

<p>3、让源码包服务被服务管理命令识别</p>
<ul>
<li><p>让源码包的apache服务能被service命令管理启动</p>
<p>ln -s &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;bin&#x2F;apachectl &#x2F;etc&#x2F;init.d&#x2F;apache</p>
</li>
<li><p>让源码包的apache服务能被chkconfig与ntsysv命令管理自启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/init.d/apache </span><br><span class="line"># chkconfig: 35 86 76 </span><br><span class="line">#指定httpd脚本可以被chkconfig命令管理。格式是：  </span><br><span class="line">    chkconfig： 运行级别 启动顺序 关闭顺序 </span><br><span class="line"># description: source package apache </span><br><span class="line">#说明，内容随意 </span><br><span class="line">[root@localhost ~]# chkconfig --add apache </span><br><span class="line">#把源码包apache加入chkconfig命令</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="服务管理总结"><a href="#服务管理总结" class="headerlink" title="服务管理总结"></a>服务管理总结</h2><p><img src="/../images/Snipaste_2023-08-27_21-33-00.png" alt="img"></p>
<h1 id="Linux系统管理"><a href="#Linux系统管理" class="headerlink" title="Linux系统管理"></a>Linux系统管理</h1><h2 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h2><h3 id="进程查看"><a href="#进程查看" class="headerlink" title="进程查看"></a>进程查看</h3><p>1、进程简介</p>
<ul>
<li>进程是正在执行的一个程序或命令，每一个进程都是一个运行的实体，都有自己的地址空间，并占用一定的系统资源。</li>
</ul>
<p>2、进程管理的作用</p>
<ul>
<li>判断服务器健康状态</li>
<li>查看系统中所有进程</li>
<li>杀死进程</li>
</ul>
<p>3、查看系统中所有进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ps aux </span><br><span class="line">#查看系统中所有进程，使用BSD操作系统格式 </span><br><span class="line">[root@localhost ~]# ps -le </span><br><span class="line">#查看系统中所有进程，使用Linux标准命令格式。 </span><br></pre></td></tr></table></figure>

<ul>
<li>USER：该进程是由哪个用户产生的；</li>
<li>PID：进程的ID号；</li>
<li>%CPU：该进程占用CPU资源的百分比，占用越高，进程越耗费资源；</li>
<li>%MEM：该进程占用物理内存的百分比，占用越高，进程越耗费资源；</li>
<li>VSZ：该进程占用虚拟内存的大小，单位KB；</li>
<li>RSS：该进程占用实际物理内存的大小，单位KB；</li>
<li>TTY：该进程是在哪个终端中运行的。其中tty1-tty7代表本地控制台终端，tty1-tty6是本地的字符界面终端，tty7是图形终端。pts&#x2F;0-255代表虚拟终端。</li>
<li>STAT：进程状态。常见的状态有：R：运行、S：睡眠、T：停止状态、s：包含子进程、+：位于后台</li>
<li>START：该进程的启动时间</li>
<li>TIME：该进程占用CPU的运算时间，注意不是系统时间</li>
<li>COMMAND：产生此进程的命令名</li>
</ul>
<p>4、查看系统健康状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# top [选项] </span><br><span class="line">选项： </span><br><span class="line">    -d 秒数： 指定top命令每隔几秒更新。默认是3秒</span><br><span class="line"></span><br><span class="line">在top命令的交互模式当中可以执行的命令： </span><br><span class="line">    ？或h：  显示交互模式的帮助 </span><br><span class="line">    P：   以CPU使用率排序，默认就是此项 </span><br><span class="line">    M：   以内存的使用率排序 </span><br><span class="line">    N：   以PID排序 </span><br><span class="line">    q：   退出top</span><br></pre></td></tr></table></figure>

<p>第一行信息为任务队列信息</p>
<table>
<thead>
<tr>
<th>内容</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>12:26:46</td>
<td>系统当前时间</td>
</tr>
<tr>
<td>up 1 day, 13:32</td>
<td>系统的运行时间，本机已经运行1天13小时32分钟</td>
</tr>
<tr>
<td>2 users</td>
<td>当前登录了两个用户</td>
</tr>
<tr>
<td>load average: 0.00, 0.00, 0.00</td>
<td>系统在之前1分钟，5分钟，15分钟的平均负载。一般认为小于1时，负载较小。如果大于1，系统已经超出负荷。</td>
</tr>
</tbody></table>
<p>第二行为进程信息</p>
<table>
<thead>
<tr>
<th>内容</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Tasks: 95 total</td>
<td>系统中的进程总数</td>
</tr>
<tr>
<td>1 running</td>
<td>正在运行的进程数</td>
</tr>
<tr>
<td>94 sleeping</td>
<td>睡眠的进程</td>
</tr>
<tr>
<td>0 stopped</td>
<td>正在停止的进程</td>
</tr>
<tr>
<td>0 zombie</td>
<td>僵尸进程。如果不是0，需要手工检查僵尸进程</td>
</tr>
</tbody></table>
<p>第三行为CPU信息</p>
<table>
<thead>
<tr>
<th>内容</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Cpu(s): 0.1%us</td>
<td>用户模式占用的CPU百分比</td>
</tr>
<tr>
<td>0.1%sy</td>
<td>系统模式占用的CPU百分比</td>
</tr>
<tr>
<td>0.0%ni</td>
<td>改变过优先级的用户进程占用的CPU百分比</td>
</tr>
<tr>
<td>99.7%id</td>
<td>空闲CPU的CPU百分比</td>
</tr>
<tr>
<td>0.1%wa</td>
<td>等待输入&#x2F;输出的进程的占用CPU百分比</td>
</tr>
<tr>
<td>0.0%hi</td>
<td>硬中断请求服务占用的CPU百分比</td>
</tr>
<tr>
<td>0.1%si</td>
<td>软中断请求服务占用的CPU百分比</td>
</tr>
<tr>
<td>0.0%st</td>
<td>st（Steal time）虚拟时间百分比。就是当有虚拟机时，虚拟CPU 等待实际CPU的时间百分比。</td>
</tr>
</tbody></table>
<p>第四行为物理内存信息</p>
<table>
<thead>
<tr>
<th>内容</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Mem: 625344k total</td>
<td>物理内存的总量，单位KB</td>
</tr>
<tr>
<td>571504k used</td>
<td>已经使用的物理内存数量</td>
</tr>
<tr>
<td>53840k free</td>
<td>空闲的物理内存数量，我们使用的是虚拟机，总共只分配了628MB内存，所以只有53MB的空闲内存了</td>
</tr>
<tr>
<td>65800k buffers</td>
<td>作为缓冲的内存数量</td>
</tr>
</tbody></table>
<p>第五行为交换分区（swap）信息</p>
<table>
<thead>
<tr>
<th>内容</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Swap: 524280k total</td>
<td>交换分区（虚拟内存）的总大小</td>
</tr>
<tr>
<td>0k used</td>
<td>已经使用的交互分区的大小</td>
</tr>
<tr>
<td>524280k free</td>
<td>空闲交换分区的大小</td>
</tr>
<tr>
<td>409280k cached</td>
<td>作为缓存的交互分区的大小</td>
</tr>
</tbody></table>
<p>5、查看进程树</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# pstree [选项] </span><br><span class="line">选项： </span><br><span class="line">  -p： 显示进程的PID </span><br><span class="line">  -u： 显示进程的所属用户</span><br></pre></td></tr></table></figure>

<h3 id="终止进程"><a href="#终止进程" class="headerlink" title="终止进程"></a>终止进程</h3><p>1、kill命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# kill –l </span><br><span class="line">#查看可用的进程信号</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>信号代号</th>
<th>信号名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>SIGHUP</td>
<td>该信号让进程立即关闭，然后重新读取配置文件之后重启。</td>
</tr>
<tr>
<td>2</td>
<td>SIGINT</td>
<td>程序终止信号，用于终止前台进程。相当于输出ctrl+c快捷键。</td>
</tr>
<tr>
<td>8</td>
<td>SIGFPE</td>
<td>在发生致命的算术运算错误时发出. 不仅包括浮点运算错误, 还包括溢出及除数为0等其它所有的算术的错误。</td>
</tr>
<tr>
<td>9</td>
<td>SIGKILL</td>
<td>用来立即结束程序的运行. 本信号不能被阻塞、处理和忽略。一般用于强制终止进程。</td>
</tr>
<tr>
<td>14</td>
<td>SIGALRM</td>
<td>时钟定时信号, 计算的是实际的时间或时钟时间. alarm函数使用该信号。</td>
</tr>
<tr>
<td>15</td>
<td>SIGTERM</td>
<td>正常结束进程的信号，kill命令的默认信号。有时如果进程已经发生问题，这个信号是无法正常终止进程的，我们才会尝试SIGKILL信号，也就是信号9。</td>
</tr>
<tr>
<td>18</td>
<td>SIGCONT</td>
<td>该信号可以让暂停的进程恢复执行，本信号不能被阻断。</td>
</tr>
<tr>
<td>19</td>
<td>SIGSTOP</td>
<td>该信号可以暂停前台进程，相当于输入ctrl+z快捷键。本信号不能被阻断。</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# kill -1 22354 </span><br><span class="line">#重启进程 </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# kill -9 22368 </span><br><span class="line">#强制杀死进程 </span><br></pre></td></tr></table></figure>

<p>2、killall命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# killall [选项][信号] 进程名 </span><br><span class="line">#按照进程名杀死进程 </span><br><span class="line">选项： </span><br><span class="line">  -i： 交互式，询问是否要杀死某个进程 </span><br><span class="line">  -I： 忽略进程名的大小写</span><br></pre></td></tr></table></figure>

<p>3、pkill命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# pkill [选项] [信号] 进程名 </span><br><span class="line">#按照进程名终止进程 </span><br><span class="line">选项： </span><br><span class="line">  -t 终端号： 按照终端号踢出用户 </span><br></pre></td></tr></table></figure>

<p>按照终端号踢出用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# w </span><br><span class="line">#使用w命令查询本机已经登录的用户 </span><br><span class="line">[root@localhost ~]# pkill -t -9 pts/1 </span><br><span class="line">#强制杀死从pts/1虚拟终端登录的进程</span><br></pre></td></tr></table></figure>

<h2 id="工作管理"><a href="#工作管理" class="headerlink" title="工作管理"></a>工作管理</h2><p>1、把进程放入后台</p>
<ul>
<li><p>tar -zcf etc.tar.gz &#x2F;etc &amp;</p>
</li>
<li><p>[root@localhost ~]# top</p>
<p>#在top命令执行的过程中，按下ctrl+z快捷键</p>
</li>
</ul>
<p>2、查看后台的工作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# jobs [-l] </span><br><span class="line">选项： </span><br><span class="line">  -l： 显示工作的PID </span><br><span class="line"> </span><br><span class="line">注：“+”号代表最近一个放入后台的工作，也是工作恢复时，默认恢复的工作。“-”号代表倒数第二个放入后台的工作 </span><br></pre></td></tr></table></figure>

<p>3、将后台暂停的工作恢复到前台执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fg %工作号 </span><br><span class="line">参数： </span><br><span class="line">  %工作号： %号可以省略，但是注意工作号</span><br><span class="line">   和PID的区别 </span><br></pre></td></tr></table></figure>

<p>4、把后台暂停的工作恢复到后台执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# bg %工作号 </span><br><span class="line"> </span><br><span class="line">注：后台恢复执行的命令，是不能和前台有</span><br><span class="line">交互的，否则不能恢复到后台执行</span><br></pre></td></tr></table></figure>

<h2 id="系统资源查看"><a href="#系统资源查看" class="headerlink" title="系统资源查看"></a>系统资源查看</h2><p>1、vmstat命令监控系统资源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vmstat [刷新延时 刷新次数]</span><br><span class="line"></span><br><span class="line">例如： [root@localhost proc]# vmstat 1 3</span><br></pre></td></tr></table></figure>

<p>2、dmesg开机时内核检测信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# dmesg </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# dmesg | grep CPU </span><br></pre></td></tr></table></figure>

<p>3、free命令查看内存使用状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# free [-b|-k|-m|-g] </span><br><span class="line">选项： </span><br><span class="line"> -b： 以字节为单位显示 </span><br><span class="line"> -k： 以KB为单位显示，默认就是以KB为单位显示  </span><br><span class="line"> -m： 以MB为单位显示  </span><br><span class="line"> -g： 以GB为单位显示  </span><br><span class="line"></span><br><span class="line">缓存和缓冲的区别</span><br><span class="line"></span><br><span class="line">- 简单来说缓存（cache）是用来加速数据从硬盘中“读取”的，而缓冲（buffer）是用来加速数据“写入”硬盘的。 </span><br><span class="line"></span><br><span class="line">4、查看CPU信息 </span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">[root@localhost ~]# cat /proc/cpuinfo  </span><br></pre></td></tr></table></figure>

<p>5、uptime命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# uptime  </span><br><span class="line">#显示系统的启动时间和平均负载，也就是top命令的第一行。w命令也可以看到这个数据。</span><br></pre></td></tr></table></figure>

<p>6、查看系统与内核相关信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# uname [选项] </span><br><span class="line">选项： </span><br><span class="line"> -a： 查看系统所有相关信息； </span><br><span class="line"> -r： 查看内核版本； </span><br><span class="line"> -s： 查看内核名称。  </span><br></pre></td></tr></table></figure>

<p>判断当前系统的位数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# file /bin/ls</span><br></pre></td></tr></table></figure>

<p>查询当前Linux系统的发行版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lsb_release -a </span><br></pre></td></tr></table></figure>

<p>7、列出进程打开或使用的文件信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lsof [选项] </span><br><span class="line">#列出进程调用或打开的文件的信息 </span><br><span class="line">选项： </span><br><span class="line">  -c 字符串： 只列出以字符串开头的进程打开的文件 </span><br><span class="line">  -u 用户名： 只列出某个用户的进程打开的文件 </span><br><span class="line">  -p pid：  列出某个PID进程打开的文件</span><br></pre></td></tr></table></figure>

<h2 id="系统定时任务"><a href="#系统定时任务" class="headerlink" title="系统定时任务"></a>系统定时任务</h2><p>1、crond服务管理与访问控制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# service crond restart </span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# chkconfig crond on</span><br></pre></td></tr></table></figure>

<p>2、用户的crontab设置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# crontab [选项] </span><br><span class="line">选项： </span><br><span class="line"> -e：  编辑crontab定时任务 </span><br><span class="line"> -l：  查询crontab任务 </span><br><span class="line"> -r：  删除当前用户所有的crontab任务 </span><br><span class="line"></span><br><span class="line">[root@localhost ~]# crontab -e </span><br><span class="line">#进入crontab编辑界面。会打开vim编辑你的工作。 </span><br></pre></td></tr></table></figure>

<p><code>* * * * *</code> 执行的任务</p>
<table>
<thead>
<tr>
<th>项目</th>
<th>含义</th>
<th>范围</th>
</tr>
</thead>
<tbody><tr>
<td>第一个“*”</td>
<td>一小时当中的第几分钟</td>
<td>0-59</td>
</tr>
<tr>
<td>第二个“*”</td>
<td>一天当中的第几小时</td>
<td>0-23</td>
</tr>
<tr>
<td>第三个“*”</td>
<td>一个月当中的第几天</td>
<td>1-31</td>
</tr>
<tr>
<td>第四个“*”</td>
<td>一年当中的第几月</td>
<td>1-12</td>
</tr>
<tr>
<td>第五个“*”</td>
<td>一周当中的星期几</td>
<td>0-7（0和7都代表星期日）</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>特殊符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>代表任何时间。比如第一个“*”就代表一小时中每分钟都执行一次的意思。</td>
</tr>
<tr>
<td>，</td>
<td>代表不连续的时间。比如“0 8,12,16 * * * 命令”，就代表在每天的8点0分，12点0分，16点0分都执行一次命令</td>
</tr>
<tr>
<td>-</td>
<td>代表连续的时间范围。比如“0 5 * * 1-6命令”，代表在周一到周六的凌晨5点0分执行命令</td>
</tr>
<tr>
<td>*&#x2F;n</td>
<td>代表每隔多久执行一次。比如“*&#x2F;10 * * * * 命令”，代表每隔10分钟就执行一遍命令</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>时间</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>45 22 * * * 命令</td>
<td>在22点45分执行命令</td>
</tr>
<tr>
<td>0 17 * * 1 命令</td>
<td>每周1 的17点0分执行命令</td>
</tr>
<tr>
<td>0 5 1,15 * * 命令</td>
<td>每月1号和15号的凌晨5点0分执行命令</td>
</tr>
<tr>
<td>40 4 * * 1-5 命令</td>
<td>每周一到周五的凌晨4点40分执行命令</td>
</tr>
<tr>
<td>*&#x2F;10 4 * * * 命令</td>
<td>每天的凌晨4点，每隔10分钟执行一次命令 0 0 1,15 * 1 命令 每月1号和15号，每周1的0点0分都会执行命令。注意：星期几和几号最好不要同时出现，因为他们定义的都是天。非常容易让管理员混乱。</td>
</tr>
</tbody></table>
<p>举例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*/5 * * * * /bin/echo ”11” &gt;&gt; /tmp/test </span><br><span class="line"> </span><br><span class="line">5 5 * * 2 /sbin/shutdown -r now </span><br><span class="line"> </span><br><span class="line">0 5 1,10,15 * * /root/sh/autobak.sh  </span><br></pre></td></tr></table></figure>

<h1 id="日志管理"><a href="#日志管理" class="headerlink" title="日志管理"></a>日志管理</h1><h2 id="日志管理简介"><a href="#日志管理简介" class="headerlink" title="日志管理简介"></a>日志管理简介</h2><p>1、日志服务</p>
<ul>
<li>在CentOS 6.x中日志服务已经由rsyslogd取代了原先的syslogd服务。rsyslogd日志服务更加先进，功能更多。但是不论该服务的使用，还是日志文件的格式其实都是和syslogd服务相兼容的，所以学习起来基本和syslogd服务一致。</li>
<li>rsyslogd的新特点：<ul>
<li>基于TCP网络协议传输日志信息；</li>
<li>更安全的网络传输方式；</li>
<li>有日志消息的及时分析框架；</li>
<li>后台数据库；</li>
<li>配置文件中可以写简单的逻辑判断；</li>
<li>与syslog配置文件相兼容。</li>
</ul>
</li>
</ul>
<p>确定服务启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ps aux | grep rsyslogd </span><br><span class="line">#查看服务是否启动 </span><br><span class="line">chkconfig --list | grep rsyslog </span><br><span class="line">#查看服务是否自启动 </span><br></pre></td></tr></table></figure>

<p>2、常见日志的作用</p>
<table>
<thead>
<tr>
<th>日志文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;var&#x2F;log&#x2F;cron</td>
<td>记录了系统定时任务相关的日志。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;cups&#x2F;</td>
<td>记录打印信息的日志</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;dmesg</td>
<td>记录了系统在开机时内核自检的信息。也可以使用dmesg命令直接查看内核自检信息。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;btmp</td>
<td>记录错误登录的日志。这个文件是二进制文件，不能直接vi查看，而要使用lastb命令查看，命令如下： [root@localhost log]# lastb root tty1 Tue Jun 4 22:38 - 22:38 (00:00) #有人在6月4日22:38使用root用户，在本地终端1登录错误</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;lastlog</td>
<td>记录系统中所有用户最后一次的登录时间的日志。这个文件也是二进制文件，不能直接vi，而要使用lastlog命令查看。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;mailog</td>
<td>记录邮件信息。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;message</td>
<td>记录系统重要信息的日志。这个日志文件中会记录Linux系统的绝大多数重要信息，如果系统出现问题时，首先要检查的就应该是这个日志文件。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;secure</td>
<td>记录验证和授权方面的信息，只要涉及账户和密码的程序都会记录。比如说系统的登录，ssh的登录，su切换用户，sudo授权，甚至添加用户和修改用户密码都会记录在这个日志文件中。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;wtmp</td>
<td>永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件。同样这个文件也是一个二进制文件，不能直接vi，而需要使用last命令来查看。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;run&#x2F;utmp</td>
<td>记录当前已经登录的用户的信息。这个文件会随着用户的登录和注销而不断变化，只记录当前登录用户的信息。同样这个文件不能直接vi，而要使用w，who，users等命令来查询。</td>
</tr>
</tbody></table>
<ul>
<li>除了系统默认的日志之外，采用RPM方式安装的系统服务也会默认把日志记录在&#x2F;var&#x2F;log&#x2F;目录中（源码包安装的服务日志是在源码包指定目录中）。不过这些日志不是由rsyslogd服务来记录和管理的，而是各个服务使用自己的日志管理文档来记录自身日志。</li>
</ul>
<table>
<thead>
<tr>
<th>日志文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;</td>
<td>RPM包安装的apache服务的默认日志目录</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;mail&#x2F;</td>
<td>RPM包安装的邮件服务的额外日志目录</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;samba&#x2F;</td>
<td>RPM包安装的samba服务的日志目录</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;sssd&#x2F;</td>
<td>守护进程安全服务目录</td>
</tr>
</tbody></table>
<h2 id="rsyslogd日志服务"><a href="#rsyslogd日志服务" class="headerlink" title="rsyslogd日志服务"></a>rsyslogd日志服务</h2><p>1、日志文件格式</p>
<ul>
<li>基本日志格式包含以下四列：<ul>
<li>事件产生的时间；</li>
<li>发生事件的服务器的主机名；</li>
<li>产生事件的服务名或程序名；</li>
<li>事件的具体信息。</li>
</ul>
</li>
</ul>
<p>2、&#x2F;etc&#x2F;rsyslog.conf配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">authpriv.*                          /var/log/secure </span><br><span class="line">#服务名称[连接符号]日志等级  日志记录位置 </span><br><span class="line">#认证相关服务.所有日志等级  记录在/var/log/secure日志中 </span><br></pre></td></tr></table></figure>

<p>服务名称</p>
<table>
<thead>
<tr>
<th>服务名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>auth</td>
<td>安全和认证相关消息（不推荐使用authpriv替代）</td>
</tr>
<tr>
<td>authpriv</td>
<td>安全和认证相关消息（私有的）</td>
</tr>
<tr>
<td>cron</td>
<td>系统定时任务cront和at产生的日志</td>
</tr>
<tr>
<td>daemon</td>
<td>和各个守护进程相关的日志</td>
</tr>
<tr>
<td>ftp</td>
<td>ftp守护进程产生的日志</td>
</tr>
<tr>
<td>kern</td>
<td>内核产生的日志（不是用户进程产生的）</td>
</tr>
<tr>
<td>local0-local7</td>
<td>为本地使用预留的服务</td>
</tr>
<tr>
<td>lpr</td>
<td>打印产生的日志</td>
</tr>
<tr>
<td>mail</td>
<td>邮件收发信息</td>
</tr>
<tr>
<td>news</td>
<td>与新闻服务器相关的日志</td>
</tr>
<tr>
<td>syslog</td>
<td>有syslogd服务产生的日志信息（虽然服务名称已经改为rsyslogd，但是很多配置都还是沿用了syslogd的，这里并没有修改服务名）。</td>
</tr>
<tr>
<td>user</td>
<td>用户等级类别的日志信息</td>
</tr>
<tr>
<td>uucp</td>
<td>uucp子系统的日志信息，uucp是早期linux系统进行数据传递的协议，后来也常用在新闻组服务中。</td>
</tr>
</tbody></table>
<p>连接符号</p>
<ul>
<li>连接符号可以识别为：<ul>
<li>“*”代表所有日志等级，比如：“authpriv.*”代表authpriv认证信息服务产生的日志，所有的日志等级都记录</li>
<li>“.”代表只要比后面的等级高的（包含该等级）日志都记录下来。比如：“cron.info”代表cron服务产生的日志，只要日志等级大于等于info级别，就记录</li>
<li>“.&#x3D;”代表只记录所需等级的日志，其他等级的都不记录。比如：“*.&#x3D;emerg”代表人和日志服务产生的日志，只要等级是emerg等级就记录。这种用法及少见，了解就好</li>
<li>“.!”代表不等于，也就是除了该等级的日志外，其他等级的日志都记录。</li>
</ul>
</li>
</ul>
<p>日志等级</p>
<table>
<thead>
<tr>
<th>等级名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>debug</td>
<td>一般的调试信息说明</td>
</tr>
<tr>
<td>info</td>
<td>基本的通知信息</td>
</tr>
<tr>
<td>notice</td>
<td>普通信息，但是有一定的重要性</td>
</tr>
<tr>
<td>warning</td>
<td>警告信息，但是还不回影响到服务或系统的运行</td>
</tr>
<tr>
<td>err</td>
<td>错误信息，一般达到err等级的信息以及可以影响到服务或系统的运行了。</td>
</tr>
<tr>
<td>crit</td>
<td>临界状况信息，比err等级还要严重</td>
</tr>
<tr>
<td>alert</td>
<td>警告状态信息，比crit还要严重。必须立即采取行动</td>
</tr>
<tr>
<td>emerg</td>
<td>疼痛等级信息，系统已经无法使用了</td>
</tr>
</tbody></table>
<p>日志记录位置</p>
<ul>
<li>日志文件的绝对路径，如“&#x2F;var&#x2F;log&#x2F;secure”</li>
<li>系统设备文件，如“&#x2F;dev&#x2F;lp0”</li>
<li>转发给远程主机，如“@192.168.0.210:514”</li>
<li>用户名，如“root”</li>
<li>忽略或丢弃日志，如“~”</li>
</ul>
<h2 id="日志轮替"><a href="#日志轮替" class="headerlink" title="日志轮替"></a>日志轮替</h2><p>1、日志文件的命名规则</p>
<ul>
<li>如果配置文件中拥有“dateext”参数，那么日志会用日期来作为日志文件的后缀，例如“secure-20130605”。这样的话日志文件名不会重叠，所以也就不需要日志文件的改名，只需要保存指定的日志个数，删除多余的日志文件即可。</li>
<li>如果配置文件中没有“dateext”参数，那么日志文件就需要进行改名了。当第一次进行日志轮替时，当前的“secure”日志会自动改名为“secure.1”，然后新建“secure”日志，用来保存新的日志。当第二次进行日志轮替时，“secure.1”会自动改名为“secure.2”，当前的“secure”日志会自动改名为“secure.1”，然后也会新建“secure”日志，用来保存新的日志，以此类推。</li>
</ul>
<p>2、logrotate配置文件</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>参数说明</th>
</tr>
</thead>
<tbody><tr>
<td>daily</td>
<td>日志的轮替周期是每天</td>
</tr>
<tr>
<td>weekly</td>
<td>日志的轮替周期是每周</td>
</tr>
<tr>
<td>monthly</td>
<td>日志的轮替周期是每月</td>
</tr>
<tr>
<td>rotate 数字</td>
<td>保留的日志文件的个数。0指没有备份</td>
</tr>
<tr>
<td>compress</td>
<td>日志轮替时，旧的日志进行压缩</td>
</tr>
<tr>
<td>create mode owner group</td>
<td>建立新日志，同时指定新日志的权限与所有者和所属组。如create 0600 root utmp</td>
</tr>
<tr>
<td>mail address</td>
<td>当日志轮替时，输出内容通过邮件发送到指定的邮件地址。如mail <a href="mailto:shenc@lamp.net">shenc@lamp.net</a></td>
</tr>
<tr>
<td>missingok</td>
<td>如果日志不存在，则忽略该日志的警告信息</td>
</tr>
<tr>
<td>notifempty</td>
<td>如果日志为空文件，则不进行日志轮替</td>
</tr>
<tr>
<td>minsize 大小</td>
<td>日志轮替的最小值。也就是日志一定要达到这个最小值才会轮替，否则就算时间达到也不轮替</td>
</tr>
<tr>
<td>size 大小</td>
<td>日志只有大于指定大小才进行日志轮替，而不是按照时间轮替。如size 100k</td>
</tr>
<tr>
<td>dateext</td>
<td>使用日期作为日志轮替文件的后缀。如secure-20130605</td>
</tr>
</tbody></table>
<p>3、把apache日志加入轮替</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi /etc/logrotate.conf  </span><br><span class="line"></span><br><span class="line">/usr/local/apache2/logs/access_log &#123; </span><br><span class="line">    daily </span><br><span class="line">    create </span><br><span class="line">    rotate 30 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、logrotate命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# logrotate [选项] 配置文件名 </span><br><span class="line">选项： </span><br><span class="line"> 如果此命令没有选项，则会按照配置文件中的条件进行日志轮替  </span><br><span class="line"> -v： 显示日志轮替过程。加了-v选项，会显示日志的轮替的过程  </span><br><span class="line"> -f： 强制进行日志轮替。不管日志轮替的条件是否已经符合，强制配置文件中所有的日志进行轮替</span><br></pre></td></tr></table></figure>

<h1 id="启动管理"><a href="#启动管理" class="headerlink" title="启动管理"></a>启动管理</h1><h2 id="CentOS-6-x启动管理"><a href="#CentOS-6-x启动管理" class="headerlink" title="CentOS 6.x启动管理"></a>CentOS 6.x启动管理</h2><h3 id="系统运行级别-1"><a href="#系统运行级别-1" class="headerlink" title="系统运行级别"></a>系统运行级别</h3><p>1、运行级别</p>
<table>
<thead>
<tr>
<th>运行级别</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>关机</td>
</tr>
<tr>
<td>1</td>
<td>单用户模式，可以想象为windows的安全模式，主要用于系统修复</td>
</tr>
<tr>
<td>2</td>
<td>不完全的命令行模式，不含NFS服务</td>
</tr>
<tr>
<td>3</td>
<td>完全的命令行模式，就是标准字符界面</td>
</tr>
<tr>
<td>4</td>
<td>系统保留</td>
</tr>
<tr>
<td>5</td>
<td>图形模式</td>
</tr>
<tr>
<td>6</td>
<td>重启动</td>
</tr>
</tbody></table>
<p>2、运行级别命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# runlevel  </span><br><span class="line">#查看运行级别命令 </span><br><span class="line">[root@localhost ~]# init 运行级别 </span><br><span class="line">#改变运行级别命令 </span><br></pre></td></tr></table></figure>

<p>3、系统默认运行级别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vim /etc/inittab </span><br><span class="line">id:3:initdefault: </span><br><span class="line">#系统开机后直接进入哪个运行级别</span><br></pre></td></tr></table></figure>

<h3 id="系统启动过程"><a href="#系统启动过程" class="headerlink" title="系统启动过程"></a>系统启动过程</h3><p><img src="/../images/20200328220833562.png" alt="img"></p>
<p>initramfs内存文件系统</p>
<ul>
<li>CentOS 6.x中使用initramfs内存文件系统取代了CentOS 5.x中的initrd RAM Disk。他们的作用类似，可以通过启动引导程序加载到内存中，然后加载启动过程中所需要的内核模块，比如USB、SATA、SCSI硬盘的驱动和LVM、RAID文件系统的驱动</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/initramfs </span><br><span class="line">#建立测试目录 </span><br><span class="line">cp /boot/initramfs-2.6.32-279.el6.i686.img /tmp/initramfs/ </span><br><span class="line">#复制initramfs文件 </span><br><span class="line">cd /tmp/initramfs/ </span><br><span class="line">file initramfs-2.6.32-279.el6.i686.img  </span><br><span class="line">mv initramfs-2.6.32-279.el6.i686.img initramfs-2.6.32-279.el6.i686.img.gz </span><br><span class="line">#修改文件的后缀名为.gz </span><br><span class="line">gunzip initramfs-2.6.32-279.el6.i686.img.gz </span><br><span class="line">#解压缩 </span><br><span class="line">file initramfs-2.6.32-279.el6.i686.img  </span><br><span class="line">cpio -ivcdu &lt; initramfs-2.6.32-279.el6.i686.img </span><br><span class="line">#解压缩  </span><br></pre></td></tr></table></figure>

<p>调用&#x2F;etc&#x2F;init&#x2F;rcS.conf配置文件</p>
<ul>
<li>主要功能是两个：<ul>
<li>先调用&#x2F;etc&#x2F;rc.d&#x2F;rc.sysinit，然后由&#x2F;etc&#x2F;rc.d&#x2F;rc.sysinit配置文件进行Linux系统初始化。</li>
<li>然后再调用&#x2F;etc&#x2F;inittab，然后由&#x2F;etc&#x2F;inittab配置文件确定系统的默认运行级别。</li>
</ul>
</li>
</ul>
<p>由&#x2F;etc&#x2F;rc.d&#x2F;rc.sysinit初始化</p>
<ol>
<li>获得网络环境</li>
<li>挂载设备</li>
<li>开机启动画面Plymouth（取替了过往的 RHGB）</li>
<li>判断是否启用SELinux</li>
<li>显示于开机过程中的欢迎画面</li>
<li>初始化硬件</li>
<li>用户自定义模块的加载</li>
<li>配置内核的参数</li>
<li>设置主机名</li>
<li>同步存储器</li>
<li>设备映射器及相关的初始化</li>
<li>初始化软件磁盘阵列（RAID）</li>
<li>初始化 LVM 的文件系统功能</li>
<li>检验磁盘文件系统（fsck）</li>
<li>设置磁盘配额(quota)</li>
<li>重新以可读写模式挂载系统磁盘</li>
<li>更新quota（非必要）</li>
<li>启动系统虚拟随机数生成器</li>
<li>配置机器（非必要）</li>
<li>清除开机过程当中的临时文件</li>
<li>创建ICE目录</li>
<li>启动交换分区（swap）</li>
<li>将开机信息写入&#x2F;var&#x2F;log&#x2F;dmesg文件中</li>
</ol>
<p>调用&#x2F;etc&#x2F;rc.d&#x2F;rc文件</p>
<ul>
<li>运行级别参数传入&#x2F;etc&#x2F;rc.d&#x2F;rc这个脚本之后，由这个脚本文件按照不同的运行级别启动&#x2F;etc&#x2F;rc[0-6].d&#x2F;目录中的相应的程序<ul>
<li>&#x2F;etc&#x2F;rc3.d&#x2F;k??开头的文件（??是数字），会按照数字顺序依次关闭</li>
<li>&#x2F;etc&#x2F;rc3.d&#x2F;S??开头的文件（??是数字），会按照数字顺序依次启动</li>
</ul>
</li>
</ul>
<h2 id="启动引导程序grub"><a href="#启动引导程序grub" class="headerlink" title="启动引导程序grub"></a>启动引导程序grub</h2><h3 id="Grub配置文件"><a href="#Grub配置文件" class="headerlink" title="Grub配置文件"></a>Grub配置文件</h3><p>1、grub中分区表示</p>
<table>
<thead>
<tr>
<th>硬盘</th>
<th>分区</th>
<th>Linux中设备文件名</th>
<th>Grub中设备文件名</th>
</tr>
</thead>
<tbody><tr>
<td>第一块SCSI硬盘</td>
<td>第一个主分区</td>
<td>&#x2F;dev&#x2F;sda1</td>
<td>hd(0,0)</td>
</tr>
<tr>
<td>第二个主分区</td>
<td>&#x2F;dev&#x2F;sda2</td>
<td>hd(0,2)</td>
<td></td>
</tr>
<tr>
<td>扩展分区</td>
<td>&#x2F;dev&#x2F;sda3</td>
<td>hd(0,2)</td>
<td></td>
</tr>
<tr>
<td>第一个逻辑分区</td>
<td>&#x2F;dev&#x2F;sda5</td>
<td>hd(0,4)</td>
<td></td>
</tr>
<tr>
<td>第二块SCSI硬盘</td>
<td>第一个主分区</td>
<td>&#x2F;dev&#x2F;sdb1</td>
<td>hd(1,0)</td>
</tr>
<tr>
<td>第二个主分区</td>
<td>&#x2F;dev&#x2F;sdb2</td>
<td>hd(1,2)</td>
<td></td>
</tr>
<tr>
<td>扩展分区</td>
<td>&#x2F;dev&#x2F;sdb3</td>
<td>hd(1,2)</td>
<td></td>
</tr>
<tr>
<td>第一个逻辑分区</td>
<td>&#x2F;dev&#x2F;sdb5</td>
<td>hd(1,4)</td>
<td></td>
</tr>
</tbody></table>
<p>2、grub配置文件</p>
<p>vi &#x2F;boot&#x2F;grub&#x2F;grub.conf</p>
<ul>
<li><p>default&#x3D;0 默认启动第一个系统</p>
</li>
<li><p>timeout&#x3D;5 等待时间，默认是5秒</p>
</li>
<li><p>splashimage&#x3D;(hd0,0)&#x2F;grub&#x2F;splash.xpm.gz</p>
<p>这里是指定grub启动时的背景图像文件的保存位置的</p>
</li>
<li><p>hiddenmenu 隐藏菜单</p>
</li>
<li><p>title CentOS (2.6.32-279.el6.i686)</p>
<p>title就是标题的意思</p>
</li>
<li><p>root (hd0,0) 是指启动程序的保存分区</p>
</li>
<li><p>kernel &#x2F;vmlinuz-2.6.32-279.el6.i686 ro<br>root&#x3D;UUID&#x3D;b9a7a1a8-767f-4a87-8a2b-a535edb362c9<br>rd_NO_LUKS KEYBOARDTYPE&#x3D;pc KEYTABLE&#x3D;us<br>rd_NO_MD crashkernel&#x3D;auto LANG&#x3D;zh_CN.UTF-8<br>rd_NO_LVM rd_NO_DM rhgb quiet</p>
<p>定义内核加载时的选项</p>
</li>
<li><p>initrd &#x2F;initramfs-2.6.32-279.el6.i686.img</p>
<p>指定了initramfs内存文件系统镜像文件的所在位置</p>
</li>
</ul>
<h3 id="Grub加密与字符界面分辨率调整"><a href="#Grub加密与字符界面分辨率调整" class="headerlink" title="Grub加密与字符界面分辨率调整"></a>Grub加密与字符界面分辨率调整</h3><p>1、grub加密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# grub-md5-crypt  </span><br><span class="line">#生成加密密码串 </span><br><span class="line">[root@localhost ~]# vi /boot/grub/grub.conf</span><br><span class="line"></span><br><span class="line">default=0 </span><br><span class="line">timeout=5 </span><br><span class="line">password --md5 $1$Y84LB1$8tMY2PibScmuOCc8z8U35/ </span><br><span class="line">#password选项放在整体设置处。 </span><br><span class="line">splashimage=(hd0,0)/grub/splash.xpm.gz </span><br><span class="line">hiddenmenu </span><br><span class="line">...省略部分内容... </span><br></pre></td></tr></table></figure>

<p>2、纯字符界面分辨率调整</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;CONFIG_FRAMEBUFFER_CONSOLE&quot; /boot/config-2.6.32-279.el6.i686  </span><br><span class="line">#查询内核是否支持分辨率修改</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>色深</th>
<th>640×480</th>
<th>800×600</th>
<th>1024×768</th>
<th>1280×1024</th>
</tr>
</thead>
<tbody><tr>
<td>8位</td>
<td>769</td>
<td>771</td>
<td>773</td>
<td>775</td>
</tr>
<tr>
<td>15位</td>
<td>784</td>
<td>787</td>
<td>790</td>
<td>793</td>
</tr>
<tr>
<td>16位</td>
<td>785</td>
<td>788</td>
<td>791</td>
<td>794</td>
</tr>
<tr>
<td>32位</td>
<td>786</td>
<td>789</td>
<td>792</td>
<td>795</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vi /boot/grub/grub.conf </span><br><span class="line">kernel /vmlinuz-2.6.32-279.el6.i686 ro </span><br><span class="line">root=UUID=b9a7a1a8-767f-4a87-8a2b-</span><br><span class="line">a535edb362c9 rd_NO_LUKS  </span><br><span class="line">KEYBOARDTYPE=pc KEYTABLE=us </span><br><span class="line">rd_NO_MD crashkernel=auto LANG=zh_CN.UTF-</span><br><span class="line">8 rd_NO_LVM rd_NO_DM rhgb quiet vga=791 </span><br></pre></td></tr></table></figure>

<h2 id="系统修复模式"><a href="#系统修复模式" class="headerlink" title="系统修复模式"></a>系统修复模式</h2><p>1、单用户模式</p>
<p>单用户模式常见的错误修复</p>
<ul>
<li>遗忘root密码</li>
<li>修改系统默认运行级别</li>
</ul>
<p>2、光盘修复模式</p>
<p>重要系统文件丢失，导致系统无法启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">bash-4.1# chroot /mnt/sysimage </span><br><span class="line">#改变主目录 </span><br><span class="line">sh-4.1# cd /root </span><br><span class="line">sh-4.1# rpm -qf /etc/inittab </span><br><span class="line">#查询下/etc/inittab文件属于哪个包。 </span><br><span class="line">sh-4.1# mkdir /mnt/cdrom </span><br><span class="line">#建立挂载点 </span><br><span class="line">sh-4.1# mount /dev/sr0 /mnt/cdrom </span><br><span class="line">#挂载光盘  </span><br><span class="line"> </span><br><span class="line">sh-4.1#  rpm2cpio   \  /mnt/cdrom/Packages/initscripts-8.45.3-1.i386.rpm  \  | cpio -idv ./etc/inittab </span><br><span class="line">#提取inittab文件到当前目录 </span><br><span class="line">sh-4.1#  cp etc/inittab /etc/inittab </span><br><span class="line">#复制inittab文件到指定位置</span><br></pre></td></tr></table></figure>

<p>3、Linux的安全性</p>
<p><img src="/../images/Snipaste_2023-08-27_22-38-03.png" alt="img"></p>
<h1 id="备份与恢复"><a href="#备份与恢复" class="headerlink" title="备份与恢复"></a>备份与恢复</h1><h2 id="备份概述"><a href="#备份概述" class="headerlink" title="备份概述"></a>备份概述</h2><p>1、Linux系统需要备份的数据</p>
<ul>
<li>&#x2F;root&#x2F;目录：</li>
<li>&#x2F;home&#x2F;目录：</li>
<li>&#x2F;var&#x2F;spool&#x2F;mail&#x2F;目录：</li>
<li>&#x2F;etc&#x2F;目录：</li>
<li>其他目录：</li>
</ul>
<p>安装服务的数据</p>
<ul>
<li>apache需要备份的数据<ul>
<li>配置文件</li>
<li>网页主目录</li>
<li>日志文件</li>
</ul>
</li>
<li>mysql需要备份的数据<ul>
<li>源码包安装的mysql：&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data&#x2F;</li>
<li>RPM包安装的mysql：&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;</li>
</ul>
</li>
</ul>
<p>2、备份策略</p>
<ul>
<li>完全备份：完全备份就是指把所有需要备份的数据全部备份，当然完全备份可以备份整块硬盘，整个分区或某个具体的目录</li>
</ul>
<p>增量备份</p>
<p><img src="/../images/Snipaste_2023-08-27_22-41-06.png" alt="img"></p>
<p>差异备份</p>
<p><img src="/../images/Snipaste_2023-08-27_22-41-50.png" alt="img"></p>
<h2 id="dump和restore命令"><a href="#dump和restore命令" class="headerlink" title="dump和restore命令"></a>dump和restore命令</h2><p>1、dump命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# dump [选项] 备份之后的文件名 原文件或目录 </span><br><span class="line">选项： </span><br><span class="line">    -level： 就是我们说的0-9十个备份级别  </span><br><span class="line">    -f 文件名： 指定备份之后的文件名  </span><br><span class="line">    -u：   备份成功之后，把备份时间记录在/etc/dumpdates文件 </span><br><span class="line">    -v：   显示备份过程中更多的输出信息 </span><br><span class="line">    -j：  调用bzlib库压缩备份文件，其实就是把备份文件压缩为.bz2格式，默认压缩等级是2  </span><br><span class="line">    -W： 显示允许被dump的分区的备份等级及备份时间 </span><br></pre></td></tr></table></figure>

<p>备份分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dump -0uj -f /root/boot.bak.bz2 /boot/ </span><br><span class="line">#备份命令。先执行一次完全备份，并压缩和更新备份时间 </span><br><span class="line">cat /etc/dumpdates </span><br><span class="line">#查看备份时间文件 </span><br><span class="line">cp install.log /boot/ </span><br><span class="line">#复制日志文件到/boot分区 </span><br><span class="line">dump -1uj -f /root/boot.bak1.bz2 /boot/ </span><br><span class="line">#增量备份/boot分区，并压缩 </span><br><span class="line">dump –W </span><br><span class="line">#查询分区的备份时间及备份级别的 </span><br></pre></td></tr></table></figure>

<p>备份文件或目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dump -0j -f /root/etc.dump.bz2 /etc/ </span><br><span class="line">#完全备份/etc/目录，只能使用0级别进行完全备份，而不再支持增量备份 </span><br></pre></td></tr></table></figure>

<p>2、restore命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# restore [模式选项] [选项]  </span><br><span class="line">模式选项：restore命令常用的模式有以下四种，这四个模式不能混用。  </span><br><span class="line">    -C：比较备份数据和实际数据的变化  </span><br><span class="line">    -i： 进入交互模式，手工选择需要恢复的文件。  </span><br><span class="line">    -t： 查看模式，用于查看备份文件中拥有哪些数据。  </span><br><span class="line">    -r： 还原模式，用于数据还原。 </span><br><span class="line">选项： </span><br><span class="line">    -f： 指定备份文件的文件名 </span><br></pre></td></tr></table></figure>

<p>比较备份数据和实际数据的变化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv /boot/vmlinuz-2.6.32-279.el6.i686 /boot/vmlinuz-2.6.32-279.el6.i686.bak </span><br><span class="line">#把/boot目录中内核镜像文件改个名字 </span><br><span class="line">restore -C -f /root/boot.bak.bz2  </span><br><span class="line">#restore发现内核镜像文件丢失  </span><br></pre></td></tr></table></figure>

<p>查看模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">restore -t -f boot.bak.bz2</span><br></pre></td></tr></table></figure>

<p>还原模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#还原boot.bak.bz2分区备份 </span><br><span class="line">#先还原完全备份的数据 </span><br><span class="line">mkdir boot.test </span><br><span class="line">cd boot.test/ </span><br><span class="line">restore -r -f /root/boot.bak.bz2 </span><br><span class="line">#解压缩 </span><br><span class="line">restore -r -f /root/boot.bak1.bz2 </span><br><span class="line">#恢复增量备份数据  </span><br><span class="line"> </span><br><span class="line">#还原/etc/目录的备份etc.dump.bz2 </span><br><span class="line">restore -r -f etc.dump.bz2  </span><br><span class="line">#还原etc.dump.bz2备份</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/10/VMware%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Lanzl">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lanzl">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/09/10/VMware%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/" class="post-title-link" itemprop="url">VMware搭建k8s集群</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-09-10 21:23:15 / 修改时间：21:59:17" itemprop="dateCreated datePublished" datetime="2023-09-10T21:23:15+08:00">2023-09-10</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="规划"><a href="#规划" class="headerlink" title="规划"></a>规划</h1><ul>
<li><p>虚拟机</p>
<table>
<thead>
<tr>
<th>主机名</th>
<th>ip</th>
<th>配置</th>
<th>系统</th>
</tr>
</thead>
<tbody><tr>
<td>k8s-master</td>
<td>192.168.101.128</td>
<td>CPU:2核 内存:2G 磁盘:20G</td>
<td>CentOS 7.9.2009</td>
</tr>
<tr>
<td>k8s-node1</td>
<td>192.168.101.129</td>
<td>CPU:2核 内存:2G 磁盘:20G</td>
<td>CentOS 7.9.2009</td>
</tr>
<tr>
<td>k8s-node1</td>
<td>192.168.101.130</td>
<td>CPU:2核 内存:2G 磁盘:20G</td>
<td>CentOS 7.9.2009</td>
</tr>
</tbody></table>
</li>
<li><p>版本</p>
<table>
<thead>
<tr>
<th>包名</th>
<th>版本</th>
</tr>
</thead>
<tbody><tr>
<td>Docker</td>
<td>24.0.5</td>
</tr>
<tr>
<td>Kubernetes</td>
<td>1.28.0</td>
</tr>
</tbody></table>
</li>
</ul>
<h1 id="创建虚拟机"><a href="#创建虚拟机" class="headerlink" title="创建虚拟机"></a>创建虚拟机</h1><ul>
<li>下载VMware <a target="_blank" rel="noopener" href="https://www.vmware.com/products.html?resource=product-listing:anywhere-workspace/desktop-hypervisor#product-listing:anywhere-workspace/desktop-hypervisor">官网地址</a></li>
<li>下载CentOS 7.9.2009 <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/centos/7.9.2009/isos/x86_64/">镜像地址</a></li>
</ul>
<h1 id="安装-Docker"><a href="#安装-Docker" class="headerlink" title="安装 Docker"></a>安装 Docker</h1><blockquote>
<p>参考文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p>
</blockquote>
<ol>
<li><p>移除已有docker相关包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">    docker-client \</span><br><span class="line">    docker-client-latest \</span><br><span class="line">    docker-common \</span><br><span class="line">    docker-latest \</span><br><span class="line">    docker-latest-logrotate \</span><br><span class="line">    docker-logrotate \</span><br><span class="line">    docker-engine</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置yum源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils</span><br><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装Docker Engine</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker --now</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置加速及cgroup驱动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;: [</span><br><span class="line">        &quot;https://docker.mirrors.ustc.edu.cn&quot;,</span><br><span class="line">        &quot;https://hub-mirror.c.163.com&quot;,</span><br><span class="line">        &quot;https://reg-mirror.qiniu.com&quot;,</span><br><span class="line">        &quot;https://registry.docker-cn.com&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],</span><br><span class="line">    &quot;log-driver&quot;: &quot;json-file&quot;,</span><br><span class="line">    &quot;log-opts&quot;: &#123;</span><br><span class="line">        &quot;max-size&quot;: &quot;100m&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;storage-driver&quot;: &quot;overlay2&quot;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="安装-cri-dockerd"><a href="#安装-cri-dockerd" class="headerlink" title="安装 cri-dockerd"></a>安装 cri-dockerd</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ARCH=&quot;amd64&quot;</span><br><span class="line">CRI_DOCKERD_VERSION=&quot;0.3.4&quot;</span><br><span class="line">wget https://github.com/Mirantis/cri-dockerd/releases/download/v$&#123;CRI_DOCKERD_VERSION&#125;/cri-dockerd-$&#123;CRI_DOCKERD_VERSION&#125;.$&#123;ARCH&#125;.tgz</span><br><span class="line">tar -xf cri-dockerd-$&#123;CRI_DOCKERD_VERSION&#125;.$&#123;ARCH&#125;.tgz</span><br><span class="line">install -o root -g root -m 0755 cri-dockerd/cri-dockerd /usr/local/bin/cri-dockerd</span><br><span class="line"></span><br><span class="line">wget https://raw.githubusercontent.com/Mirantis/cri-dockerd/v$&#123;CRI_DOCKERD_VERSION&#125;/packaging/systemd/cri-docker.service</span><br><span class="line">wget https://raw.githubusercontent.com/Mirantis/cri-dockerd/v$&#123;CRI_DOCKERD_VERSION&#125;/packaging/systemd/cri-docker.socket</span><br><span class="line">install cri-docker.service /etc/systemd/system/cri-docker.service</span><br><span class="line">install cri-docker.socket /etc/systemd/system/cri-docker.socket</span><br><span class="line">sed -i -e &#x27;s,/usr/bin/cri-dockerd --container-runtime-endpoint fd://,/usr/local/bin/cri-dockerd --network-plugin=cni --pod-infra-container-image=registry.aliyuncs.com/google_containers/pause:3.8 --container-runtime-endpoint fd://,&#x27; /etc/systemd/system/cri-docker.service</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl enable cri-docker.service</span><br><span class="line">systemctl enable --now cri-docker.socket</span><br></pre></td></tr></table></figure>

<h1 id="使用-kubeadm-引导安装集群"><a href="#使用-kubeadm-引导安装集群" class="headerlink" title="使用 kubeadm 引导安装集群"></a>使用 kubeadm 引导安装集群</h1><h2 id="基础环境-所有机器"><a href="#基础环境-所有机器" class="headerlink" title="基础环境 (所有机器)"></a>基础环境 (所有机器)</h2><ul>
<li><p>关闭防火墙</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0</span><br><span class="line">sed -i &#x27;s/^SELINUX=enforcing$/SELINUX=permissive/&#x27; /etc/selinux/config</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭swap</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a  </span><br><span class="line">sed -ri &#x27;s/.*swap.*/#&amp;/&#x27; /etc/fstab</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置主机名和hosts</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname xxxx</span><br><span class="line">cat &lt;&lt;EOF&gt;&gt; /etc/hosts</span><br><span class="line">192.168.101.128     k8s-master</span><br><span class="line">192.168.101.129     k8s-node1</span><br><span class="line">192.168.101.130     k8s-node2</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>允许 iptables 检查桥接流量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf</span><br><span class="line">br_netfilter</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">sysctl --system</span><br></pre></td></tr></table></figure>
</li>
<li><p>时间同步</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">timedatectl set-timezone Asia/Shanghai</span><br><span class="line">yum install ntpdate -y</span><br><span class="line">ntpdate time.windows.com</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="所有节点安装kubelet、kubeadm、kubectl"><a href="#所有节点安装kubelet、kubeadm、kubectl" class="headerlink" title="所有节点安装kubelet、kubeadm、kubectl"></a>所有节点安装kubelet、kubeadm、kubectl</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">repo_gpgcheck=0</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg</span><br><span class="line">    http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span><br><span class="line">exclude=kubelet kubeadm kubectl</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">sudo yum install -y kubelet-1.28.0 kubeadm-1.28.0 kubectl-1.28.0 --disableexcludes=kubernetes</span><br><span class="line"></span><br><span class="line">sudo systemctl enable --now kubelet</span><br></pre></td></tr></table></figure>

<h2 id="初始化主节点"><a href="#初始化主节点" class="headerlink" title="初始化主节点"></a>初始化主节点</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 所有机器添加master域名映射，以下需要修改为自己的ip</span><br><span class="line">echo &quot;192.168.101.128  cluster-endpoint&quot; &gt;&gt; /etc/hosts</span><br><span class="line"></span><br><span class="line">#主节点初始化</span><br><span class="line">kubeadm init \</span><br><span class="line">--apiserver-advertise-address=192.168.101.128 \</span><br><span class="line">--image-repository registry.aliyuncs.com/google_containers \</span><br><span class="line">--control-plane-endpoint=cluster-endpoint \</span><br><span class="line">--kubernetes-version v1.28.0 \</span><br><span class="line">--cri-socket unix:///var/run/cri-dockerd.sock \</span><br><span class="line">--service-cidr=10.96.0.0/16 \</span><br><span class="line">--pod-network-cidr=172.31.0.0/16</span><br><span class="line"></span><br><span class="line">#所有网络范围不重叠</span><br></pre></td></tr></table></figure>

<h2 id="设置-kube-config"><a href="#设置-kube-config" class="headerlink" title="设置.&#x2F;kube&#x2F;config"></a>设置.&#x2F;kube&#x2F;config</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure>

<h2 id="安装网络组件"><a href="#安装网络组件" class="headerlink" title="安装网络组件"></a>安装网络组件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/calico.yaml</span><br><span class="line">kubectl apply -f calico.yaml</span><br></pre></td></tr></table></figure>

<h2 id="加入节点"><a href="#加入节点" class="headerlink" title="加入节点"></a>加入节点</h2><ul>
<li><p>运行 <code>kubeadm init</code> 输出的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubeadm join cluster-endpoint:6443 --token rggsd3.yczrwviph9f49ld7 \</span><br><span class="line">--cri-socket unix:///var/run/cri-dockerd.sock \</span><br><span class="line">--discovery-token-ca-cert-hash sha256:9f7b737692ef243eaa4f618d50b5c5abbfd3decbc48506a19886b68dbda54364</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果没有记住 <code>kubeadm init</code> 的输出，通过一下命令获取令牌</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 列出当前可用令牌</span><br><span class="line">kubeadm token list</span><br><span class="line"></span><br><span class="line"># 新建</span><br><span class="line">kubeadm token create</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果没有 <code>--discovery-token-ca-cert-hash</code> 的值，执行下面命令获取</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | \</span><br><span class="line">openssl dgst -sha256 -hex | sed &#x27;s/^.* //&#x27;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在mater节点运行 <code>kubectl get nodes</code> 验证</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Lanzl</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lanzl</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
